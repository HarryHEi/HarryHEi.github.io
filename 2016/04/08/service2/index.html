<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>服务器架设学习笔记二 | Harryx</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="网络设备 主机硬件：考虑使用年限、省电、虚拟技术等 Linux操作系统：考虑稳定性 网卡：考虑服务器用途、驱动程序 Switch/Hub：考虑主机数量、带宽、网管功能 网线：考虑速度相配的等级、线缆形状、配线等 无线网络设备：考虑速度、标准、安全性  网卡 网卡名称：网卡(Network Interface Card，NIC)名称以网卡内核模块对应设备名称表示，默认网卡名为eth0 linux网络">
<meta name="keywords" content="linux">
<meta property="og:type" content="article">
<meta property="og:title" content="服务器架设学习笔记二">
<meta property="og:url" content="http://yoursite.com/2016/04/08/service2/index.html">
<meta property="og:site_name" content="Harryx">
<meta property="og:description" content="网络设备 主机硬件：考虑使用年限、省电、虚拟技术等 Linux操作系统：考虑稳定性 网卡：考虑服务器用途、驱动程序 Switch/Hub：考虑主机数量、带宽、网管功能 网线：考虑速度相配的等级、线缆形状、配线等 无线网络设备：考虑速度、标准、安全性  网卡 网卡名称：网卡(Network Interface Card，NIC)名称以网卡内核模块对应设备名称表示，默认网卡名为eth0 linux网络">
<meta property="og:updated_time" content="2017-03-14T13:46:05.404Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="服务器架设学习笔记二">
<meta name="twitter:description" content="网络设备 主机硬件：考虑使用年限、省电、虚拟技术等 Linux操作系统：考虑稳定性 网卡：考虑服务器用途、驱动程序 Switch/Hub：考虑主机数量、带宽、网管功能 网线：考虑速度相配的等级、线缆形状、配线等 无线网络设备：考虑速度、标准、安全性  网卡 网卡名称：网卡(Network Interface Card，NIC)名称以网卡内核模块对应设备名称表示，默认网卡名为eth0 linux网络">
  
    <link rel="alternate" href="/atom.xml" title="Harryx" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Harryx</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Zoeken"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-service2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/08/service2/" class="article-date">
  <time datetime="2016-04-08T12:05:32.000Z" itemprop="datePublished">2016-04-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      服务器架设学习笔记二
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="网络设备"><a href="#网络设备" class="headerlink" title="网络设备"></a>网络设备</h1><ul>
<li><strong>主机硬件</strong>：考虑使用年限、省电、虚拟技术等</li>
<li><strong>Linux操作系统</strong>：考虑稳定性</li>
<li><strong>网卡</strong>：考虑服务器用途、驱动程序</li>
<li><strong>Switch/Hub</strong>：考虑主机数量、带宽、网管功能</li>
<li><strong>网线</strong>：考虑速度相配的等级、线缆形状、配线等</li>
<li><strong>无线网络设备</strong>：考虑速度、标准、安全性</li>
</ul>
<h1 id="网卡"><a href="#网卡" class="headerlink" title="网卡"></a>网卡</h1><ul>
<li>网卡名称：<strong>网卡</strong>(Network Interface Card，NIC)名称以网卡内核模块对应设备名称表示，默认网卡名为<strong>eth0</strong></li>
<li><p>linux网络参数配置文件：</p>
<ul>
<li><p><strong>ubuntu</strong>配置文件：</p>
<ul>
<li><strong>IP地址</strong>配置文件：<strong>/etc/network/interfaces</strong>，设置DHCP(动态主机配置协议)或者手动设置静态IP</li>
<li><p>以DHCP方式配置网卡：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">auto eth0</div><div class="line">iface eth0 inet dhcp</div></pre></td></tr></table></figure>
</li>
<li><p>为网卡配置静态IP：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">auto eth0</div><div class="line">iface eth0 inet static</div><div class="line">address 192.168.0.100</div><div class="line">gateway 192.168.0.1</div><div class="line">netmask 255.255.255.0</div></pre></td></tr></table></figure>
</li>
<li><p><strong>/etc/init.d/networking restart</strong>，重启以生效</p>
</li>
<li><strong>/bin/hostname newname</strong>，设置主机名称</li>
</ul>
</li>
<li><p><strong>CentOS</strong>配置文件：<br><a href="http://www.cnblogs.com/vicowong/archive/2011/04/23/2025545.html" target="_blank" rel="external">http://www.cnblogs.com/vicowong/archive/2011/04/23/2025545.html</a></p>
</li>
</ul>
</li>
<li><p><strong>无线网络</strong>(Wireless Local Area Network，<strong>WLAN</strong>)：使用无线电波作为传输媒介，IEEE802.11/a/g/b/n/ac标准</p>
</li>
<li><strong>WIFI</strong>(Wireless Fidelity，无线保真)：WIFI是WLAN的一个标准</li>
<li><strong>无线接入点</strong>(Wireless Acess Point，简称<strong>AP</strong>)：就是俗称的无线路由器<h1 id="linux常用网络命令"><a href="#linux常用网络命令" class="headerlink" title="linux常用网络命令"></a>linux常用网络命令</h1></li>
<li><strong>ifconfig</strong>：查询、设置网卡的IP等相关参数</li>
<li><strong>ifup</strong>，<strong>ifdown</strong>：两个script文件，启动、关闭网络接口</li>
<li><strong>route</strong>：查看、配置路由表(route table)ping</li>
<li><strong>ip</strong>：整合式命令，可以直接修改上述提到的功能</li>
<li><strong>ping</strong>：通过ICMP检查网络状态</li>
<li><p><strong>netstat</strong>：查看网络连接和后门</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">-r：列出路由表，如同route</div><div class="line">-n：不使用主机名和服务名称，使用IP与port number，如同route -n</div><div class="line">-a：列出所有连接状态，包括tcp/udp/unix socket等</div><div class="line">-t：仅列出tcp数据包连接</div><div class="line">-u：仅列出udp数据包连接</div><div class="line">-l：仅列出已在监听(Listen)的服务的网络状态</div><div class="line">-p：列出PID与Programe的文件名</div><div class="line">-c：设置几秒后自动更新一次</div><div class="line"></div><div class="line">herui@herui-Compaq-511:~$ sudo netstat -tulnp</div><div class="line">显示已启动的网络服务</div></pre></td></tr></table></figure>
</li>
<li><p><strong>host</strong>：查询某个主机ip，(更详细的可以使用<strong>dig</strong>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-a：列出详细设置数据</div><div class="line"></div><div class="line">herui@herui-Compaq-511:~$ host www.baidu.com</div><div class="line">www.baidu.com is an alias for www.a.shifen.com.</div><div class="line">www.a.shifen.com has address 119.75.218.70</div><div class="line">www.a.shifen.com has address 119.75.217.109</div></pre></td></tr></table></figure>
</li>
<li><p><strong>nslookup</strong>：和host类似，不过还可以由dIP找出主机名</p>
</li>
<li><strong>nm-tool</strong>：查询详细网络参数，包括DNS</li>
<li><strong>wget</strong>：文字接口下载器</li>
<li><strong>tcpdump</strong>：文字接口数据包捕获器<h1 id="网络安全"><a href="#网络安全" class="headerlink" title="网络安全"></a>网络安全</h1></li>
<li><p><strong>防火墙</strong></p>
<ul>
<li>第一层防火墙：数据包过滤防火墙(Net Filter)，iptables这个软件提供的防火墙功能，针对TCP/IP数据包头部进行过滤</li>
<li>第二层防火墙：TCP Wrappers，网络数据包接收Super Daemons以及TCP Wrappers的检验</li>
</ul>
</li>
<li><p><strong>SELinux</strong>(Security Enhanced Linux，安全强化Linux)<br>针对网络服务的权限设置一些规则，让程序拥有的功能有限</p>
<ul>
<li><strong>主体</strong>(Subject)<br>SELinux主要管理的就是程序，主体就是程序(Process)</li>
<li><strong>目标</strong>(Object)<br>主题程序访问的目标资源一般是文件系统</li>
<li><strong>策略</strong>(Policy)<br>由于程序和文件数量庞大，SELinux会根据服务制定安全性策略，这些策略会有详细的规则(Rule)来指定资源访问与否</li>
<li><p><strong>安全性环境</strong>(Security Context)<br>主体和目标的安全性必须一致<br>查看安全性环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls -Z</div></pre></td></tr></table></figure>
<p>安全性环境主要用冒号分为三个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Identify：Role：Type</div><div class="line">身份识别：角色：类型</div></pre></td></tr></table></figure>
</li>
<li><p><strong>身份识别</strong>(Identify)：相当于帐号方面的身份识别</p>
<ul>
<li><strong>root</strong>：表示<strong>root帐号身份</strong></li>
<li><strong>system_u</strong>：表示系统程序方面的识别，通常指<strong>程序</strong></li>
<li><strong>user_u</strong>：代表<strong>一般用户</strong>帐号相关的身份</li>
</ul>
</li>
<li><strong>角色</strong>(Role)：通过角色字段，我们可以知道这个数据是代表程序、文件资源还是用户<ul>
<li><strong>object_r</strong>：代表的是<strong>文件或者目录</strong>等文件资源，是最常见的</li>
<li><strong>system_r</strong>：代表<strong>程序</strong>，不过，<strong>一般用户</strong>也会被指定称为system_r</li>
</ul>
</li>
<li><p><strong>类型</strong>(Type)：在默认(targeted)策略中，身份识别(Identify)、角色(Role)基本上是不重要的，<strong>重要的在于这个类型(Type)字段</strong>，基本上，一个程序能不能读取到文件资源，与类型字段有关，类型字段在文件和程序中的定义不太相同</p>
<ul>
<li>Type：在文件资源中(Object)中称为类型(Type)</li>
<li><p>Domain：在主体程序(Subject)中称为域(Domain)</p>
<p>Domain要与Type搭配才能顺利读取文件资源</p>
</li>
</ul>
<p>Identify | Role | 意义<br>———–|——–|———<br>root | system_r | 代表供root帐号登录时所取得的权限<br>system_u | system_r | 由于是系统帐号，因此是非交互式的系统运行程序<br>user_u | system_r | 一般可登录用户的程序</p>
</li>
</ul>
</li>
</ul>
<h1 id="WWW服务器"><a href="#WWW服务器" class="headerlink" title="WWW服务器"></a>WWW服务器</h1><ul>
<li><strong>ubuntu apache2配置</strong><br>apache 针对服务器环境的配置文件<br><strong>/etc/apache2/apache2.conf</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">ServerRoot  </div><div class="line">#服务器设置的最顶层</div><div class="line">PidFile $&#123;APACHE_PID_FILE&#125;</div><div class="line">#放置pid的文件</div><div class="line">Timeout 300</div><div class="line">#当持续连接等待300秒后该次连接中断</div><div class="line">KeepAlive On</div><div class="line">是否允许持续性连接，持续性连接就是一次TCP连接可以具有多个文件资料传送要求</div><div class="line">MaxKeepAliveRequests 100</div><div class="line">#当KeepAlive设置为On时，这个数值决定该次连接能够传输的最大传输数量</div><div class="line">KeepAliveTimeout 5</div><div class="line">#允许KeepAlive前提下，该次连接在最后一次传输后等待的秒数</div></pre></td></tr></table></figure>
</li>
</ul>
<p>VH(虚拟主机)的设置<br><strong>/etc/apache2/sites-available/</strong><br>设置完之后导入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#sudo a2dissite example.com.conf</div><div class="line">sudo a2ensite example.com.conf</div><div class="line">sudo service apache2 restart</div></pre></td></tr></table></figure></p>
<p>针对模块功能的配置<br><strong>/etc/apache2/mods-available/mpm_prefork.conf</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;IfModule mpm_prefork_module&gt;</div><div class="line">        StartServers                     2</div><div class="line">        #启动Apache时启动process的数量</div><div class="line">        MinSpareServers           6</div><div class="line">        MaxSpareServers          12</div><div class="line">        #代表最大与最小备用程序数量</div><div class="line">        MaxRequestWorkers         30</div><div class="line">        #每个程序能够提供的最大传输次数要求</div><div class="line">        MaxConnectionsPerChild   3000</div><div class="line">&lt;/IfModule&gt;</div></pre></td></tr></table></figure></p>
<p>参考<br><a href="https://segmentfault.com/a/1190000002517469" target="_blank" rel="external">https://segmentfault.com/a/1190000002517469</a><br><a href="https://www.linode.com/docs/websites/apache/apache-web-server-on-ubuntu-14-04" target="_blank" rel="external">https://www.linode.com/docs/websites/apache/apache-web-server-on-ubuntu-14-04</a><br><a href="https://www.digitalocean.com/community/tutorials/how-to-configure-the-apache-web-server-on-an-ubuntu-or-debian-vps" target="_blank" rel="external">https://www.digitalocean.com/community/tutorials/how-to-configure-the-apache-web-server-on-an-ubuntu-or-debian-vps</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/08/service2/" data-id="cj5c7k435004im0u4fnqzmxn4" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/04/10/myblog-01/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Nieuwer</strong>
      <div class="article-nav-title">
        
          myblog-01 开始
        
      </div>
    </a>
  
  
    <a href="/2016/04/05/service1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ouder</strong>
      <div class="article-nav-title">服务器架设学习笔记一</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/acg/">acg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bb/">bb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/haskell/">haskell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sicp/">sicp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soket/">soket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spider/">spider</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/acg/" style="font-size: 10px;">acg</a> <a href="/tags/basic/" style="font-size: 10px;">basic</a> <a href="/tags/bb/" style="font-size: 10px;">bb</a> <a href="/tags/c/" style="font-size: 12.86px;">c++</a> <a href="/tags/django/" style="font-size: 12.86px;">django</a> <a href="/tags/flask/" style="font-size: 20px;">flask</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/haskell/" style="font-size: 10px;">haskell</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/javascript/" style="font-size: 17.14px;">javascript</a> <a href="/tags/jquery/" style="font-size: 15.71px;">jquery</a> <a href="/tags/linux/" style="font-size: 11.43px;">linux</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mysql/" style="font-size: 12.86px;">mysql</a> <a href="/tags/python/" style="font-size: 18.57px;">python</a> <a href="/tags/sicp/" style="font-size: 10px;">sicp</a> <a href="/tags/socket/" style="font-size: 11.43px;">socket</a> <a href="/tags/soket/" style="font-size: 10px;">soket</a> <a href="/tags/spider/" style="font-size: 14.29px;">spider</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/03/effective-C/">effective_C++</a>
          </li>
        
          <li>
            <a href="/2017/04/01/traceback/">异常处理</a>
          </li>
        
          <li>
            <a href="/2017/04/01/logging/">打印日志</a>
          </li>
        
          <li>
            <a href="/2017/04/01/construct/">二进制数据处理</a>
          </li>
        
          <li>
            <a href="/2017/03/29/Csharp/">C#面向对象</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 HeRui<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>