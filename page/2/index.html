<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Harryx</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Harryx">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Harryx">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Harryx">
  
    <link rel="alternate" href="/atom.xml" title="Harryx" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Harryx</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Zoeken"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-SICP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/18/SICP/" class="article-date">
  <time datetime="2016-05-18T08:59:34.000Z" itemprop="datePublished">2016-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/18/SICP/">SICP 笔记(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>《计算机程序的构造和详解》(SICP)的读书笔记，习题内容用python实现</p>
<h1 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h1><h2 id="1-5"><a href="#1-5" class="headerlink" title="1.5"></a>1.5</h2><p>区别正则序和应用序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(define (p) (p))</div><div class="line">(define (test x y))</div><div class="line">    (if (= x 0))</div><div class="line">        0</div><div class="line">        y))</div><div class="line"></div><div class="line">求值</div><div class="line">(test 0 (p))</div></pre></td></tr></table></figure></p>
<p>应用序中，解释器会首先对运算符和各对象求值<br>正则序中，解释器先不求出运算对象的值，只有实际需要时才去求值</p>
<p>上述程序中(p)会不断调用自身，从而陷入死循环<br>应用序中，程序会执行(p)并陷入死循环<br>正则序中，程序会因为if语句不执行(p)，而正常输出0</p>
<h2 id="1-6"><a href="#1-6" class="headerlink" title="1.6"></a>1.6</h2><p>使用cond自定义一个if语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(define (new-if predicate then-clause else-clause)</div><div class="line">    (cond (predicate then-clause)</div><div class="line">        (else else-clause)))</div></pre></td></tr></table></figure></p>
<p>和一般的if语句不同的是，new-if只是普通函数<br>在应用序中，new-if语句的每个参数都会被求值</p>
<p>上述例子中，then-clause 和 else-clause都会被执行，和预期不同</p>
<h2 id="树形递归"><a href="#树形递归" class="headerlink" title="树形递归"></a>树形递归</h2><p>用递归方法计算斐波那契数列<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#-*coding:utf-8-</div><div class="line"></div><div class="line">def fib(n):</div><div class="line">    if (n==0):</div><div class="line">        return 0</div><div class="line">    if (n==1):</div><div class="line">        return 1</div><div class="line">    if (n&gt;1):</div><div class="line">        return fib(n-1)+fib(n-2)</div><div class="line"></div><div class="line">print fib(35)</div></pre></td></tr></table></figure></p>
<p>进行了多次冗余计算<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">9227465</div><div class="line">[Finished in 7.1s]</div></pre></td></tr></table></figure></p>
<p>使用迭代方法计算<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#-*coding:utf-8-</div><div class="line"></div><div class="line">def fib(n):</div><div class="line">    def fib_inter(a,b,count): # a+b-&gt;a a-&gt;b</div><div class="line">        if (count==0):</div><div class="line">            return b</div><div class="line">        else:</div><div class="line">            return fib_inter(a+b,a,count-1)</div><div class="line">    return fib_inter(1,0,n) # b初始化为0，a初始化为1</div><div class="line"></div><div class="line">print fib(5)</div></pre></td></tr></table></figure></p>
<p>非常迅速<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">9227465</div><div class="line">[Finished in 0.0s]</div></pre></td></tr></table></figure></p>
<p>换零钱实例<br>总数为a的现金兑换成n种硬币的方式总数<br>    = a现金不用某一种硬币的兑换的方式数</p>
<pre><code>+ (a-d)现金用了这种硬币的兑换的方式数(d为这个硬币值)
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#-*coding:utf-8-</div><div class="line"></div><div class="line">def count_change(amount):</div><div class="line">    def first_deno(kinds_of_coins):</div><div class="line">        if (kinds_of_coins==1):</div><div class="line">            return 1</div><div class="line">        elif (kinds_of_coins==2):</div><div class="line">            return 5</div><div class="line">        elif (kinds_of_coins==3):</div><div class="line">            return 10</div><div class="line">        elif (kinds_of_coins==4):</div><div class="line">            return 25</div><div class="line">        elif (kinds_of_coins==5):</div><div class="line">            return 50</div><div class="line">    </div><div class="line">    def cc(amount,kinds_of_coins):</div><div class="line">        if (amount==0): </div><div class="line">            return 1</div><div class="line">        elif (amount&lt;0 or kinds_of_coins==0):</div><div class="line">            return 0</div><div class="line">        else:</div><div class="line">            return cc(amount,kinds_of_coins-1)+cc(amount-first_deno(kinds_of_coins),kinds_of_coins)</div><div class="line"></div><div class="line">    return cc(amount,5)</div><div class="line"></div><div class="line">print count_change(100)</div></pre></td></tr></table></figure>
<h2 id="1-12"><a href="#1-12" class="headerlink" title="1.12"></a>1.12</h2><p>n<3 f(n)="n" n="">=3 f(n)=f(n-1)+2f(n-2)+3f(n-3)</3></p>
<p>使用递归<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def f(n):</div><div class="line">    if (n&lt;3):</div><div class="line">        return n</div><div class="line">    else:</div><div class="line">        return f(n-1)+2*f(n-2)+3*f(n-3)</div><div class="line">print f(10)</div></pre></td></tr></table></figure></p>
<p>使用迭代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">def f(n):</div><div class="line">    def f_inter(a,b,c,count):</div><div class="line">        if count&lt;3:</div><div class="line">            return c</div><div class="line">        else:</div><div class="line">            return f_inter(b,c,3*a+2*b+c,count-1)</div><div class="line">    return f_inter(0,1,2,n)</div><div class="line">print f(10)</div></pre></td></tr></table></figure></p>
<h2 id="1-12-1"><a href="#1-12-1" class="headerlink" title="1.12"></a>1.12</h2><p>帕斯卡三角形</p>
<p>使用递归<br>根据除了第一和第一行外每个元素f(x,y) = f(x-1,y-1) + f(x-1,y)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def f(x,y):</div><div class="line">    if y==0 or x==y or x==1:</div><div class="line">        return 1</div><div class="line">    else:</div><div class="line">        return f(x-1,y-1)+f(x-1,y)</div><div class="line">print f(10,5)</div></pre></td></tr></table></figure></p>
<p>使用迭代<br>根据公式 f(x,y) = x! / (y! * (x-y)!)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">def f(x,y):</div><div class="line">    def f_inter(x):</div><div class="line">        if x==0:</div><div class="line">            return 1</div><div class="line">        f_inter_result = 1</div><div class="line">        for i in range(x):</div><div class="line">            f_inter_result *= i+1</div><div class="line">        return f_inter_result</div><div class="line">    return f_inter(x)/(f_inter(y)*f_inter(x-y))</div><div class="line">print f(10,5)</div></pre></td></tr></table></figure></p>
<h2 id="1-15"><a href="#1-15" class="headerlink" title="1.15"></a>1.15</h2><p>x足够小时可以使用sinx=3 sin(x/3) - 4 sin3(x/3)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">def sine(x):</div><div class="line">    def f(x): # 角度足够小时使用这个函数求值</div><div class="line">        return 3*x-4*(x**3)</div><div class="line">    def sines(angle): # 递归求值</div><div class="line">        if abs(angle)&lt;0.1:</div><div class="line">            return angle</div><div class="line">        else:</div><div class="line">            return f(sines(angle/3))</div><div class="line">    return sines(x)</div><div class="line">print sine(12.15)</div></pre></td></tr></table></figure></p>
<p>sine(12.15) 5次调用 f(x)<br>每增加一倍，运行次数会增加一次</p>
<h2 id="求幂"><a href="#求幂" class="headerlink" title="求幂"></a>求幂</h2><p>一般的求幂，相比较直接使用递归计算 x<em>(x</em>(x<em>(x</em>(x(…)))))<br>更快的做法是连续求方<br>x^n = (x^(n/2))^2 n为偶数时<br>x^n = (x^(n-1))*x n为奇数时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">def exp(x,n):</div><div class="line">    if n==0:</div><div class="line">        return 1</div><div class="line">    elif n%2==0:</div><div class="line">        return exp(x,n/2)**2</div><div class="line">    elif n%2!=0:</div><div class="line">        return exp(x,n-1)*x</div><div class="line"></div><div class="line">print exp(2,10)</div></pre></td></tr></table></figure>
<h2 id="1-16"><a href="#1-16" class="headerlink" title="1.16"></a>1.16</h2><p>使用迭代法求幂<br>n为偶数时 x<em>*2 -&gt; x ; n/2 -&gt; n ; a -&gt; a<br>n为奇数时 x -&gt; x ; n-1 -&gt; n ; a</em>x -&gt; a<br>a*(b^n) 的值是不变的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">def exp(x,n):</div><div class="line">    def ex(x,n,a):</div><div class="line">        if n==0:</div><div class="line">            return a</div><div class="line">        elif n%2==0:</div><div class="line">            return ex(x**2,n/2,a)</div><div class="line">        elif n%2!=0:</div><div class="line">            return ex(x,n-1,a*x)</div><div class="line">    return ex(x,n,1)</div><div class="line"></div><div class="line">print exp(2,10)</div></pre></td></tr></table></figure></p>
<h2 id="1-17"><a href="#1-17" class="headerlink" title="1.17"></a>1.17</h2><p>只使用double(将一个数X2)，和halve(将一个数除以2)，定义一个快速的乘法<br>例如：<br>5<em>8 = 5</em>4<em>2<br>5</em>7 = 5*6+5<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">def doubles(a):</div><div class="line">    return a*2</div><div class="line"></div><div class="line">def halv(a):</div><div class="line">    return a/2</div><div class="line"></div><div class="line">def mut(a,b):</div><div class="line">    if b==0:</div><div class="line">        return 0</div><div class="line">    elif b%2==0:</div><div class="line">        return doubles(mut(a,halv(b)))</div><div class="line">    elif b%2!=0:</div><div class="line">        return mut(a,b-1)+a</div><div class="line"></div><div class="line">print mut(2,8)</div></pre></td></tr></table></figure></p>
<h2 id="1-18"><a href="#1-18" class="headerlink" title="1.18"></a>1.18</h2><p>使用迭代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">def doubles(a):</div><div class="line">    return a*2</div><div class="line"></div><div class="line">def halv(a):</div><div class="line">    return a/2</div><div class="line"></div><div class="line">def mut(a,b):</div><div class="line">    def mut(a,b,project):</div><div class="line">        if b==0:</div><div class="line">            return project</div><div class="line">        elif b%2==0:</div><div class="line">            return doubles(mut(a,halv(b),project))</div><div class="line">        elif b%2!=0:</div><div class="line">            return mut(a,b-1,a+project)</div><div class="line">    return mut(a,b,0)</div><div class="line"></div><div class="line">print mut(5,8)</div></pre></td></tr></table></figure></p>
<h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><h2 id="过程参数"><a href="#过程参数" class="headerlink" title="过程参数"></a>过程参数</h2><p>定义一个过程变量，从外部传递参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">def sums(term,a,b):</div><div class="line">    if a&gt;b:</div><div class="line">        return 0</div><div class="line">    else:</div><div class="line">        return term(a)+sums(term,a+1,b)</div><div class="line"></div><div class="line">def powers(a):</div><div class="line">    return a*a</div><div class="line"></div><div class="line">print sums(powers,1,3)</div></pre></td></tr></table></figure></p>
<h2 id="使用lambda构造过程"><a href="#使用lambda构造过程" class="headerlink" title="使用lambda构造过程"></a>使用lambda构造过程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">def sums(term,a=1,b=2):</div><div class="line">    if a&gt;b:</div><div class="line">        return 0</div><div class="line">    else:</div><div class="line">        return term(a)+sums(term,a+1,b)</div><div class="line"></div><div class="line">print sums(lambda x:x*2,a=1,b=3)</div></pre></td></tr></table></figure>
<p>也可以返回过程<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">def fun():</div><div class="line">    return lambda x:x+1</div><div class="line"></div><div class="line">print fun()(2)</div></pre></td></tr></table></figure></p>
<h1 id="数据抽象"><a href="#数据抽象" class="headerlink" title="数据抽象"></a>数据抽象</h1><h2 id="序对"><a href="#序对" class="headerlink" title="序对"></a>序对</h2><p>使用cons将两个对象粘接在一起<br>然后使用car和cdr获得其中一个对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1 ]=&gt; (display (car (cons 1 2)))</div><div class="line">1</div><div class="line"></div><div class="line">1 ]=&gt; (display (cdr (cons 1 2)))</div><div class="line">2</div></pre></td></tr></table></figure></p>
<p>完全使用过程实现序对<br>cons(x,y)的返回值是一个过程(函数)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">def cons(x,y):</div><div class="line">    return lambda z : x if z else y</div><div class="line"></div><div class="line">def car(c):</div><div class="line">    return c(1)</div><div class="line"></div><div class="line">def cdr(c):</div><div class="line">    return c(0)</div><div class="line"></div><div class="line">print car(cons(1,2))</div></pre></td></tr></table></figure></p>
<p>为了效率，在LISP中实际上是直接使用数据实现序对</p>
<h3 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h3><p>序对的嵌套可以形成序列，其中使用 ‘() 定义空<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(define test-cons-list (cons 1 (cons 2 (cons 3 (cons 4 &apos;())))))</div><div class="line"></div><div class="line">1 ]=&gt; test-cons-list</div><div class="line">;Value 21: (1 2 3 4)</div></pre></td></tr></table></figure></p>
<p>使用list方法也可以构造<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(define test-lis (list 1 3 5 7 2 4 6 8))</div></pre></td></tr></table></figure></p>
<p>使用car cdr遍历表<br>cadr 是 (car (cdr …)) 的简写</p>
<p>定义一个遍历序列操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(define (list-ref items n)</div><div class="line">    (if (= n 0)</div><div class="line">        (car items)</div><div class="line">        (list-ref (cdr items) (- n 1))))</div></pre></td></tr></table></figure></p>
<p>(null? …) 基本操作，检查参数是不是空<br>定义一个检查序列长度的操作</p>
<p>递归操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(define (length items)</div><div class="line">    (if (null? items)</div><div class="line">        0</div><div class="line">        (+ 1 (length (cdr items)))))</div></pre></td></tr></table></figure></p>
<p>迭代操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(define (length items)</div><div class="line">    (define (length-inter items-inter count)</div><div class="line">        (if (null? items-inter)</div><div class="line">            countdd</div><div class="line">            (length-inter (cdr items-inter) (+ 1 count))))</div><div class="line">    (length-inter items 0))</div></pre></td></tr></table></figure></p>
<h3 id="2-17"><a href="#2-17" class="headerlink" title="2.17"></a>2.17</h3><p>获取最后一个元素的值<br>使用递归方法实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(define (last-pair items)</div><div class="line">    (if (null? (cdr items))</div><div class="line">        items</div><div class="line">        (last-pair (cdr items))))</div></pre></td></tr></table></figure></p>
<h3 id="2-18"><a href="#2-18" class="headerlink" title="2.18"></a>2.18</h3><p>倒序<br>使用迭代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(define (reverse items)</div><div class="line">    (define (reverse-inter items-inter result)</div><div class="line">        (if (null? items-inter)</div><div class="line">            result</div><div class="line">            (reverse-inter (cdr items-inter)</div><div class="line">                (cons (car items-inter) result))))</div><div class="line">    (reverse-inter items &apos;()))</div></pre></td></tr></table></figure></p>
<h3 id="对表的映射"><a href="#对表的映射" class="headerlink" title="对表的映射"></a>对表的映射</h3><p>对表的映射实现的是从元素表到结果表的变换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1 ]=&gt; test-lis</div><div class="line">;Value 14: (1 3 5 7 2 4 6 8)</div><div class="line"></div><div class="line">1 ]=&gt; (map + test-lis test-lis)</div><div class="line">;Value 13: (2 6 10 14 4 8 12 16)</div></pre></td></tr></table></figure></p>
<h2 id="层次性结构"><a href="#层次性结构" class="headerlink" title="层次性结构"></a>层次性结构</h2><p>计算叶子数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(define (count-leaves items)</div><div class="line">    (cond ((null? items) 0)</div><div class="line">        ((not (pair? items)) 1)</div><div class="line">        (else (+ (count-leaves (car items))</div><div class="line">            (count-leaves (cdr items))))))</div></pre></td></tr></table></figure></p>
<h2 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h2><p>用python实现快速排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">def mysort(a):</div><div class="line">    def sort(a,p,q):</div><div class="line">        x=a[p]</div><div class="line">        i=p</div><div class="line">        j=p+1</div><div class="line">        while j&lt;len(a):</div><div class="line">            if a[j]&lt;=x:</div><div class="line">                i=i+1</div><div class="line">                temp=a[j]</div><div class="line">                a[j]=a[i]</div><div class="line">                a[i]=temp</div><div class="line">            j=j+1</div><div class="line">        temp=a[p]</div><div class="line">        a[p]=a[i]</div><div class="line">        a[i]=temp</div><div class="line">        return i</div><div class="line"></div><div class="line">    def intersort(a,p,q):</div><div class="line">        if p&lt;q:</div><div class="line">            r = sort(a,p,q)</div><div class="line">            intersort(a,p,r-1)</div><div class="line">            intersort(a,r+1,q)</div><div class="line">    intersort(a,0,len(a)-1)</div><div class="line">    return a</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/18/SICP/" data-id="cj5c7k421003km0u4xtednagq" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sicp/">sicp</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-myDjango-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/13/myDjango-2/" class="article-date">
  <time datetime="2016-05-13T00:59:02.000Z" itemprop="datePublished">2016-05-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/13/myDjango-2/">myDjango-2 表单、路由、静态文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Request-对象"><a href="#Request-对象" class="headerlink" title="Request 对象"></a>Request 对象</h1><h2 id="Request-对象包含的信息"><a href="#Request-对象包含的信息" class="headerlink" title="Request 对象包含的信息"></a>Request 对象包含的信息</h2><p>HttpRequest对象包含请求URL的一些信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">request.path    # 除了域名以外的请求路径</div><div class="line">request.get_host()    # 主机名</div><div class="line">request.get_full_path()    # 包含查询字符串</div><div class="line">request.is_secure()    # 是否通过https访问</div><div class="line"></div><div class="line"># request.META是一个普通字典，如果键不存在，会返回KeyError异常</div><div class="line">request.META[&apos;HTTP_REFERER&apos;]    # 进站前链接网页</div><div class="line">request.META[&apos;HTTP_USER_AGENT&apos;]    # 用户浏览器user-agent字符串</div><div class="line">request.META[&apos;REMOTE_ADDR&apos;]    # 客户端IP</div></pre></td></tr></table></figure></p>
<h2 id="提交数据信息"><a href="#提交数据信息" class="headerlink" title="提交数据信息"></a>提交数据信息</h2><p>request.GET 和 request.POST 都是类字典对象，通过它们可以访问GET和POST数据</p>
<h1 id="表单处理"><a href="#表单处理" class="headerlink" title="表单处理"></a>表单处理</h1><h2 id="使用GET"><a href="#使用GET" class="headerlink" title="使用GET"></a>使用GET</h2><h3 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h3><p>表单中定义action为search，重定向到search视图函数<br>文件：<strong>/myDjango/myDjango/templates/search_pic.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;% block content %&#125;</div><div class="line">&lt;form action=&quot;/search/&quot; method=&apos;get&apos;&gt;</div><div class="line">    &lt;input type=&apos;text&apos; name=&apos;cont&apos;&gt;</div><div class="line">    &lt;input type=&apos;submit&apos; value=&apos;Search&apos;&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<h3 id="视图函数"><a href="#视图函数" class="headerlink" title="视图函数"></a>视图函数</h3><p>search_pic是表单页面的视图<br>search视图函数从URL中获得GET参数<br>文件：<strong>/myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">def search_pic(request):</div><div class="line">    return render_to_response(&quot;search_pic.html&quot;)</div><div class="line"></div><div class="line">def search(request):</div><div class="line">    if &apos;cont&apos; in request.GET:</div><div class="line">        message = &apos;You searched for: %r&apos; % request.GET[&apos;cont&apos;]</div><div class="line">    else:</div><div class="line">        message = &apos;You submitted an empty form.&apos;</div><div class="line">    return HttpResponse(message)</div></pre></td></tr></table></figure></p>
<h3 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h3><p>针对两个视图函数定义两个路由<br>文件：<strong>/myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url, include</div><div class="line"></div><div class="line">from myDjango.views import hello, current_datetime, hours_ahead, search_pic, search</div><div class="line">from toon.views import showpic</div><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^search-pic/$&apos;, search_pic),</div><div class="line">    url(r&apos;^search/$&apos;, search),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="使用POST"><a href="#使用POST" class="headerlink" title="使用POST"></a>使用POST</h2><h3 id="表单-1"><a href="#表单-1" class="headerlink" title="表单"></a>表单</h3><p>action改为’’，post是在本页提交，URL不会发生变化</p>
<p>csrf_token用来防止跨站请求攻击<br>文件：<strong>/myDjango/myDjango/templates/search_pic.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;% block content %&#125;</div><div class="line">&lt;form action=&quot;&quot; method=&apos;post&apos;&gt;</div><div class="line">    &#123;% csrf_token %&#125;</div><div class="line">    &lt;input type=&apos;text&apos; name=&apos;cont&apos;&gt;</div><div class="line">    &lt;input type=&apos;submit&apos; value=&apos;Search&apos; name=&quot;submit&quot;&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<h3 id="视图函数-1"><a href="#视图函数-1" class="headerlink" title="视图函数"></a>视图函数</h3><p>search_pic是表单页面的视图<br>和之前类似，不过这次是POST数据</p>
<p>HttpResponseRedirect把页面重定向到某个页面<br>这里不能使用render_to_render来输出，因为可能造成数据的重复<br>文件：<strong>/myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from django.http import HttpResponseRedirect</div><div class="line">from django.shortcuts import render_to_response</div><div class="line"></div><div class="line">def search_pic(request):</div><div class="line">    if request.POST.get(&apos;cont&apos;):</div><div class="line">        return HttpResponseRedirect(&quot;index.html&quot;)</div><div class="line">    return render_to_response(&apos;search_pic.html&apos;)</div></pre></td></tr></table></figure></p>
<p>如果需要传递参数，可以使用render<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from django.shortcuts import render_to_response, render</div><div class="line"></div><div class="line">def search_pic(request):</div><div class="line">    if request.POST.get(&apos;cont&apos;):</div><div class="line">        print &quot;ok&quot;</div><div class="line">        return render(request, &quot;index.html&quot;,\</div><div class="line">            &#123;&quot;label&quot;:&quot;thanks&quot;&#125;)</div><div class="line">    return render_to_response(&apos;search_pic.html&apos;)</div></pre></td></tr></table></figure></p>
<h3 id="路由-1"><a href="#路由-1" class="headerlink" title="路由"></a>路由</h3><p>只需要定义一个路由<br>文件：<strong>/myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^search-pic/$&apos;, search_pic),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="Form-类"><a href="#Form-类" class="headerlink" title="Form 类"></a>Form 类</h2><p>Django带有一个form库，称为django.forms<br>使用这个库可以处理HTML表单及验证<br>文件：<strong>/myDjango/myDjango/forms.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">from django import forms</div><div class="line"></div><div class="line">class testform(forms.Form):</div><div class="line">    cont = forms.CharField()</div></pre></td></tr></table></figure></p>
<p>在shell下操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from myDjango.forms import testform</div><div class="line"></div><div class="line">&gt;&gt;&gt; f=testform()</div><div class="line">&gt;&gt;&gt; print f</div><div class="line">&lt;tr&gt;&lt;th&gt;&lt;label for=&quot;id_cont&quot;&gt;Cont:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input id=&quot;id_cont&quot; name=&quot;cont&quot; type=&quot;text&quot; /&gt;&lt;/td&gt;&lt;/tr&gt;</div><div class="line"></div><div class="line">&gt;&gt;&gt; print f[&apos;cont&apos;]</div><div class="line">&lt;input id=&quot;id_cont&quot; name=&quot;cont&quot; type=&quot;text&quot; /&gt;</div><div class="line"></div><div class="line">&gt;&gt;&gt; f.errors</div><div class="line">&#123;&#125;</div><div class="line"></div><div class="line">&gt;&gt;&gt; f[&apos;cont&apos;].errors</div><div class="line">[]</div><div class="line"></div><div class="line">&gt;&gt;&gt; f.is_valid()</div><div class="line">False</div><div class="line"></div><div class="line">&gt;&gt;&gt; f=testform(&#123;&quot;cont&quot;:&quot;test&quot;&#125;)</div><div class="line">&gt;&gt;&gt; f.is_valid()</div><div class="line">True</div></pre></td></tr></table></figure></p>
<h3 id="视图函数-2"><a href="#视图函数-2" class="headerlink" title="视图函数"></a>视图函数</h3><p>is_valid()验证过之后，从cleaned_data字典中获得参数<br>文件：<strong>/myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">def search_pic(request):</div><div class="line">    if request.method == &apos;POST&apos;:</div><div class="line">        print request.POST</div><div class="line">        form = testform(request.POST)</div><div class="line">        if form.is_valid():</div><div class="line">            d = form.cleaned_data[&apos;cont&apos;]</div><div class="line">            print d</div><div class="line">            return render(request, &quot;index.html&quot;, &#123;&quot;label&quot;:d&#125;)</div><div class="line">    else:</div><div class="line">        form = testform()</div><div class="line">    return render(request, &apos;search_pic.html&apos;, &#123;&quot;form&quot;:form&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="渲染表单"><a href="#渲染表单" class="headerlink" title="渲染表单"></a>渲染表单</h3><p>使用form.as_table整齐排列<br>文件：<strong>/myDjango/myDjango/templates/search_pic.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;% block content %&#125;</div><div class="line">&lt;form action=&quot;&quot; method=&apos;post&apos;&gt;</div><div class="line">    &#123;% csrf_token %&#125;</div><div class="line">    &lt;table&gt;</div><div class="line">        &#123;&#123; form.as_table &#125;&#125;</div><div class="line">    &lt;/table&gt;</div><div class="line">    &lt;input type=&apos;submit&apos; value=&apos;Search&apos; name=&quot;submit&quot;&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<h3 id="改字段显示"><a href="#改字段显示" class="headerlink" title="改字段显示"></a>改字段显示</h3><p>当指定一个字段时，Django使用默认Widget，也可以使用自定义Widget<br>即type=”textarea”<br>文件：<strong>/myDjango/myDjango/forms.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class testform(forms.Form):</div><div class="line">    cont = forms.CharField()</div><div class="line">    comment = forms.CharField(widget=forms.Textarea)</div></pre></td></tr></table></figure></p>
<h3 id="设置最大长度"><a href="#设置最大长度" class="headerlink" title="设置最大长度"></a>设置最大长度</h3><p>同样的，最小长度为min_length<br>文件：<strong>/myDjango/myDjango/forms.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class testform(forms.Form):</div><div class="line">    cont = forms.CharField(max_length=100)</div><div class="line">    comment = forms.CharField(widget=forms.Textarea)</div></pre></td></tr></table></figure></p>
<h3 id="初始值"><a href="#初始值" class="headerlink" title="初始值"></a>初始值</h3><p>在视图函数中传入<br>文件：<strong>/myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">def search_pic(request):</div><div class="line">    if request.method == &apos;POST&apos;:</div><div class="line">        #...</div><div class="line">    else:</div><div class="line">        form = testform(initial=&#123;&quot;cont&quot;:&quot;lalala&quot;&#125;)</div><div class="line">    return render(request, &apos;search_pic.html&apos;, &#123;&quot;form&quot;:form&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="自定义校验规则"><a href="#自定义校验规则" class="headerlink" title="自定义校验规则"></a>自定义校验规则</h3><p>Django的form系统自动寻找匹配函数的方法，该方法以clean_开头，以字段名称结束<br>如果有这样的方法，它将在默认校验结束后调用</p>
<p>下例在字数不足时会抛出ValidationError异常，追加到错误列表中<br>文件：<strong>/myDjango/myDjango/forms.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">class testform(forms.Form):</div><div class="line">    cont = forms.CharField(max_length=100)</div><div class="line">    comment = forms.CharField(widget=forms.Textarea)</div><div class="line">    def clean_cont(self):</div><div class="line">        cont = self.cleaned_data[&apos;cont&apos;]</div><div class="line">        if len(cont) &lt; 4:</div><div class="line">            raise forms.ValidationError(&quot;not enough words&quot;)</div><div class="line">        return cont</div></pre></td></tr></table></figure></p>
<h3 id="指定标签"><a href="#指定标签" class="headerlink" title="指定标签"></a>指定标签</h3><p>HTML表单中自动生成的标签默认是按照规则生成的：用空格代替下划线，首字母大写。<br>也可以自定义标签，使用label<br>文件：<strong>/myDjango/myDjango/forms.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class testform(forms.Form):</div><div class="line">    cont = forms.CharField(max_length=100, label=&quot;cont&quot;)</div><div class="line">    comment = forms.CharField(widget=forms.Textarea, label=&quot;com&quot;)</div><div class="line">    #...</div></pre></td></tr></table></figure></p>
<h3 id="Form设计"><a href="#Form设计" class="headerlink" title="Form设计"></a>Form设计</h3><p>每个部件单独渲染，然后设置CSS样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;% block content %&#125;</div><div class="line">&lt;form action=&quot;&quot; method=&apos;post&apos;&gt;</div><div class="line">    &#123;% csrf_token %&#125;</div><div class="line">    &lt;div class=&quot;cont&quot;&gt;</div><div class="line">        &#123;&#123; form.cont.errors &#125;&#125;</div><div class="line">        &lt;label for=&quot;id_cont&quot;&gt;Cont&lt;/label&gt;</div><div class="line">        &#123;&#123; form.cont &#125;&#125;</div><div class="line">    &lt;/div&gt;</div><div class="line"></div><div class="line">    &lt;div class=&quot;cont&quot;&gt;</div><div class="line">        &#123;&#123; form.comment.errors &#125;&#125;</div><div class="line">        &lt;label for=&quot;id_comment&quot;&gt;Comment&lt;/label&gt;</div><div class="line">        &#123;&#123; form.comment &#125;&#125;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;input type=&apos;submit&apos; value=&apos;Search&apos; name=&quot;submit&quot;&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<h1 id="路由-2"><a href="#路由-2" class="headerlink" title="路由"></a>路由</h1><p>为了防止在路由中导入视图函数的语句过长，可以导入视图文件本身<br>文件：<strong>/myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url, include</div><div class="line"></div><div class="line">from myDjango import views</div><div class="line">from toon.views import showpic</div><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^admin/&apos;, include(admin.site.urls)),</div><div class="line">    url(r&apos;^$&apos;, views.hello),</div><div class="line">    url(r&apos;^time$&apos;, views.current_datetime),</div><div class="line">    url(r&apos;^time/plus/(\d+)/$&apos;, views.hours_ahead),</div><div class="line">    url(r&apos;^toon/&apos;,include(&apos;toon.urls&apos;)),</div><div class="line">    url(r&apos;^search-pic/$&apos;, views.search_pic),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>Django一次匹配每个URL模式，直到匹配到第一个<br>成功捕获的URL以字符串形式传给视图函数</p>
<p>当Django找不到匹配请求的URL正则表达式时，会进入错误处理视图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">handler404 —— django.conf.urls.handler404  django.views.defaults.page_not_found</div><div class="line">handler500 —— django.conf.urls.handler500  django.views.defaults.server_error</div><div class="line">handler403 —— django.conf.urls.handler403  django.views.defaults.permission_denied</div><div class="line">handler400 —— django.conf.urls.handler400  django.views.defaults.bad_request</div></pre></td></tr></table></figure></p>
<h2 id="包含其他的URL"><a href="#包含其他的URL" class="headerlink" title="包含其他的URL"></a>包含其他的URL</h2><p>URL可以包含其他URL模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^toon/&apos;,include(extra_patterns)),</div><div class="line">]</div><div class="line">extra_patterns = [</div><div class="line">    url(r&apos;^pic/&apos;, views.showpic),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>或者写在里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^some/&apos;, include([</div><div class="line">        url(r&apos;^history/$&apos;, views.history),</div><div class="line">        url(r&apos;^edit/$&apos;, views.edit),</div><div class="line">        url(r&apos;^discuss/$&apos;, views.discuss),</div><div class="line">        url(r&apos;^permissions/$&apos;, views.permissions),</div><div class="line">    ])),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="捕获参数"><a href="#捕获参数" class="headerlink" title="捕获参数"></a>捕获参数</h2><p>路由<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^hello/(?P&lt;name&gt;\w+)$&apos;, views.hello),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>视图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">def hello(request, name=&quot;none&quot;):</div><div class="line">    return render_to_response(&quot;index.html&quot;,&#123;&quot;label&quot;:name&#125;)</div></pre></td></tr></table></figure></p>
<p>参数的嵌套<br>匹配一个/hello/name=<name>格式的URL<br>当URL为 /hello/name=harryx 时，传入一个值为harryx的name参数给视图函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    #..</div><div class="line">    url(r&apos;^hello/(?:name=(?P&lt;name&gt;\w+)/)?$&apos;, views.hello),</div><div class="line">]</div></pre></td></tr></table></figure></name></p>
<p>路由传递参数<br>url函数有可选的第三个参数，以字典形式传递参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^hello/(?:name=(?P&lt;name&gt;\w+)/)?$&apos;, views.hello, &#123;&quot;test&quot;:&quot;lalala&quot;&#125;),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>视图函数接收参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">def hello(request, name=&quot;none&quot;, test=&quot;test&quot;):</div><div class="line">    return render_to_response(&quot;index.html&quot;,\</div><div class="line">        &#123;&quot;label&quot;:name+test&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="URL反向解析"><a href="#URL反向解析" class="headerlink" title="URL反向解析"></a>URL反向解析</h2><p>定义路由<br>把URL命名为”year”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    #..</div><div class="line">    url(r&apos;^hello/([0-9]&#123;4&#125;)/$&apos;, views.hello, name=&quot;year&quot;),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>在模板中使用url模板标签，反向解析地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;% url &quot;year&quot; 2013 %&#125;</div></pre></td></tr></table></figure></p>
<p>在视图函数中使用reverse解析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">from django.core.urlresolvers import reverse</div><div class="line"></div><div class="line">reverse(&quot;year&quot;, args=(2016,))</div></pre></td></tr></table></figure></p>
<h3 id="带命名空间的URL名字"><a href="#带命名空间的URL名字" class="headerlink" title="带命名空间的URL名字"></a>带命名空间的URL名字</h3><p>因为在Django项目中可能会有很多应用，可以在命名空间下命名<br>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^toon/&apos;,include(&apos;toon.urls&apos;, namespace=&quot;toon&quot;)),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>文件：<strong>myDjango/toon/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^pic/&apos;, views.showpic, name=&quot;pic&quot;),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>文件：<strong>myDjango/myDjango/templates/toon/pic.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;&#123;% url &quot;toon:pic&quot; %&#125;&quot;&gt;test&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h3 id="通用视图"><a href="#通用视图" class="headerlink" title="通用视图"></a>通用视图</h3><p>路由<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^$&apos;, views.IndexView.as_view(), name=&quot;index&quot;),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>视图<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class IndexView(generic.ListView):</div><div class="line">    template_name = &apos;toon/index.html&apos;</div><div class="line">    context_object_name = &apos;pic_list&apos;</div><div class="line"></div><div class="line">    def get_queryset(self):</div><div class="line">        return Pic.objects.order_by(&apos;picname&apos;)</div></pre></td></tr></table></figure></p>
<p>模板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;% for p in pic_list %&#125;</div><div class="line">    &lt;li&gt;&#123;&#123; p.picname &#125;&#125;&lt;/li&gt;</div><div class="line">&#123;% endfor %&#125;</div></pre></td></tr></table></figure></p>
<h1 id="静态文件"><a href="#静态文件" class="headerlink" title="静态文件"></a>静态文件</h1><p>这里把静态文件static放在根目录下<br>setting.py配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">STATIC_URL = &apos;/static/&apos;</div><div class="line"></div><div class="line">STATICFILES_DIRS = (</div><div class="line">    os.path.join(BASE_DIR, &quot;static&quot;),</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>在模板文件中导入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;head&gt;</div><div class="line">    &#123;% load staticfiles %&#125;</div><div class="line">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;&#123;% static &apos;myDjango/test.css&apos; %&#125;&quot; /&gt;</div><div class="line">&lt;/head&gt;</div></pre></td></tr></table></figure></p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>Django框架先了解到这边</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/13/myDjango-2/" data-id="cj5c7k42c003vm0u4djmr544u" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/">django</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-myDjango-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/11/myDjango-1/" class="article-date">
  <time datetime="2016-05-11T10:51:46.000Z" itemprop="datePublished">2016-05-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/11/myDjango-1/">myDjango-1 数据库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="添加一个功能-app"><a href="#添加一个功能-app" class="headerlink" title="添加一个功能(app)"></a>添加一个功能(app)</h1><p>命令行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py startapp toon</div></pre></td></tr></table></figure></p>
<p>更改配置<br>文件：<strong>myDjango/myDjango/settings.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = [</div><div class="line">    &apos;django.contrib.admin&apos;,</div><div class="line">    &apos;django.contrib.auth&apos;,</div><div class="line">    &apos;django.contrib.contenttypes&apos;,</div><div class="line">    &apos;django.contrib.sessions&apos;,</div><div class="line">    &apos;django.contrib.messages&apos;,</div><div class="line">    &apos;django.contrib.staticfiles&apos;,</div><div class="line">    &apos;toon&apos;,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h1 id="添加模型"><a href="#添加模型" class="headerlink" title="添加模型"></a>添加模型</h1><p>在之前添加app的命令执行后会创建一个模型文件<br>文件：<strong>myDjango/myDjango/toon/models.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class Pic(models.Model):</div><div class="line">    picname = models.CharField(max_length=32)</div><div class="line">    pic = models.ImageField(null=True,blank=True)</div><div class="line">    tips = models.TextField()</div></pre></td></tr></table></figure></p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">1、models.AutoField　　自增列=int(11)</div><div class="line">　 如果没有的话，默认会生成一个名称为id的列，如果要显示的定义一个自增列，必须把该列设置为主键(primary_key=True)</div><div class="line">2、models.CharField　　字符串类型字段 必须加max_length参数</div><div class="line">3、models.BooleanField　布尔类型字段=tinyint(1)  不能为空，Blank=True</div><div class="line">4、models.ComaSeparatedIntegerField　　用逗号分割的数字类型=varchar 继承CharField，所以必须加max_lenght参数</div><div class="line">5、models.DateField　　日期字段类型date</div><div class="line">　 参数auto_now=True表示每次更新都会更新这个时间；参数auto_now_add表示只是第一次创建时添加，之后的更新不再改变</div><div class="line">6、models.DateTimeField　　日期字段类型datetime  同DateField的参数</div><div class="line">7、models.Decimal　　十进制小数类型=decimal</div><div class="line">　 必须指定整数位max_digits和小数位decimal_places</div><div class="line">8、models.EmailField　　字符串类型(正则表达式邮箱)=varchar  对字符串进行正则表达式验证</div><div class="line">9、models.FloatField　　浮点类型=double</div><div class="line">10、models.IntegerField　　整形</div><div class="line">11、models.BigIntegerField　长整形</div><div class="line">　　integer_field_ranges = &#123;</div><div class="line">　　　　&apos;SmallIntegerField&apos;: (-32768, 32767),</div><div class="line">　　　　&apos;IntegerField&apos;: (-2147483648, 2147483647),</div><div class="line">　　　　&apos;BigIntegerField&apos;: (-9223372036854775808, 9223372036854775807),</div><div class="line">　　　　&apos;PositiveSmallIntegerField&apos;: (0, 32767),</div><div class="line">　　　　&apos;PositiveIntegerField&apos;: (0, 2147483647),</div><div class="line">　　&#125;</div><div class="line">12、models.IPAddressField　　字符串类型(ip4正则表达式)</div><div class="line">13、models.GenericIPAddressField　　字符串类型（ip4和ip6是可选的）</div><div class="line">　　参数protocol可以是：both、ipv4、ipv6  验证时，会根据设置进行报错</div><div class="line">14、models.NullBooleanField　　允许为空的布尔类型</div><div class="line">15、models.PositiveIntegerFiel　　正Integer</div><div class="line">16、models.PositiveSmallIntegerField　　正smallInteger</div><div class="line">17、models.SlugField　　减号、下划线、字母、数字</div><div class="line">18、models.SmallIntegerField　　数字</div><div class="line">　　数据库中的字段有：tinyint、smallint、int、bigint</div><div class="line">19、models.TextField　　字符串=longtext</div><div class="line">20、models.TimeField　　时间 HH:MM[:ss[.uuuuuu]]</div><div class="line">21、models.URLField　　字符串类型，地址正则表达式</div><div class="line">22、models.BinaryField　二进制</div><div class="line">23、models.ImageField   图片</div><div class="line">24、models.FilePathField 文件</div></pre></td></tr></table></figure>
<h2 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">1、null=True 数据库中字段是否可以为空</div><div class="line">2、blank=True django的Admin中添加数据时是否可允许空值</div><div class="line">3、primary_key=False 主键，对AutoField设置主键后，就会代替原来默认的自增id列</div><div class="line">4、auto_now和auto_now_add</div><div class="line">　　auto_now  自动创建---无论添加或修改，都是当前操作的时间</div><div class="line">　　auto_now_add  自动创建---永远是创建时的时间</div><div class="line">5、choices</div><div class="line">     GENDER_CHOICE = (</div><div class="line">          (u&apos;M&apos;, u&apos;Male&apos;),</div><div class="line">          (u&apos;F&apos;, u&apos;Female&apos;),</div><div class="line">      )</div><div class="line">     gender = models.CharField(max_length=2,choices=GENDER_CHOICE)</div><div class="line">6、max_length 最大长度</div><div class="line">7、default　　默认值</div><div class="line">8、verbose_name　　Admin中字段的显示名称</div><div class="line">9、name|db_column　数据库中的字段名称</div><div class="line">10、unique=True　　不允许重复</div><div class="line">11、db_index = True　　数据库索引</div><div class="line">12、editable=True　　在Admin里是否可编辑</div><div class="line">13、error_messages=None　　错误提示</div><div class="line">14、auto_created=False　　自动创建</div><div class="line">15、help_text　　在Admin中提示帮助信息</div><div class="line">16、validators=[]  验证</div><div class="line">17、upload-to  文件上传路径</div></pre></td></tr></table></figure>
<h2 id="关系"><a href="#关系" class="headerlink" title="关系"></a>关系</h2><h3 id="多对一"><a href="#多对一" class="headerlink" title="多对一"></a>多对一</h3><p>使用ForeignKey定义</p>
<p>这里Tag是Pic的外键，一个Pic对应一个Tag，一个Tag对应多个Pic<br>每个图片只能有一个标签，每个标签可以属于多个图片<br>文件：<strong>myDjango/myDjango/toon/models.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">class Tag(models.Model):</div><div class="line">    tagname = models.CharField(max_length=32)</div><div class="line">    def __unicode__(self):</div><div class="line">        return self.tagname</div><div class="line"></div><div class="line">class Pic(models.Model):</div><div class="line">    picname = models.CharField(max_length=32)</div><div class="line">    pic = models.ImageField(null=True,blank=True)</div><div class="line">    tags = models.ForeignKey(Tag)</div><div class="line">    def __unicode__(self):</div><div class="line">        return self.picname</div></pre></td></tr></table></figure></p>
<h3 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h3><p>使用ManyToManyField定义</p>
<p>把上例改为多对多关系，一个Pic对应多个Tag，一个Tag对应多个Pic<br>每个图片可以有多个标签，每个标签可以属于多个图片<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">class Tag(models.Model):</div><div class="line">    tagname = models.CharField(max_length=32)</div><div class="line">    def __unicode__(self):</div><div class="line">        return self.tagname</div><div class="line"></div><div class="line">class Pic(models.Model):</div><div class="line">    picname = models.CharField(max_length=32)</div><div class="line">    pic = models.ImageField(null=True,blank=True,upload_to=&apos;uploads&apos;)</div><div class="line">    tags = models.ManyToManyField(Tag) </div><div class="line">    def __unicode__(self):</div><div class="line">        return self.picname</div></pre></td></tr></table></figure></p>
<h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><p>使用OneToOneField定义</p>
<h1 id="Meta"><a href="#Meta" class="headerlink" title="Meta"></a>Meta</h1><p>使用(Meta)元数据设置默认排序方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class Tag(models.Model):</div><div class="line">    #...</div><div class="line">    class Meta:</div><div class="line">        ordering = [&apos;tagname&apos;]</div><div class="line"></div><div class="line">class Pic(models.Model):</div><div class="line">    #...</div><div class="line">    class Meta:</div><div class="line">        ordering = [&apos;picname&apos;]</div></pre></td></tr></table></figure></p>
<h1 id="更新数据库"><a href="#更新数据库" class="headerlink" title="更新数据库"></a>更新数据库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python manage.py makemigrations //生成py文件</div><div class="line">python manage.py migrate</div></pre></td></tr></table></figure>
<p>启动数据库交互<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py dbshell</div></pre></td></tr></table></figure></p>
<p>基本操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"># 增--3种方法</div><div class="line"># 第1种方法</div><div class="line">models.tb.objects.create(c1=&apos;xx&apos;, c2=&apos;oo&apos;) </div><div class="line"># 第2种方法</div><div class="line">obj = models.tb(c1=&apos;xx&apos;, c2=&apos;oo&apos;)</div><div class="line">obj.save()</div><div class="line"># 第3种方法--可以接受字典类型数据 **kwargs</div><div class="line">dic = &#123;&apos;c1&apos;:&apos;xx&apos;,&apos;c2&apos;:&apos;oo&apos;&#125;</div><div class="line">models.tb.objects.create(**dic)</div><div class="line"></div><div class="line"># 查</div><div class="line">models.tb.objects.get(id=123)         #获取单条数据，不存在则报错（不建议）</div><div class="line">models.tb.objects.all()               #获取全部数据</div><div class="line">models.tb.objects.all().first()       #获取全部数据的第1条数据</div><div class="line">models.tb.objects.filter(name=&apos;seven&apos;) #1个参数，获取指定条件的数据</div><div class="line">models.tb.objects.filter(name=&apos;seven&apos;,password=&apos;123&apos;) #2个参数，获取指定条件的数据</div><div class="line">dic = &#123;&apos;name&apos;:&apos;seven&apos;,&apos;password&apos;:&apos;123&apos;&#125;  </div><div class="line">models.tb.objects.filter(**dic)       #参数可以是字典形式，获取指定条件的数据</div><div class="line"></div><div class="line"># 删</div><div class="line">models.tb.objects.filter(name=&apos;seven&apos;).delete() # 删除指定条件的数据</div><div class="line">dic = &#123;&apos;name&apos;:&apos;seven&apos;,&apos;password&apos;:&apos;123&apos;&#125;</div><div class="line">models.tb.objects.filter(**dic).delete()  #参数是字典形式</div><div class="line"></div><div class="line"># 改</div><div class="line"># 第1种方法</div><div class="line">models.tb.objects.filter(name=&apos;seven&apos;).update(password=&apos;123&apos;) #将指定条件的数据更新</div><div class="line"># 第2种方法</div><div class="line">obj = models.tb.objects.get(id=1)</div><div class="line">obj.c1 = &apos;111&apos;</div><div class="line">obj.save()        # 修改单条数据</div><div class="line"># 第3种方法--字典参数</div><div class="line">dic = &#123;&apos;name&apos;:&apos;seven&apos;,&apos;password&apos;:&apos;123&apos;&#125;</div><div class="line">models.tb.objects.filter(**dic).update(**dic)  #参数是字典形式</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from toon.models import Pic</div><div class="line">&gt;&gt;&gt; p1 = Pic(picname=&quot;aaa&quot;,pic=&quot;&quot;,tips=&quot;a&quot;)</div><div class="line">&gt;&gt;&gt; p1.save()</div><div class="line">&gt;&gt;&gt; ps = Pic.objects.all()</div><div class="line">&gt;&gt;&gt; for p in ps:</div><div class="line">...  print p.picname</div><div class="line">... </div><div class="line">aaa</div><div class="line">&gt;&gt;&gt; ps = Pic.objects.all().order_by(&quot;picname&quot;)</div><div class="line">&gt;&gt;&gt; for p in ps:</div><div class="line">...  print p.picname</div><div class="line">... </div><div class="line">aaa</div><div class="line">bbb</div><div class="line">&gt;&gt;&gt; ps = Pic.objects.all().order_by(&quot;-picname&quot;)</div><div class="line">&gt;&gt;&gt; for p in ps:</div><div class="line">...  print p.picname</div><div class="line">... </div><div class="line">bbb</div><div class="line">aaa</div></pre></td></tr></table></figure>
<h1 id="应用举例"><a href="#应用举例" class="headerlink" title="应用举例"></a>应用举例</h1><h2 id="编写路由"><a href="#编写路由" class="headerlink" title="编写路由"></a>编写路由</h2><p>在主文件中添加路由<br>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url</div><div class="line">from myDjango.views import hello, current_datetime, hours_ahead</div><div class="line">from toon.views import showpic</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^toon/pic$&apos;,showpic)</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="编写视图函数"><a href="#编写视图函数" class="headerlink" title="编写视图函数"></a>编写视图函数</h2><p>在应用文件中添加视图函数，注意要导入模型文件<br>文件：<strong>myDjango/myDjango/toon/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">from django.http import HttpResponse</div><div class="line"></div><div class="line">from toon.models import Pic</div><div class="line"></div><div class="line">def showpic(request):</div><div class="line">    ps_str = &apos;&apos;</div><div class="line">    ps = Pic.objects.all()</div><div class="line">    for p in ps:</div><div class="line">        ps_str += p.picname</div><div class="line">        ps_str += &apos; &apos;</div><div class="line">    return HttpResponse(ps_str)</div></pre></td></tr></table></figure></p>
<h2 id="分开路由"><a href="#分开路由" class="headerlink" title="分开路由"></a>分开路由</h2><p>对于不同功能的应用，可以把路由放在不同文件中</p>
<p>在主文件夹的路由中使用include<br>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url, include</div><div class="line"></div><div class="line">from myDjango.views import hello, current_datetime, hours_ahead</div><div class="line">from toon.views import showpic</div><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    #...</div><div class="line">    url(r&apos;^toon/&apos;,include(&apos;toon.urls&apos;))</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>文件：<strong>myDjango/myDjango/toon/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url, include</div><div class="line"></div><div class="line">from toon.views import showpic</div><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^pic/&apos;,showpic)</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h1 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h1><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>在配置文件中已经默认添加了admin功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">INSTALLED_APPS = [</div><div class="line">    &apos;django.contrib.admin&apos;,</div><div class="line">    &apos;django.contrib.auth&apos;,</div><div class="line">    &apos;django.contrib.contenttypes&apos;,</div><div class="line">    &apos;django.contrib.sessions&apos;,</div><div class="line">    &apos;django.contrib.messages&apos;,</div><div class="line">    &apos;django.contrib.staticfiles&apos;,</div><div class="line">    &apos;toon&apos;,</div><div class="line">]</div><div class="line"></div><div class="line">MIDDLEWARE_CLASSES = [</div><div class="line">    &apos;django.middleware.security.SecurityMiddleware&apos;,</div><div class="line">    &apos;django.contrib.sessions.middleware.SessionMiddleware&apos;,</div><div class="line">    &apos;django.middleware.common.CommonMiddleware&apos;,</div><div class="line">    &apos;django.middleware.csrf.CsrfViewMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.AuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.auth.middleware.SessionAuthenticationMiddleware&apos;,</div><div class="line">    &apos;django.contrib.messages.middleware.MessageMiddleware&apos;,</div><div class="line">    &apos;django.middleware.clickjacking.XFrameOptionsMiddleware&apos;,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="添加管理路由"><a href="#添加管理路由" class="headerlink" title="添加管理路由"></a>添加管理路由</h2><p>admin界面默认位于[site]/admin这个URL<br>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url, include</div><div class="line"></div><div class="line">from myDjango.views import hello, current_datetime, hours_ahead</div><div class="line">from toon.views import showpic</div><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^admin/&apos;, include(admin.site.urls)),</div><div class="line">    #...</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>为了让admin界面能够管理某个数据模型，修改admin.py文件<br>文件：<strong>myDjango/myDjango/toon/admin.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">from toon.models import Pic</div><div class="line"></div><div class="line">admin.site.register(Pic)</div></pre></td></tr></table></figure></p>
<h2 id="创建超级用户"><a href="#创建超级用户" class="headerlink" title="创建超级用户"></a>创建超级用户</h2><p>在shell界面创建超级用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py createsuperuser</div></pre></td></tr></table></figure></p>
<h2 id="自定义页面"><a href="#自定义页面" class="headerlink" title="自定义页面"></a>自定义页面</h2><h3 id="添加搜索"><a href="#添加搜索" class="headerlink" title="添加搜索"></a>添加搜索</h3><p>文件：<strong>myDjango/myDjango/toon/admin.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    search_fields = (&apos;picname&apos;, &apos;tips&apos;)</div><div class="line">    #...</div></pre></td></tr></table></figure></p>
<h3 id="自定义显示列表"><a href="#自定义显示列表" class="headerlink" title="自定义显示列表"></a>自定义显示列表</h3><p>默认只显示对象的<strong>unicode</strong>值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    list_display = (&apos;picname&apos;,&apos;tips&apos;)</div><div class="line">    #...</div></pre></td></tr></table></figure></p>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><p>根据字段筛选过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    list_filter = (&apos;tips&apos;,)</div><div class="line">    #...</div></pre></td></tr></table></figure></p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>如果是降序，就在前面加个’-‘号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class TagAdmin(admin.ModelAdmin):</div><div class="line">    ordering = (&apos;tagname&apos;,)</div></pre></td></tr></table></figure></p>
<h2 id="自定义编辑页面"><a href="#自定义编辑页面" class="headerlink" title="自定义编辑页面"></a>自定义编辑页面</h2><p>当使用admin管理数据库时，可以自定义编辑页面<br>只显示指定的内容<br>文件：<strong>myDjango/myDjango/toon/admin.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">from django.contrib import admin</div><div class="line"></div><div class="line">from toon.models import Pic, Tag</div><div class="line"></div><div class="line">class TagAdmin(admin.ModelAdmin):</div><div class="line">    fields = (&apos;pic&apos;, &apos;tags&apos;)</div><div class="line"></div><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    fields = (&apos;picname&apos;, &apos;pic&apos;)</div><div class="line"></div><div class="line">admin.site.register(Tag, TagAdmin)</div><div class="line">admin.site.register(Pic, PicAdmin)</div></pre></td></tr></table></figure></p>
<p>也可以把不同内容分开显示分割成字段集<br>也可以给每个字段添加类<br>文件：<strong>myDjango/myDjango/toon/admin.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    fieldsets = (</div><div class="line">        [</div><div class="line">            &apos;Main&apos;,&#123;</div><div class="line">                &apos;fields&apos;: (&apos;picname&apos;, &apos;pic&apos;),</div><div class="line">            &#125;</div><div class="line">        ],</div><div class="line">        [</div><div class="line">            &apos;Advance&apos;,&#123;</div><div class="line">                &apos;classes&apos;: (&apos;collapse&apos;,), #CSS 隐藏</div><div class="line">                &apos;fields&apos;: (&apos;tips&apos;,),</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    )</div></pre></td></tr></table></figure></p>
<h3 id="inline"><a href="#inline" class="headerlink" title="inline"></a>inline</h3><p>在Pic页面，通过inline把Tag也显示出来<br>文件：<strong>myDjango/myDjango/toon/admin.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class TagInLine(admin.TabularInline):</div><div class="line">    model = Tag</div><div class="line"></div><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    inlines = [TagInLine]</div><div class="line">    #...</div></pre></td></tr></table></figure></p>
<h3 id="filter-horizontal"><a href="#filter-horizontal" class="headerlink" title="filter_horizontal"></a>filter_horizontal</h3><p>只能用于多对多关系<br>在创建一个Pic对象时，在选择Tag的页面可以使用搜索功能，方便查找<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">class PicAdmin(admin.ModelAdmin):</div><div class="line">    filter_horizontal = (&apos;tags&apos;,)</div></pre></td></tr></table></figure></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="http://www.cnblogs.com/maociping/p/5255834.html" target="_blank" rel="external">http://www.cnblogs.com/maociping/p/5255834.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/11/myDjango-1/" data-id="cj5c7k428003qm0u4h9i3wg5g" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/">django</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-requests" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/09/requests/" class="article-date">
  <time datetime="2016-05-09T02:16:39.000Z" itemprop="datePublished">2016-05-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/09/requests/">requests 爬虫</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="传递参数"><a href="#传递参数" class="headerlink" title="传递参数"></a>传递参数</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">param = &#123;&apos;page&apos;:&apos;2&apos;&#125; </div><div class="line">r =requests.get(&quot;http://119.29.137.50&quot;,params=param)</div></pre></td></tr></table></figure>
<h2 id="响应内容"><a href="#响应内容" class="headerlink" title="响应内容"></a>响应内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line">from PIL import Image</div><div class="line">from StringIO import StringIO</div><div class="line"></div><div class="line">r =requests.get(&quot;http://119.29.137.50&quot;)</div><div class="line">print r.text #打印内容</div><div class="line"></div><div class="line">r =requests.get(&quot;http://7xrooc.com1.z0.glb.clouddn.com/avatar.jpg&quot;)</div><div class="line">i = Image.open(StringIO(r.content)).save(&quot;temp.jpg&quot;,&quot;JPEG&quot;) #数据流形式打开并保存</div></pre></td></tr></table></figure>
<h2 id="json"><a href="#json" class="headerlink" title="json"></a>json</h2><p>使用内置解码器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">param = &#123;&quot;ak&quot;:&quot;asd&quot;,&quot;location&quot;:&quot;北京&quot;,&quot;output&quot;:&quot;json&quot;&#125; </div><div class="line">r =requests.get(&quot;http://api.map.baidu.com/telematics/v3/weather&quot;,params=param)</div><div class="line">print r.json()</div></pre></td></tr></table></figure></p>
<p>访问原始套接字<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">param = &#123;&quot;ak&quot;:&quot;asd&quot;,&quot;location&quot;:&quot;北京&quot;,&quot;output&quot;:&quot;json&quot;&#125; </div><div class="line">r =requests.get(&quot;http://api.map.baidu.com/telematics/v3/weather&quot;,params=param,stream=True)</div><div class="line">print r.raw.read()</div></pre></td></tr></table></figure></p>
<p>文本流保存文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">param = &#123;&quot;ak&quot;:&quot;asd&quot;,&quot;location&quot;:&quot;北京&quot;,&quot;output&quot;:&quot;json&quot;&#125; </div><div class="line">r =requests.get(&quot;http://api.map.baidu.com/telematics/v3/weather&quot;,params=param,stream=True)</div><div class="line"></div><div class="line">with open(&quot;temp.txt&quot;, &apos;wb&apos;) as fd:</div><div class="line">    for chunk in r.iter_content():</div><div class="line">        fd.write(chunk)</div></pre></td></tr></table></figure></p>
<h2 id="请求头和post数据"><a href="#请求头和post数据" class="headerlink" title="请求头和post数据"></a>请求头和post数据</h2><p>添加一个字典<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">data = &#123;</div><div class="line">    &quot;name&quot;:&quot;Python&quot;,</div><div class="line">    &quot;submit&quot;:&quot;Submit&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">header = &#123;</div><div class="line">    &quot;User-Agent&quot;:&quot;Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:46.0) Gecko/20100101 Firefox/46.0&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">r =requests.post(&quot;http://119.29.137.50&quot;,headers=header,data=data)</div><div class="line">print r.text</div></pre></td></tr></table></figure></p>
<h2 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">r =requests.get(&quot;http://119.29.137.50&quot;)</div><div class="line">print r.cookies</div></pre></td></tr></table></figure>
<p>发送cookies到服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">cookies = dict(cookies_are=&apos;working&apos;)</div><div class="line">r =requests.get(&quot;http://119.29.137.50&quot;,cookies=cookies)</div><div class="line">print r.text</div></pre></td></tr></table></figure></p>
<h2 id="超时"><a href="#超时" class="headerlink" title="超时"></a>超时</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line"></div><div class="line">r =requests.get(&quot;http://119.29.137.50&quot;,timeout=0.001)</div><div class="line">print r.text</div></pre></td></tr></table></figure>
<h1 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h1><h2 id="会话对象"><a href="#会话对象" class="headerlink" title="会话对象"></a>会话对象</h2><p>会话对象能够保持某些参数，比如cookies</p>
<h2 id="beautifusoup"><a href="#beautifusoup" class="headerlink" title="beautifusoup"></a>beautifusoup</h2><p>用beautifulsoup处理抓到的页面<br>按类查找标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">import requests</div><div class="line">from bs4 import BeautifulSoup</div><div class="line"></div><div class="line">html = s.get(url)</div><div class="line">soup = BeautifulSoup(html.text, &quot;lxml&quot;)</div><div class="line">links = soup.find_all(&quot;span&quot;,class_=&quot;rating_num&quot;)</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/09/requests/" data-id="cj5c7k433004fm0u4yghsagn8" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spider/">spider</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-myDjango-0" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/08/myDjango-0/" class="article-date">
  <time datetime="2016-05-08T10:58:41.000Z" itemprop="datePublished">2016-05-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/08/myDjango-0/">myDjango-0 基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>Django是python下的另一款服务器网络框架，属于重量级框架<br>MVC架构指的是：模型(model)，视图(views)，控制(controller)<br>由于Django自行处理控制部分即C，所以Django也被称为MTV框架，这里T指的是模板(Template)</p>
<h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><p>可以直接使用命令创建项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">django-admin.py startproject myDjango</div></pre></td></tr></table></figure></p>
<p>创建的项目结构如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">myDjango</div><div class="line">├── manage.py</div><div class="line">└── myDjango</div><div class="line">    ├── __init__.py</div><div class="line">    ├── settings.py</div><div class="line">    ├── urls.py</div><div class="line">    └── wsgi.py</div></pre></td></tr></table></figure></p>
<p>启动测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage.py runserver 5000</div></pre></td></tr></table></figure></p>
<h1 id="视图和URL配置-路由"><a href="#视图和URL配置-路由" class="headerlink" title="视图和URL配置(路由)"></a>视图和URL配置(路由)</h1><p>一个简单的视图<br>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#导入HttpResponse类</div><div class="line">from django.http import HttpResponse</div><div class="line"></div><div class="line">def hello(request):</div><div class="line">    return HttpResponse(&quot;hello world&quot;)</div></pre></td></tr></table></figure></p>
<p>默认的urls.py注释了很多常用功能</p>
<p>url()除了常用的两个参数外，还有kwargs和name参数<br>kwargs参数是一个字典形式参数，用来传递参数给视图函数<br>name参数据是URL的名字</p>
<p>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url</div><div class="line"></div><div class="line">#第一个元素是模式匹配字符串(正则表达式)</div><div class="line">#第二个元素是视图函数</div><div class="line">#这里^$分别匹配开头和结尾</div><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^$&apos;, &apos;myDjango.views.hello&apos;),</div><div class="line">]</div></pre></td></tr></table></figure></p>
<h2 id="render"><a href="#render" class="headerlink" title="render()"></a>render()</h2><p>render()第一个参数是请求对象，第二个参数是模板名字，第三个参数是字典<br>返回一个HttpResponse对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return render(request, &quot;index.html&quot;, c)</div></pre></td></tr></table></figure></p>
<h2 id="引发一个404错误"><a href="#引发一个404错误" class="headerlink" title="引发一个404错误"></a>引发一个404错误</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">from django.http import Http404</div><div class="line"></div><div class="line">raise Http404(&quot;Not found&quot;)</div></pre></td></tr></table></figure>
<h2 id="import"><a href="#import" class="headerlink" title="import"></a>import</h2><p>可以在路由开头使用import导入视图函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from django.conf.urls import patterns, url</div><div class="line">from myDjango.views import hello, current_datetime</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(r&apos;^$&apos;, hello),</div><div class="line">    url(r&apos;^time$&apos;,current_datetime)</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>添加一个显示时间的视图函数<br>注意在显示中文时要在开头指定编码格式<br>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#!-*-coding:utf-8-*-</div><div class="line"></div><div class="line">from django.http import HttpResponse</div><div class="line">import datetime</div><div class="line"></div><div class="line">def hello(request):</div><div class="line">    return HttpResponse(&quot;hello world&quot;)</div><div class="line"></div><div class="line">def current_datetime(request):</div><div class="line">    now = datetime.datetime.now()</div><div class="line">    html = &quot;&lt;html&gt;&lt;body&gt;现在时间:%s&lt;/body&gt;&lt;/html&gt;&quot; %now</div><div class="line">    return HttpResponse(html)</div></pre></td></tr></table></figure></p>
<p>时区是在setting.py中设置的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">TIME_ZONE = &apos;Asia/Shanghai&apos;</div></pre></td></tr></table></figure></p>
<p>使用通配符处理URL，这里是匹配1位数及以上的数字<br><strong>如果作为参数传递，需要使用圆括号括起来</strong><br>文件：<strong>myDjango/myDjango/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">url(r&apos;^time/plus/(\d+)/$&apos;,hours_ahead)</div></pre></td></tr></table></figure></p>
<p>视图函数需要接收传递的参数<br>request是一个HttpRequest对象，每个视图都是以它为第一个参数<br>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">def hours_ahead(request, offset):</div><div class="line">    try:</div><div class="line">        offset = int(offset)</div><div class="line">    except ValueError:</div><div class="line">        raise Http404()</div><div class="line">    now = datetime.datetime.now() + datetime.timedelta(hours=offset)</div><div class="line">    html = &quot;&lt;html&gt;&lt;body&gt;现在时间:%s&lt;/body&gt;&lt;/html&gt;&quot; %now</div><div class="line">    return HttpResponse(html)</div></pre></td></tr></table></figure></p>
<h1 id="T-模板-Template"><a href="#T-模板-Template" class="headerlink" title="T 模板(Template)"></a>T 模板(Template)</h1><p>Django的模板指的是文本，用于产生HTML<br>可以在HTML中写python<br>变量的写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; something &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>if语句和for循环<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;% if a %&#125;</div><div class="line">    something</div><div class="line">&#123;% else %&#125;</div><div class="line">    another</div><div class="line">&#123;% endif %&#125;</div><div class="line"></div><div class="line">&#123;% for a in as %&#125;</div><div class="line">    do something</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<p>注释<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;# 这是注释 #&#125;</div></pre></td></tr></table></figure></p>
<p>反向迭代<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;% for a in as reversed %&#125;</div><div class="line">    do something</div><div class="line">&#123;% endif %&#125;</div></pre></td></tr></table></figure></p>
<p>过滤器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; name|lower &#125;&#125;</div></pre></td></tr></table></figure></p>
<p>创建一个template实例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from django.template import Template</div><div class="line">&gt;&gt;&gt; t=Template(&quot;i am &#123;&#123; name &#125;&#125;&quot;)</div></pre></td></tr></table></figure></p>
<p>可以使用context来传递参数给这个template对象<br>context在Django中是一个Context(上下文)对象<br>template对象的render()方法可以用来接收传递参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; from django.template import Context</div><div class="line">&gt;&gt;&gt; c=Context(&#123;&quot;name&quot;:&quot;harry&quot;&#125;)</div><div class="line">&gt;&gt;&gt; t.render(c)</div><div class="line">u&apos;i am harry&apos;</div><div class="line">&gt;&gt;&gt; print t.render(c)</div><div class="line">i am harry</div></pre></td></tr></table></figure></p>
<p>同一个模板对象可以渲染多个context<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; c2=Context(&#123;&quot;name&quot;:&quot;herui&quot;&#125;)</div><div class="line">&gt;&gt;&gt; print t.render(c2)</div><div class="line">i am herui</div></pre></td></tr></table></figure></p>
<h2 id="导入模板"><a href="#导入模板" class="headerlink" title="导入模板"></a>导入模板</h2><p>配置<br>BACKEND 是一个指向Django后端API，内置的有<br>django.template.backends.django.DjangoTemplates<br>django.template.backends.jinja2.Jinja2 (Jinja2引擎)<br>必须使用绝对路径<br>文件：<strong>myDjango/myDjango/setting.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">TEMPLATES = [</div><div class="line">    &#123;</div><div class="line">        &apos;BACKEND&apos;: &apos;django.template.backends.django.DjangoTemplates&apos;,</div><div class="line">        &apos;DIRS&apos;: [os.path.join(os.path.dirname(__file__),&quot;templates&quot;)],</div><div class="line">        &apos;APP_DIRS&apos;: True,</div><div class="line">        &apos;OPTIONS&apos;: &#123;</div><div class="line">            &apos;context_processors&apos;: [</div><div class="line">                &apos;django.template.context_processors.debug&apos;,</div><div class="line">                &apos;django.template.context_processors.request&apos;,</div><div class="line">                &apos;django.contrib.auth.context_processors.auth&apos;,</div><div class="line">                &apos;django.contrib.messages.context_processors.messages&apos;,</div><div class="line">            ],</div><div class="line">        &#125;,</div><div class="line">    &#125;,</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>视图函数<br>django.template.loader定义了两个函数加载模板</p>
<p>使用get_template()加载模板，返回一个Template对象<br>如果模板文件在templates子目录中，添相应的斜杠，get_template(“west/example.html”)<br>获得Template对象之后，使用Context渲染<br>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from django.http import HttpResponse</div><div class="line">from django.template.loader import get_template</div><div class="line">from django.template import Context</div><div class="line"></div><div class="line">def hello(request):</div><div class="line">    return HttpResponse(get_template(&quot;index.html&quot;)\</div><div class="line">        .render(&#123;&quot;label&quot;:&quot;hello&quot;&#125;))</div></pre></td></tr></table></figure></p>
<p>select_template()用模板名称列表作为参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">select_template([&apos;story_%s_detail.html&apos; % story.id, &apos;story_detail.html&apos;])</div></pre></td></tr></table></figure></p>
<p>简单的模板<br>文件：<strong>myDjango/myDjango/templates/index.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;h2&gt;&#123;&#123; label &#125;&#125;&lt;/h2&gt;</div></pre></td></tr></table></figure></p>
<h3 id="render-to-response"><a href="#render-to-response" class="headerlink" title="render_to_response()"></a>render_to_response()</h3><p>render_to_response()能直接实现载入模板并渲染</p>
<ul>
<li>第一个参数是使用的模板名称</li>
<li>第二个参数是Context字典，可选参数</li>
</ul>
<p>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from django.shortcuts import render_to_response</div><div class="line"></div><div class="line">def hello(request):</div><div class="line">    return render_to_response(&quot;index.html&quot;,\</div><div class="line">        &#123;&quot;label&quot;:&quot;hello world&quot;&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="locals"><a href="#locals" class="headerlink" title="locals()"></a>locals()</h3><p>locals()包括了到执行时间点所有变量的映射<br>这里的locals()就相当于之前的字典<br>locals()的值为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    &apos;request&apos;: &lt;WSGIRequest: GET &apos;/time&apos;&gt;, </div><div class="line">    &apos;label&apos;: datetime.datetime(2016, 5, 11, 16, 34, 19, 157325)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>文件：<strong>myDjango/myDjango/views.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">def current_datetime(request):</div><div class="line">    label = datetime.datetime.now()</div><div class="line">    return render_to_response(&quot;index.html&quot;,locals())</div></pre></td></tr></table></figure></p>
<h3 id="include"><a href="#include" class="headerlink" title="include"></a>include</h3><p>在模板文件中可以导入其他模板<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;% include &quot;index2.html&quot; %&#125;</div><div class="line">&#123;% include &quot;ano/index3.html&quot; %&#125;</div><div class="line">&#123;% include temp_name %&#125;</div></pre></td></tr></table></figure></p>
<p>在index中导入include/time.html<br>如果在debug模式，没找到导入的文件会报错<br>如果不在debug模式，会无视这个导入<br>文件：<strong>myDjango/myDjango/templates/include/time.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;h2&gt;&#123;&#123; current_time &#125;&#125;&lt;/h2&gt;</div></pre></td></tr></table></figure></p>
<p>文件：<strong>myDjango/myDjango/templates/index.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&#123;% include &quot;include/time.html&quot; %&#125;</div><div class="line">&lt;h2&gt;&#123;&#123; label &#125;&#125;&lt;/h2&gt;</div></pre></td></tr></table></figure></p>
<p>视图函数<br>访问页面显示时间和问候语<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">from django.shortcuts import render_to_response</div><div class="line">import datetime</div><div class="line"></div><div class="line">def current_datetime(request):</div><div class="line">    current_time = datetime.datetime.now()</div><div class="line">    label = &quot;hello&quot;</div><div class="line">    return render_to_response(&quot;index.html&quot;,locals())</div></pre></td></tr></table></figure></p>
<h2 id="模板继承"><a href="#模板继承" class="headerlink" title="模板继承"></a>模板继承</h2><p>先构造一个基础模板，然后子模板对块进行修改<br>基础模板中把可以更改的地方用block块包起来<br>文件：<strong>myDjango/myDjango/templates/base.html</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line">&lt;html lang=&quot;en&quot;&gt;</div><div class="line">    &#123;% block head %&#125;</div><div class="line">    &lt;head&gt;</div><div class="line">        &lt;meta charset=utf-8 / &gt;</div><div class="line">        &lt;title&gt;&#123;% block title %&#125;myDjango&#123;% endblock %&#125;&lt;/title&gt;</div><div class="line">    &lt;/head&gt;</div><div class="line">    &#123;% endblock %&#125;</div><div class="line"></div><div class="line">    &#123;% block body %&#125;</div><div class="line">    &lt;body&gt;</div><div class="line">        &lt;h1&gt;welcome to my Django&lt;/h1&gt;</div><div class="line">        &#123;% block content %&#125;&#123;% endblock %&#125;</div><div class="line">        &lt;p&gt;thanks&lt;/p&gt;</div><div class="line">    &lt;/body&gt;</div><div class="line">    &#123;% endblock %&#125;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>使用extends继承<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;% extends &quot;base.html&quot; %&#125;</div><div class="line"></div><div class="line">&#123;% block title %&#125;Home&#123;% endblock %&#125;</div><div class="line"></div><div class="line">&#123;% block content %&#125;</div><div class="line">&lt;p&gt;lalalala&lt;/p&gt;</div><div class="line">&#123;% endblock %&#125;</div></pre></td></tr></table></figure></p>
<p>参考<br><a href="http://python.usyiyi.cn/django/index.html" target="_blank" rel="external">http://python.usyiyi.cn/django/index.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/08/myDjango-0/" data-id="cj5c7k424003nm0u477powdzs" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/">django</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-06" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/07/jQuery-06/" class="article-date">
  <time datetime="2016-05-07T03:04:19.000Z" itemprop="datePublished">2016-05-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/07/jQuery-06/">jQuery-06 Ajax</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简易服务器"><a href="#简易服务器" class="headerlink" title="简易服务器"></a>简易服务器</h1><p>使用python可以开启一个简易的服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure></p>
<h1 id="load-方法"><a href="#load-方法" class="headerlink" title="load() 方法"></a>load() 方法</h1><p>载入远程HTML文件，并加载到DOM中，默认使用GET方式，如果传递参数，自动转为POST</p>
<ul>
<li>第一个参数是URL地址</li>
<li>第二个参数是发送到服务器的数据</li>
<li>第三个参数是回调函数(无论是否载入成功都会执行)</li>
</ul>
<p>载入一个名为test.html的文件，加载到名为restest的元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;#restest&quot;).load(&quot;test.html&quot;)</div></pre></td></tr></table></figure></p>
<p>可以筛选加载指定内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;#restest&quot;).load(&quot;index.html .dongmanRange a&quot;)</div></pre></td></tr></table></figure></p>
<h1 id="get"><a href="#get" class="headerlink" title=".get()"></a>.get()</h1><p>通过GET请求载入信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#test_send&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $.get(&quot;temp.html&quot;,function(data) //data就是返回的内容</div><div class="line">        &#123;</div><div class="line">            alert(data);</div><div class="line">        &#125;);</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h1 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h1><p>后面Ajax的内容涉及到PHP的JSON，等级太低，看不太懂，这本书的阅读就先到这边了~<br>总的来说，这本书是一本不错的工具书，不过使用的jQuery版本比较低，配合官方手册一起看更佳~</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/07/jQuery-06/" data-id="cj5c7k38q0011m0u4nbx9340z" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-05" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/04/jQuery-05/" class="article-date">
  <time datetime="2016-05-04T06:33:25.000Z" itemprop="datePublished">2016-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/04/jQuery-05/">jQuery-05 表单和表格</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="表单应用"><a href="#表单应用" class="headerlink" title="表单应用"></a>表单应用</h1><p>之前通过focus和blur方法设置表单默认值时就是一个例子，下面还有其他例子</p>
<h2 id="多行文本框"><a href="#多行文本框" class="headerlink" title="多行文本框"></a>多行文本框</h2><p>首先创建一个表单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;form&gt;</div><div class="line">    &lt;div class=&quot;msg&quot;&gt;</div><div class="line">        &lt;div class=&quot;msg_con&quot;&gt;</div><div class="line">            &lt;span class=&quot;bigger&quot;&gt;放大&lt;/span&gt;</div><div class="line">            &lt;span class=&quot;smaller&quot;&gt;缩小&lt;/span&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;div&gt;</div><div class="line">            &lt;textarea id=&quot;editarea&quot; rows=&quot;8&quot; cols=&quot;20&quot;&gt;--&lt;/textarea&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure></p>
<p>要实现的功能如下</p>
<ul>
<li>当点击放大按钮之后，如果高度小于500px就增大50px</li>
<li>当点击缩小按钮之后，如果高度大于50px就减少50px</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    var $editarea = $(&quot;#editarea&quot;); //找出表单输入框</div><div class="line">    $(&quot;.bigger&quot;).click(function() //放大</div><div class="line">    &#123;</div><div class="line">        if ($editarea.height() &lt; 500)</div><div class="line">        &#123;</div><div class="line">            $editarea.height($editarea.height() + 50); //高度加50</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line">    $(&quot;.smaller&quot;).click(function() //缩小</div><div class="line">    &#123;</div><div class="line">        if ($editarea.height() &gt; 50)</div><div class="line">        &#123;</div><div class="line">            $editarea.height($editarea.height() - 50); //高度减50</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>点击按钮之后，高度迅速变化<br>为了美观，也可以使用动画<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    var $editarea = $(&quot;#editarea&quot;);</div><div class="line">    $(&quot;.bigger&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        if ($editarea.height() &lt; 500)</div><div class="line">        &#123;</div><div class="line">            $editarea.animate(&#123;&quot;height&quot;:&quot;+=50&quot;&#125;,&quot;slow&quot;);</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line">    $(&quot;.smaller&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        if ($editarea.height() &gt; 50)</div><div class="line">        &#123;</div><div class="line">            $editarea.animate(&#123;&quot;height&quot;:&quot;-=50&quot;&#125;,&quot;slow&quot;);</div><div class="line">        &#125;</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>操控滚动条是使用的scrollTop属性<br>通过按钮实现，滚动条上下移动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$editarea.animate(&#123;&quot;scrollTop&quot;:&quot;+=50&quot;&#125;,&quot;slow&quot;);</div></pre></td></tr></table></figure></p>
<h2 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h2><p>最基本的应用是对复选框的全选、反选操作<br>主要通过复选框选诉的checked属性来设置<br>当checked属性为true时，说明被选中，反之没有</p>
<p>首先建立一个表单，有一些复选框和一个全选复选框<br>当勾选”全选”复选框时，全部勾选<br>取消勾选”全部”复选框时，全部不勾选<br>按下提交按钮时，获取到checked属性为true的复选框的值，然后都打印出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;div&gt;</div><div class="line">    &lt;form&gt;</div><div class="line">        you like ? &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; id=&quot;asd&quot; name=&quot;items&quot; value=&quot;萝莉&quot; / &gt; 萝莉 &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;items&quot; value=&quot;御姐&quot; / &gt; 御姐 &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;items&quot; value=&quot;三无&quot; / &gt; 三无 &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;items&quot; value=&quot;变态&quot; / &gt; 变态 &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;items&quot; value=&quot;病娇&quot; / &gt; 病娇 &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;checkbox&quot; id=&quot;selectall_box&quot; value=&quot;全选&quot; / &gt; 全选  &lt;br / &gt;</div><div class="line">        &lt;input type=&quot;button&quot; id=&quot;send_box&quot; value=&quot;提交&quot; / &gt; &lt;br / &gt;</div><div class="line">    &lt;/form&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>这里用到了prop方法更改checked属性，因为jQuery的库的兼容问题，如果使用attr会出现第二次不能勾选的情况<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(&quot;...&quot;).prop(&quot;checked&quot;); //用于判断</div><div class="line">$(&quot;...&quot;).prop(&quot;disabled&quot;, false); //设置为不勾选</div><div class="line">$(&quot;...&quot;).prop(&quot;checked&quot;, true); //设置为勾选</div></pre></td></tr></table></figure></p>
<p>遍历每个对象使用了each()方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#selectall_box&quot;).click(function()  //全选复选框</div><div class="line">    &#123;</div><div class="line">        if ($(this).prop(&quot;checked&quot;)) //勾选</div><div class="line">        &#123;</div><div class="line">            $(&quot;[name=items]:checkbox&quot;).prop(&quot;checked&quot;,true);</div><div class="line">        &#125;</div><div class="line">        else //取消勾选</div><div class="line">        &#123;</div><div class="line">            $(&quot;[name=items]:checkbox&quot;).prop(&quot;checked&quot;,false);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    $(&quot;#send_box&quot;).click(function() //提交</div><div class="line">    &#123;</div><div class="line">        var likelis = &quot;you like:\r\n&quot;;</div><div class="line">        $(&quot;[name=items]:checkbox:checked&quot;).each(function() //使用each遍历</div><div class="line">        &#123;</div><div class="line">            likelis += $(this).val() + &quot;\r\n&quot;; //val()获得表单值</div><div class="line">        &#125;);</div><div class="line">        alert(likelis);</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="下拉框"><a href="#下拉框" class="headerlink" title="下拉框"></a>下拉框</h2><p>主要实现下面的功能</p>
<ul>
<li>能将选中的选项添加给对方</li>
<li>能将全部选项添加给对方</li>
<li>双击添加</li>
</ul>
<p>首先在文档中添加下拉框<br>一共有两个下拉框，”multiple”显示全部元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;select_path&quot;&gt;</div><div class="line">    &lt;select multiple id=&quot;select_test1&quot;&gt;</div><div class="line">        &lt;option value=&quot;1&quot;&gt;1&lt;/option&gt;</div><div class="line">        &lt;option value=&quot;2&quot;&gt;2&lt;/option&gt;</div><div class="line">        &lt;option value=&quot;3&quot;&gt;3&lt;/option&gt;</div><div class="line">        &lt;option value=&quot;4&quot;&gt;4&lt;/option&gt;</div><div class="line">        &lt;option value=&quot;5&quot;&gt;5&lt;/option&gt;</div><div class="line">    &lt;/select&gt;</div><div class="line">    &lt;select multiple id=&quot;select_test2&quot;&gt;</div><div class="line">    &lt;/select&gt;</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;a href=&quot;#&quot; id=&quot;select_add&quot;&gt;添加&lt;/a&gt;</div><div class="line">        &lt;a href=&quot;#&quot; id=&quot;select_all&quot;&gt;全部添加&lt;/a&gt;</div><div class="line">        &lt;a href=&quot;#&quot; id=&quot;select_remove&quot;&gt;删除&lt;/a&gt;</div><div class="line">        &lt;a href=&quot;#&quot; id=&quot;select_removeall&quot;&gt;全部删除&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>JavaScript代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#select_add&quot;).click(function() //添加</div><div class="line">    &#123;</div><div class="line">        var $option = $(&quot;#select_test1 option:selected&quot;);</div><div class="line">        $option.appendTo(&quot;#select_test2&quot;); //移动追加</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#select_all&quot;).click(function() //全部添加</div><div class="line">    &#123;</div><div class="line">        var $options = $(&quot;#select_test1 option&quot;);</div><div class="line">        $options.appendTo(&quot;#select_test2&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#select_remove&quot;).click(function() //移除</div><div class="line">    &#123;</div><div class="line">        var $option = $(&quot;#select_test2 option:selected&quot;);</div><div class="line">        $option.appendTo(&quot;#select_test1&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#select_removeall&quot;).click(function() //全部移除</div><div class="line">    &#123;</div><div class="line">        var $options = $(&quot;#select_test2 option&quot;);</div><div class="line">        $options.appendTo(&quot;#select_test1&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#select_test1&quot;).dblclick(function() //双击添加</div><div class="line">    &#123;</div><div class="line">        var $option = $(&quot;#select_test1 option:selected&quot;);</div><div class="line">        $option.appendTo(&quot;#select_test2&quot;);</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#select_test2&quot;).dblclick(function() //双击删除</div><div class="line">    &#123;</div><div class="line">        var $option = $(&quot;#select_test2 option:selected&quot;);</div><div class="line">        $option.appendTo(&quot;#select_test1&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/04/jQuery-05/" data-id="cj5c7k38z0015m0u4d7q8gk37" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-04" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/03/jQuery-04/" class="article-date">
  <time datetime="2016-05-03T01:06:47.000Z" itemprop="datePublished">2016-05-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/03/jQuery-04/">jQuery-04 jQuery中的事件和动画</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>jQuery增加并扩展了基本的事件处理机制</p>
<h1 id="jQuery中的事件"><a href="#jQuery中的事件" class="headerlink" title="jQuery中的事件"></a>jQuery中的事件</h1><h2 id="加载DOM"><a href="#加载DOM" class="headerlink" title="加载DOM"></a>加载DOM</h2><p>在页面加载完毕之后，浏览器会通过JavaScript为DOM元素添加事件</p>
<p>在常规JavaScript中，通常使用window.onload方法<br>在jQuery中，使用<code>$(document).ready()</code>方法</p>
<h3 id="执行时机"><a href="#执行时机" class="headerlink" title="执行时机"></a>执行时机</h3><p>window.onload方法是在网页中所有元素完全加载到浏览器之后才执行，包括文档和图片</p>
<p>jQuery中的<code>$(document).ready()</code>在DOM完全就绪时就可以被调用，这是并不意味者所有文件和图片已经加载完毕</p>
<p>如果处理对象绑定在window上，则会在所有内容加载完执行</p>
<h3 id="简写形式"><a href="#简写形式" class="headerlink" title="简写形式"></a>简写形式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">	//code</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>可以简写成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">	//code</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><code>$(document)</code>可以简写成<code>$()</code>，默认参数就是document<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$().ready(function()</div><div class="line">&#123;</div><div class="line">	//code</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2><p>在文档装载完毕之后，如果打算为元素绑定事件来完成某项操作，可以使用bind()方法</p>
<p>第一个参数是含有一个或多喝事件类型的字符串，以空格隔开<br>第二个参数是可选参数，作为event.data属性值传递给事件对象的额外数据对象<br>第三个参数绑定处理函数，如果值为false会使默认动作失效</p>
<h3 id="基本效果"><a href="#基本效果" class="headerlink" title="基本效果"></a>基本效果</h3><p>之前的目录可以这样写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123; </div><div class="line">    $(&quot;.has_children&quot;).bind(&apos;mouseover click&apos;,function()</div><div class="line">    &#123;</div><div class="line">        $(this).addClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).show().end()</div><div class="line">            .siblings().removeClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).hide();</div><div class="line">        return false; //通过false取消默认行为</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h3><p>对于click、mouseover和mouseout这类事件，可以使用简写方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123; </div><div class="line">    $(&quot;.has_children&quot;).mouseover(function()</div><div class="line">    &#123;</div><div class="line">        $(this).addClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).show().end()</div><div class="line">            .siblings().removeClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).hide();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="合成事件"><a href="#合成事件" class="headerlink" title="合成事件"></a>合成事件</h2><p>jQuery有两个合成事件，<code>hover()</code>方法和<code>toggle()</code>方法，<code>toggle()</code>方法在1.9版本移除</p>
<p><code>hover()</code>方法的语法结构<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">houver([over,] out)</div></pre></td></tr></table></figure></p>
<p>第一个参数是鼠标移动到元素上要触发的函数<br>第二个参数是移除元素要触发的函数</p>
<p>当鼠标移动到元素上停止不动时，不会再触发任何函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#message&quot;).hover(function()</div><div class="line">    &#123;</div><div class="line">        $(this).hide();</div><div class="line">    &#125;,</div><div class="line">    function()</div><div class="line">    &#123;</div><div class="line">        $(this).show();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="事件冒泡"><a href="#事件冒泡" class="headerlink" title="事件冒泡"></a>事件冒泡</h2><p>当多个元素被绑定同一事件，且元素为嵌套关系，当触发事件时，事件会按照DOM层次结构像水泡一样不断向上直至顶端</p>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><p>获取事件对象只需要添加一个参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123; </div><div class="line">    $(&quot;.has_children&quot;).bind(&apos;mouseover&apos;,function(event) //event:事件对象</div><div class="line">    &#123;</div><div class="line">        //</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="停止冒泡事件"><a href="#停止冒泡事件" class="headerlink" title="停止冒泡事件"></a>停止冒泡事件</h3><p>使用<code>stopPropagation()</code>方法停止冒泡事件<br>文档结构如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;test1&quot;&gt;</div><div class="line">    &lt;p id=&quot;test2&quot;&gt;</div><div class="line">        &lt;a id=&quot;test3&quot; href=&quot;#&quot;&gt;</div><div class="line">            &lt;img src=&quot;./static/image/logo.png&quot; id=&quot;test4&quot; / &gt;</div><div class="line">        &lt;/a&gt;</div><div class="line">    &lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>下例只输出4<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#test1&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;1&quot;)</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test2&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;2&quot;)</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test3&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;3&quot;)</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test4&quot;).click(function(event)</div><div class="line">    &#123;</div><div class="line">        alert(&quot;4&quot;)</div><div class="line">        event.stopPropagation();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>下例输出4、3、2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#test1&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;1&quot;)</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test2&quot;).click(function(event)</div><div class="line">    &#123;</div><div class="line">        alert(&quot;2&quot;)</div><div class="line">        event.stopPropagation();</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test3&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;3&quot;)</div><div class="line">    &#125;),</div><div class="line">    $(&quot;#test4&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;4&quot;)</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>也可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return false;</div></pre></td></tr></table></figure></p>
<h3 id="阻止默认行为"><a href="#阻止默认行为" class="headerlink" title="阻止默认行为"></a>阻止默认行为</h3><p>通过preventDefault()只取消默认行为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123; </div><div class="line">    $(&quot;.has_children&quot;).bind(&apos;click&apos;,function(event)</div><div class="line">    &#123;</div><div class="line">        //...</div><div class="line">        event.preventDefault();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>也可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">return false;</div></pre></td></tr></table></figure></p>
<h2 id="事件对象的属性"><a href="#事件对象的属性" class="headerlink" title="事件对象的属性"></a>事件对象的属性</h2><p>jQuery对事件对象的常用属性进行了封装</p>
<h3 id="event-type-属性"><a href="#event-type-属性" class="headerlink" title="event.type 属性"></a><code>event.type</code> 属性</h3><p>获得事件类型<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(&quot;#test4&quot;).click(function(e)</div><div class="line">&#123;</div><div class="line">    alert(e.type)</div><div class="line">    return false;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="event-preventDefault-方法"><a href="#event-preventDefault-方法" class="headerlink" title="event.preventDefault() 方法"></a><code>event.preventDefault()</code> 方法</h3><p>阻止默认事件</p>
<h3 id="event-stopPropagation-方法"><a href="#event-stopPropagation-方法" class="headerlink" title="event.stopPropagation() 方法"></a><code>event.stopPropagation()</code> 方法</h3><p>阻止冒泡事件</p>
<h3 id="event-target-属性"><a href="#event-target-属性" class="headerlink" title="event.target 属性"></a><code>event.target</code> 属性</h3><p>获取触发事件的DOM元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#test4&quot;).click(function(e)</div><div class="line">    &#123;</div><div class="line">        alert(e.target.src)</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="event-relatedTarget-属性"><a href="#event-relatedTarget-属性" class="headerlink" title="event.relatedTarget 属性"></a><code>event.relatedTarget</code> 属性</h3><p>事件中涉及的其他DOM元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(&quot;#test4&quot;).mouseout(function(event) </div><div class="line">&#123;</div><div class="line">    alert(event.relatedTarget.nodeName); // &quot;DIV&quot;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h3 id="event-pageX-pageY-属性"><a href="#event-pageX-pageY-属性" class="headerlink" title="event.pageX/pageY 属性"></a><code>event.pageX/pageY</code> 属性</h3><p>event.pageX 鼠标相对于文档的左边缘的位置<br>event.pageY 鼠标相对于文档顶部边缘的位置</p>
<h3 id="event-which-属性"><a href="#event-which-属性" class="headerlink" title="event.which 属性"></a><code>event.which</code> 属性</h3><p>针对鼠标和键盘事件，这个属性能确定按的哪个键<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#test4&quot;).click(function(e)</div><div class="line">    &#123;</div><div class="line">        alert(e.which);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="event-data-属性"><a href="#event-data-属性" class="headerlink" title="event.data 属性"></a><code>event.data</code> 属性</h3><p>传递的数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(&quot;a&quot;).each(function(i) &#123;</div><div class="line">    $(this).bind(&apos;click&apos;, &#123;index:i&#125;, function(e)&#123;</div><div class="line">       alert(&apos;my index is &apos; + e.data.index);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="移除事件"><a href="#移除事件" class="headerlink" title="移除事件"></a>移除事件</h2><p>不仅可以为同一个元素绑定多个事件，也可以绑定多个同一事件</p>
<p>使用<code>unbind()</code>移除绑定事件</p>
<p>第一个参数是事件类型，第二个参数是要移除的函数(创建时需要把匿名函数赋值给一个变量)<br>如果没有参数，删除所有绑定的事件<br>如果只提供了事件类型，只删除该类型的绑定事件</p>
<h2 id="模拟操作"><a href="#模拟操作" class="headerlink" title="模拟操作"></a>模拟操作</h2><p>使用<code>trigger()</code>方法可以用来触发一个事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(&quot;#test4&quot;).trigger(&quot;click&quot;)</div><div class="line"></div><div class="line">$(&quot;#pageJump&quot;).trigger(&quot;focus&quot;)</div></pre></td></tr></table></figure></p>
<p>也可以用来触发自定义事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(&quot;#test4&quot;).bind(&apos;myClick&apos;, function(e)</div><div class="line">&#123;</div><div class="line">    alert(&quot;4&quot;);</div><div class="line">    return false;</div><div class="line">&#125;)</div><div class="line">$(&quot;#test4&quot;).trigger(&quot;myClick&quot;)</div></pre></td></tr></table></figure></p>
<h1 id="jQuery中的动画"><a href="#jQuery中的动画" class="headerlink" title="jQuery中的动画"></a>jQuery中的动画</h1><h2 id="show-和hide-方法"><a href="#show-和hide-方法" class="headerlink" title="show()和hide()方法"></a><code>show()</code>和<code>hide()</code>方法</h2><p>如果调用<code>hide()</code>方法，会把一个元素的display样式改为”none”<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;element&quot;).hide()</div></pre></td></tr></table></figure></p>
<p>相当于<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;element&quot;).css(&quot;display&quot;,&quot;none&quot;);</div></pre></td></tr></table></figure></p>
<p><code>show()</code>方法和<code>hide()</code>方法相反，会把display属性还原到调用<code>hide()</code>方法之前的状态</p>
<p>可以指定参数”slow”或者”fast”设置显示速度的快慢，也可以指定时间(ms)</p>
<h2 id="fadeIn-和fadeOut-方法"><a href="#fadeIn-和fadeOut-方法" class="headerlink" title="fadeIn()和fadeOut()方法"></a><code>fadeIn()</code>和<code>fadeOut()</code>方法</h2><p><code>fadeIn()</code> 和 <code>fadeOut()</code> 只改变元素的不透明度直至消失或出现，同样可以指定时间参数</p>
<h2 id="slideUp-和slideDown-方法"><a href="#slideUp-和slideDown-方法" class="headerlink" title="slideUp()和slideDown()方法"></a><code>slideUp()</code>和<code>slideDown()</code>方法</h2><p>只会改变元素的高度<br><code>slideUp()</code>是由下到上隐藏<br><code>slideDown()</code>是由上到下出现</p>
<h2 id="自定义动画方法animate"><a href="#自定义动画方法animate" class="headerlink" title="自定义动画方法animate()"></a>自定义动画方法<code>animate()</code></h2><p><code>animate(params, speed, callback)</code><br>第一个参数是样式属性和值的映射，比如<code>{top:&quot;100px&quot;,left:&quot;100px&quot;}</code><br>第二个参数是速度参数<code>(&quot;slow&quot;，&quot;normal&quot;，or &quot;fast&quot;)</code>，单位ms，可选<br>第三个参数是动画完成后执行的函数，可选</p>
<h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><p>通过点击两个链接，实现id为fly的元素的左右移动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#left&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;200px&quot;&#125;,&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;600px&quot;&#125;,&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="累加"><a href="#累加" class="headerlink" title="累加"></a>累加</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#left&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;-=50px&quot;&#125;,&quot;fast&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;&#125;,&quot;fast&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="多重动画"><a href="#多重动画" class="headerlink" title="多重动画"></a>多重动画</h3><p>在移动过程中同时改变透明度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#left&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;-=50px&quot;,opacity:&quot;toggle&quot;&#125;,&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;,opacity:&quot;toggle&quot;&#125;,&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>如果需要有先后顺序，可以链式赋值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#left&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;-=50px&quot;&#125;,&quot;slow&quot;)</div><div class="line">            .animate(&#123;height:&quot;+=20px&quot;&#125;,&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h3><p>在动画执行完之后改变css样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#left&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;-=50px&quot;&#125;,&quot;slow&quot;, function()</div><div class="line">            &#123;</div><div class="line">                $(this).css(&quot;src&quot;,&quot;./static/pic2/pic0.jpg&quot;);</div><div class="line">            &#125;);</div><div class="line">        return false;</div><div class="line">    &#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="停止动画"><a href="#停止动画" class="headerlink" title="停止动画"></a>停止动画</h2><p><code>stop()</code><br>第一个参数是停止动画的队列名称，可选<br>第二个参数如果设置为true，则清空队列，结束动画<br>第三个参数如果设置为true，完成队列，立即完成动画</p>
<p>调用<code>stop()</code>方法，会立即停止动画<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#stop&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).stop(); //停止动画</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;&#125;,10000);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>如果队列中有多个动画，摁一次只能停止一个动画，其他动画会继续执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#stop&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).stop();</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;&#125;,5000)</div><div class="line">            .animate(&#123;height:&quot;+=50px&quot;&#125;,5000); //链式动画</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>如果设置为true，会停止所有动画<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#stop&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).stop(true); //参数true</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;&#125;,5000)</div><div class="line">            .animate(&#123;height:&quot;+=50px&quot;&#125;,5000);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>判断是否处于动画状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#stop&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        if ($(&quot;#fly&quot;).is(&quot;:animated&quot;))</div><div class="line">        &#123;</div><div class="line">            $(&quot;#fly&quot;).stop(true);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="其他动画方法"><a href="#其他动画方法" class="headerlink" title="其他动画方法"></a>其他动画方法</h2><h3 id="slideToggle-方法"><a href="#slideToggle-方法" class="headerlink" title="slideToggle()方法"></a><code>slideToggle()</code>方法</h3><p>通过高度变化来切换所有匹配元素的可见性，并在切换完成后可选地触发一个回调函数</p>
<p>点击之后会使元素在隐藏和显示两个状态切换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).slideToggle(&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="fadeToggle-方法"><a href="#fadeToggle-方法" class="headerlink" title="fadeToggle()方法"></a><code>fadeToggle()</code>方法</h3><p>通过不透明度的变化来开关所有匹配元素的淡入和淡出效果，并在动画完成后可选地触发一个回调函数。</p>
<p>点击之后会使元素在隐藏和显示两个状态切换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).fadeToggle(&quot;slow&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="delay-方法"><a href="#delay-方法" class="headerlink" title="delay() 方法"></a><code>delay()</code> 方法</h3><p>设置一个延时来推迟执行队列中之后的项目。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;#right&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(&quot;#fly&quot;).animate(&#123;left:&quot;+=50px&quot;&#125;,&quot;fast&quot;)</div><div class="line">            .delay(6000) //设置延时</div><div class="line">            .animate(&#123;height:&quot;+=50px&quot;&#125;,&quot;fast&quot;);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h1><p>图片轮播效果</p>
<p>建立html文档<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;p_show&quot;&gt;</div><div class="line">    &lt;div id=&quot;p_head&quot;&gt;</div><div class="line">        &lt;a href=&quot;#&quot; id=&quot;pre&quot;&gt;《&lt;/a&gt; &lt;a href=&quot;#&quot; id=&quot;next&quot;&gt;》&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div id=&quot;p_contant&quot;&gt;</div><div class="line">        &lt;li&gt;&lt;a href=&quot;https://www.bilibili.com/&quot;&gt;&lt;img src=&quot;./static/image/bilibili.jpg&quot; alt=&quot;bilibili&quot; title=&quot;Bilibili&quot; /&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;&lt;a href=&quot;https://www.zhihu.com/&quot;&gt;&lt;img src=&quot;./static/image/zhihu.jpg&quot; alt=&quot;zhihu&quot; title=&quot;知乎&quot; /&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;&lt;a href=&quot;https://www.python.com/&quot;&gt;&lt;img src=&quot;./static/image/python.jpg&quot; alt=&quot;python&quot; title=&quot;Python&quot; /&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;&lt;a href=&quot;https://www.baidu.com/&quot;&gt;&lt;img src=&quot;./static/image/baidu.jpg&quot; alt=&quot;baidu&quot; title=&quot;百度&quot; /&gt;&lt;/a&gt;&lt;/li&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div id=&quot;p_O&quot;&gt;</div><div class="line">        &lt;span&gt;。&lt;/span&gt;</div><div class="line">        &lt;span&gt;.   &lt;/span&gt;</div><div class="line">        &lt;span&gt;.   &lt;/span&gt;</div><div class="line">        &lt;span&gt;.   &lt;/span&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>CSS样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">#p_head</div><div class="line">&#123;</div><div class="line">    position: absolute;</div><div class="line">    left: 700px;</div><div class="line">&#125;</div><div class="line">#p_head a </div><div class="line">&#123;</div><div class="line">    background-color: #fff;</div><div class="line">    text-decoration: none;</div><div class="line">&#125;</div><div class="line">#p_contant li</div><div class="line">&#123;</div><div class="line">    position: absolute;</div><div class="line">    left: 700px;</div><div class="line">    top: 150px;</div><div class="line">    list-style:none;</div><div class="line">&#125;</div><div class="line">#p_O</div><div class="line">&#123;</div><div class="line">    position: absolute;</div><div class="line">    left: 700px;</div><div class="line">    top: 350px;</div><div class="line">    font-size: 20px;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">var page=0 //储存当前显示的图片index</div><div class="line"></div><div class="line">$(function() //等待DON加载完成</div><div class="line">&#123;</div><div class="line">    $(&quot;#p_contant &gt; li:gt(0)&quot;).hide(); //隐藏除了第一个以外的其他图片</div><div class="line">    $(&quot;#next&quot;).click(function() //添加点击事件，下一页</div><div class="line">    &#123;</div><div class="line">        $(&quot;#p_contant &gt; li:eq(&quot;+page+&quot;)&quot;).fadeToggle(); //隐藏当前图片</div><div class="line">        $(&quot;#p_O &gt; span:eq(&quot;+page+&quot;)&quot;).text(&quot;.  &quot;); //小圆点改为小点</div><div class="line">        page ++; //目标转换成下个图片</div><div class="line">        if (page &gt;= 4) page=0; //一共4个图片，超出归零</div><div class="line">        $(&quot;#p_contant li:eq(&quot;+page+&quot;)&quot;).fadeToggle(); //显示隐藏的后面一个图片</div><div class="line">        $(&quot;#p_O &gt; span:eq(&quot;+page+&quot;)&quot;).text(&quot;。&quot;); //小点改为小圆点</div><div class="line">    &#125;)</div><div class="line">    $(&quot;#pre&quot;).click(function() //添加点击事件，上一页</div><div class="line">    &#123;</div><div class="line">        $(&quot;#p_contant &gt; li:eq(&quot;+page+&quot;)&quot;).fadeToggle(); </div><div class="line">        $(&quot;#p_O &gt; span:eq(&quot;+page+&quot;)&quot;).text(&quot;.  &quot;);</div><div class="line">        page --; //目标转换成上个图片</div><div class="line">        if (page &lt;= 0) page=3;</div><div class="line">        $(&quot;#p_contant li:eq(&quot;+page+&quot;)&quot;).fadeToggle();</div><div class="line">        $(&quot;#p_O &gt; span:eq(&quot;+page+&quot;)&quot;).text(&quot;。&quot;);</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/03/jQuery-04/" data-id="cj5c7k38v0013m0u4goxlwtqn" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/02/jQuery-03/" class="article-date">
  <time datetime="2016-05-02T04:50:29.000Z" itemprop="datePublished">2016-05-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/02/jQuery-03/">jQuery-03 DOM操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="jQuery-中的DOM操作"><a href="#jQuery-中的DOM操作" class="headerlink" title="jQuery 中的DOM操作"></a>jQuery 中的DOM操作</h1><h2 id="查找节点"><a href="#查找节点" class="headerlink" title="查找节点"></a>查找节点</h2><h3 id="查找元素节点"><a href="#查找元素节点" class="headerlink" title="查找元素节点"></a>查找元素节点</h3><p>获取元素节点并打印出文本内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完成</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;ul li:eq(1)&quot;); //ul下index为1的li子元素</div><div class="line">    alert($li.text()); //打印文本</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="查找属性节点"><a href="#查找属性节点" class="headerlink" title="查找属性节点"></a>查找属性节点</h3><p><code>attr()</code>设置或者返回元素的属性值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完成</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;#logop &gt; img&quot;);</div><div class="line">    alert($li.attr(&quot;src&quot;)); //返回属性src值</div><div class="line">    $li.attr(&quot;src&quot;,&quot;./static/pic2/pic0.jpg&quot;); //设置src值</div><div class="line">    $li.attr(&#123;&quot;src&quot;:&quot;./static/pic2/pic0.jpg&quot;,&quot;alt&quot;:&quot;image&quot;&#125;); //设置src值和alt值</div><div class="line">    $li.attr(&quot;alt&quot;, function()&#123;return this.src&#125;); //设置alt为其src值</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="创建节点"><a href="#创建节点" class="headerlink" title="创建节点"></a>创建节点</h2><p>例如在ul元素下再插入两个li子元素，需要如下步骤</p>
<ol>
<li>创建两个li元素</li>
<li>将两个新元素插入文档</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完成</div><div class="line">&#123;</div><div class="line">    //直接使用工厂函数创建标签，元素节点、文本节点和属性节点都已添加</div><div class="line">    var $li1 = $(&quot;&lt;li&gt;11 &lt;a href=&apos;#&apos;&gt;南家三姐妹&lt;/a&gt;&lt;/li&gt;&quot;);</div><div class="line">    var $li2 = $(&quot;&lt;li&gt;12 &lt;a href=&apos;#&apos;&gt;天使心跳&lt;/a&gt;&lt;/li&gt;&quot;);</div><div class="line"></div><div class="line">    //使用append()添加到文档节点</div><div class="line">    var $ul = $(&quot;.dongmanRange  ul&quot;);</div><div class="line">    $ul.append($li1);</div><div class="line">    $ul.append($li2);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="插入节点"><a href="#插入节点" class="headerlink" title="插入节点"></a>插入节点</h2><p>这些方法不仅能实现插入，还能实现元素的移动</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>append()</td>
<td>追加</td>
</tr>
<tr>
<td>appendTo()</td>
<td>追加到</td>
</tr>
<tr>
<td>prepend()</td>
<td>前置内容</td>
</tr>
<tr>
<td>prependTo()</td>
<td>前置内容到</td>
</tr>
<tr>
<td>after()</td>
<td>元素后追加</td>
</tr>
<tr>
<td>before()</td>
<td>元素前追加</td>
</tr>
<tr>
<td>insertAfter()</td>
<td>元素后追加</td>
</tr>
<tr>
<td>insertBefore()</td>
<td>元素前追加</td>
</tr>
</tbody>
</table>
<h2 id="删除节点"><a href="#删除节点" class="headerlink" title="删除节点"></a>删除节点</h2><p>如果文档中某个元素多余，可以删除这个元素，jQuery提供了两种删除节点的方法</p>
<h3 id="remove-方法"><a href="#remove-方法" class="headerlink" title="remove()方法"></a><code>remove()</code>方法</h3><p>根据内容移除标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt; li&quot;);</div><div class="line">    $li.remove(&quot;:contains(&apos;天使心跳&apos;),:contains(&apos;火影&apos;)&quot;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="empty-方法"><a href="#empty-方法" class="headerlink" title="empty()方法"></a><code>empty()</code>方法</h3><p>清空某个元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $ul = $(&quot;.dongmanRange &gt; ul&quot;);</div><div class="line">    $ul.empty();</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="复制节点"><a href="#复制节点" class="headerlink" title="复制节点"></a>复制节点</h2><p>当点击一个链接时，克隆一个自己<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    var $ul = $(&quot;.dongmanRange &gt; ul&quot;);</div><div class="line">    $li.click(function()</div><div class="line">    &#123;</div><div class="line">        $(this).clone().appendTo($ul);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="替换节点"><a href="#替换节点" class="headerlink" title="替换节点"></a>替换节点</h2><p>如果要替换某个节点，使用<code>replaceWith()</code>和<code>replaceAll()</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    var $ul = $(&quot;.dongmanRange &gt; ul&quot;);</div><div class="line">    $li.click(function()</div><div class="line">    &#123;</div><div class="line">        $(this).replaceWith(&quot;&lt;li&gt;&lt;a href=&apos;#&apos;&gt;-&lt;/a&gt;&lt;/li&gt;&quot;); //点击之后，链接变成“-”</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>点击一次之后，所有链接都被替换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    var $ul = $(&quot;.dongmanRange &gt; ul&quot;);</div><div class="line">    $li.click(function()</div><div class="line">    &#123;</div><div class="line">        $(this).replaceAll($li);</div><div class="line">        return false;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="包裹节点"><a href="#包裹节点" class="headerlink" title="包裹节点"></a>包裹节点</h2><p>如果要将某个节点用其他标记包裹起来，jQuery提供了相应的方法</p>
<h3 id="wrap-包裹"><a href="#wrap-包裹" class="headerlink" title="wrap() 包裹"></a><code>wrap()</code> 包裹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    $(&apos;a&apos;).wrap(&quot;&lt;li class=&apos;promoted&apos;&gt;&lt;/li&gt;&quot;); //给每个a元素包裹一个li元素</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="unwrap-去除一层包裹"><a href="#unwrap-去除一层包裹" class="headerlink" title="unwrap() 去除一层包裹"></a><code>unwrap()</code> 去除一层包裹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    $li.children(&apos;a&apos;).unwrap().wrap(&quot;&lt;li class=&apos;promoted&apos;&gt;&lt;/li&gt;&quot;); //取出原本包裹，添加新包裹</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="wrapAll-包裹所有"><a href="#wrapAll-包裹所有" class="headerlink" title="wrapAll() 包裹所有"></a><code>wrapAll()</code> 包裹所有</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;p&quot;).wrapAll(&quot;&lt;div&gt;&lt;/div&gt;&quot;); //用div包裹所有p元素</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h3 id="wrapInner-方法"><a href="#wrapInner-方法" class="headerlink" title="wrapInner() 方法"></a><code>wrapInner()</code> 方法</h3><p>将每个匹配的元素的子内容用其他结构包起来<br>HTML<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;test&quot;&gt;</div><div class="line">    hello</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div class=&quot;test&quot;&gt;</div><div class="line">    world</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>JavaScript<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;.test&apos;).wrapInner(&quot;&lt;p&gt;&lt;/p&gt;&quot;);</div></pre></td></tr></table></figure></p>
<p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;test&quot;&gt;</div><div class="line">    &lt;p&gt;hello&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div class=&quot;test&quot;&gt;</div><div class="line">    &lt;p&gt;world&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<h2 id="属性操作"><a href="#属性操作" class="headerlink" title="属性操作"></a>属性操作</h2><p>attr()可以读取和设置属性，使用removeAttr()可以删除属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    $li.removeAttr(&quot;title&quot;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="样式操作"><a href="#样式操作" class="headerlink" title="样式操作"></a>样式操作</h2><h3 id="获取和设置样式"><a href="#获取和设置样式" class="headerlink" title="获取和设置样式"></a>获取和设置样式</h3><p>可以直接使用<code>attr()</code>操作calss属性</p>
<h3 id="追加样式"><a href="#追加样式" class="headerlink" title="追加样式"></a>追加样式</h3><p>jQuery提供专门的<code>addClass()</code>方法来追加样式</p>
<ul>
<li>如果给一个元素添加了多个样式，那么就相当于合并了他们的样式</li>
<li>如果有不同的class设定了同一样式，后者覆盖前者</li>
</ul>
<h3 id="移除样式"><a href="#移除样式" class="headerlink" title="移除样式"></a>移除样式</h3><p>与<code>addClass()</code>相反，使用<code>removeClass()</code>来移除样式</p>
<h3 id="判断是否含有某个样式"><a href="#判断是否含有某个样式" class="headerlink" title="判断是否含有某个样式"></a>判断是否含有某个样式</h3><p><code>hasClass()</code>可以判断元素中是否含有某个class，如果有，返回true</p>
<h2 id="设置和获取HTML、文本和值"><a href="#设置和获取HTML、文本和值" class="headerlink" title="设置和获取HTML、文本和值"></a>设置和获取HTML、文本和值</h2><h3 id="html-方法"><a href="#html-方法" class="headerlink" title="html() 方法"></a><code>html()</code> 方法</h3><p>类似于JavaScript的<code>innerHTML</code>属性，可以用来读取或者设置某个元素的HTML内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    $li.html(&quot;new&quot;) //所有列表的内容都变成“new”了</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="text-方法"><a href="#text-方法" class="headerlink" title="text() 方法"></a><code>text()</code> 方法</h3><p>类似于JavaScript的<code>innerText</code>属性，读取或设置元素的文本内容不含标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $li = $(&quot;.dongmanRange &gt; ul &gt;li&quot;);</div><div class="line">    $li.text(&quot;aa&quot;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="val-方法"><a href="#val-方法" class="headerlink" title="val() 方法"></a><code>val()</code> 方法</h3><p>类似于JavaScript的<code>value</code>属性，可以用来设置和获取元素的值，无论是文本框、下拉列表还是单选框，都会返回元素值</p>
<p>在图片浏览的网页添加一个跳页的表单，然后点击submit之后跳页</p>
<p>这里使用了<code>focus()</code>方法和<code>blur</code>方法，当鼠标焦点没有选中时显示”页码”，当选中时清空等待用户输入<br>使用<code>val()</code>方法获得用户输入的页码的数值，然后跳页<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    //focus()方法相当于onfocuse()方法，处理当获得焦点时事件</div><div class="line">    $(&quot;#pageJump&quot;).focus(function() </div><div class="line">    &#123;</div><div class="line">        var textvalue = $(this).val();</div><div class="line">        if (textvalue == &quot;页码&quot;)</div><div class="line">        &#123;</div><div class="line">            $(this).val(&quot;&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    //blur()相当于onblur()方法，处理当失去焦点时事件</div><div class="line">    $(&quot;#pageJump&quot;).blur(function() </div><div class="line">    &#123;</div><div class="line">        var textvalue = $(this).val();</div><div class="line">        if (textvalue == &apos;&apos;)</div><div class="line">        &#123;</div><div class="line">            $(this).val(&quot;页码&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&quot;#submit&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        var txtPage = $(&apos;#pageJump&apos;).val();</div><div class="line">        if (txtPage == &apos;&apos;)</div><div class="line">        &#123;</div><div class="line">            alert(&quot;请输入页码&quot;);</div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            pageNum = parseInt(txtPage);</div><div class="line">            if (pageNum &gt;= 0)</div><div class="line">            &#123;</div><div class="line">                num = pageNum</div><div class="line">                source = &quot;./static/pic2/pic&quot; + pageNum + &quot;.jpg&quot;;</div><div class="line">                $(&quot;#description&quot;).html(&quot;&lt;em&gt;picture-&lt;/em&gt; &quot;+ pageNum);</div><div class="line">                $(&quot;#picture&quot;).attr(&quot;src&quot;, source);</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">            else</div><div class="line">            &#123;</div><div class="line">                alert(&quot;输入的页码无效&quot;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><code>val()</code> 方法也可以设置<code>select(下拉列表框)</code>，<code>checkbox(多选框)</code>和<code>radio(单选框)</code>相应的被选中的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$(&quot;:checkbox&quot;).val([&quot;a&quot;,&quot;b&quot;]); //多选框‘</div><div class="line">$(&quot;:radio&quot;).val([&quot;c&quot;]); //单选框</div></pre></td></tr></table></figure></p>
<h2 id="遍历节点"><a href="#遍历节点" class="headerlink" title="遍历节点"></a>遍历节点</h2><h3 id="children-方法"><a href="#children-方法" class="headerlink" title="children() 方法"></a><code>children()</code> 方法</h3><p>用于匹配元素的子元素集合，只考虑子元素而不考虑其他后代元素</p>
<h3 id="next-方法"><a href="#next-方法" class="headerlink" title="next() 方法"></a><code>next()</code> 方法</h3><p>用于匹配元素后面一个同辈元素</p>
<h3 id="siblings-方法"><a href="#siblings-方法" class="headerlink" title="siblings() 方法"></a><code>siblings()</code> 方法</h3><p>用于匹配元素所有同辈元素</p>
<h3 id="closest-方法"><a href="#closest-方法" class="headerlink" title="closest() 方法"></a><code>closest()</code> 方法</h3><p>寻找最近的元素</p>
<p>寻找最近的<code>li</code>元素，并设置颜色为红色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;#main&quot;).closest(&quot;li&quot;).css(&quot;color&quot;,&quot;red&quot;);</div></pre></td></tr></table></figure></p>
<p>除此之外，jQuery还有许多哦遍历节点的方法，比如<code>find()</code>、<code>filter()</code>、<code>nextAll()</code>、<code>prevAll()</code>、<code>parent()</code>和<code>parents()</code>等</p>
<h2 id="CSS-DOM-操作"><a href="#CSS-DOM-操作" class="headerlink" title="CSS-DOM 操作"></a>CSS-DOM 操作</h2><p>CSS-DOM操作简单来说就是读取和设置style对象的各种属性，但是无法通过它提取通过外部设置的样式属性</p>
<p>在jQuery中，可以直接利用<code>css()</code>方法提取元素的样式属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    alert($(&quot;.message&quot;).css(&quot;color&quot;)); //获取class为message的元素的颜色</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>可以直接使用<code>css()</code>方法设置某个元素的样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;.message&quot;).css(&quot;color&quot;,&quot;red&quot;);//设置class为message的元素的颜色为红色</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>和<code>attr()</code>方法一样，<code>css()</code>方法也可以同时设置多个样式属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    $(&quot;.message&quot;).css(&#123;&quot;color&quot;:&quot;red&quot;,&quot;backgroundColor&quot;:&quot;green&quot;&#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>常用方法</p>
<h3 id="offset-方法"><a href="#offset-方法" class="headerlink" title="offset() 方法"></a><code>offset()</code> 方法</h3><p>获取元素在当前视窗的相对偏移<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var offset = $(&quot;#picture&quot;).offset(); </div><div class="line">    var left = offset.left; //左偏移</div><div class="line">    var top = offset.top; //右偏移</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="position-方法"><a href="#position-方法" class="headerlink" title="position() 方法"></a><code>position()</code> 方法</h3><p>获取元素相对父元素的偏移，同样，分为左右偏移<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var offset = $(&quot;#picture&quot;).position();</div><div class="line">    var left = offset.left;</div><div class="line">    var top = offset.top;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="scrollTop-方法和srollLeft-方法"><a href="#scrollTop-方法和srollLeft-方法" class="headerlink" title="scrollTop() 方法和srollLeft() 方法"></a><code>scrollTop()</code> 方法和<code>srollLeft()</code> 方法</h3><p>获取元素相对滚动条的偏移</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>跟踪鼠标的超链接提示和图片预览功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完毕</div><div class="line">&#123;</div><div class="line">    $(&quot;.linkp a img&quot;).mouseover(function(e) //鼠标移动到链接上触发</div><div class="line">    &#123;</div><div class="line">        this.myTitle = this.title; //取出title值</div><div class="line">        this.title = &quot;&quot;; //清空原来的title值，这样就不会触发浏览器自带的提示</div><div class="line"></div><div class="line">        var $tip = $(&quot;&lt;div id=&apos;tip&apos;&gt;&quot;+this.myTitle+&quot;&lt;/div&gt;&quot;); //创建一个显示title的div元素</div><div class="line">        $(&quot;#main&quot;).append($tip); //追加到class为main的元素里面</div><div class="line">        $tip.css(   //获得鼠标位置并稍微错位方便观察</div><div class="line">        &#123;</div><div class="line">            &quot;top&quot;: (e.pageY+10) + &quot;px&quot;, </div><div class="line">            &quot;left&quot;: (e.pageX+20) + &quot;px&quot;</div><div class="line">        &#125;).show(); //显示</div><div class="line">    &#125;)</div><div class="line">    .mouseout(function() //鼠标移开连接触发</div><div class="line">    &#123;</div><div class="line">        this.title = this.myTitle; //还原清空的title值</div><div class="line">        $(&quot;#tip&quot;).remove(); //删除提示元素</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>添加图片预览功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完毕</div><div class="line">&#123;</div><div class="line">    $(&quot;.linkp a img&quot;).mouseover(function(e) //鼠标移动到链接上触发</div><div class="line">    &#123;</div><div class="line">        this.myTitle = this.title; //取出title值</div><div class="line">        this.title = &quot;&quot;; //清空原来的title值，这样就不会触发浏览器自带的提示</div><div class="line">        var tiptitle = &quot;&lt;br / &gt;&lt;div&gt;&quot;+this.myTitle+&quot;&lt;/div&gt;&quot;; //提示元素</div><div class="line">        var $tippic = $(&quot;&lt;div id=&apos;tip&apos;&gt;&lt;img src=&apos;&quot;+this.src+&quot;&apos; alt=&apos;预览&apos; / &gt;&quot;+tiptitle+&quot;&lt;/div&gt;&quot;); /预览图片元素</div><div class="line">        $(&quot;#main&quot;).append($tippic); //追加到class为main的元素上</div><div class="line">        $tippic.css(  //获得鼠标位置并稍微错位方便观察</div><div class="line">        &#123;</div><div class="line">            &quot;top&quot;: (e.pageY-200) + &quot;px&quot;,</div><div class="line">            &quot;left&quot;: (e.pageX-200) + &quot;px&quot;</div><div class="line">        &#125;).show();</div><div class="line">    &#125;)</div><div class="line">    .mouseout(function() //鼠标移开连接触发</div><div class="line">    &#123;</div><div class="line">        this.title = this.myTitle; //还原清空的title值</div><div class="line">        $(&quot;#tippic&quot;).remove(); //删除提示元素</div><div class="line">    &#125;)</div><div class="line">    .mousemove(function(e) //鼠标移动时触发</div><div class="line">    &#123;</div><div class="line">        $(&quot;#tip&quot;).css(</div><div class="line">        &#123;</div><div class="line">            &quot;top&quot;: (e.pageY-200) + &quot;px&quot;,</div><div class="line">            &quot;left&quot;: (e.pageX-200) + &quot;px&quot;</div><div class="line">        &#125;);</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/02/jQuery-03/" data-id="cj5c7k38o000zm0u4r67pcsss" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/01/jQuery-02/" class="article-date">
  <time datetime="2016-05-01T07:37:48.000Z" itemprop="datePublished">2016-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/01/jQuery-02/">jQuery-02 jQuery选择器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="jQuery选择器"><a href="#jQuery选择器" class="headerlink" title="jQuery选择器"></a>jQuery选择器</h1><p>选择器是jQuery的根基，在jQuery中，对事件处理，遍历DOM和Ajax操作都依赖于选择器</p>
<p>jQuery中的选择器完全继承了CSS风格</p>
<p>使用jQuery选择器不仅比传统DOM操作简介，并且能避免错误</p>
<h2 id="基本选择器"><a href="#基本选择器" class="headerlink" title="基本选择器"></a>基本选择器</h2><table>
<thead>
<tr>
<th>选择器</th>
<th>描述</th>
<th>返回</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>#id</td>
<td>根据给定id匹配一个元素</td>
<td>单个元素</td>
<td>$(“#test”)</td>
</tr>
<tr>
<td>.class</td>
<td>根据类匹配元素</td>
<td>集合元素</td>
<td>$(“.test”)</td>
</tr>
<tr>
<td>element</td>
<td>根据给定元素名匹配元素</td>
<td>集合元素</td>
<td>$(“p”)</td>
</tr>
<tr>
<td>*</td>
<td>匹配所有元素</td>
<td>匹配所有元素</td>
<td>集合元素</td>
<td>$(“*”)</td>
</tr>
<tr>
<td>a,b,c,…</td>
<td>匹配每个元素</td>
<td>集合元素</td>
<td>$(“div,p,.myclass”)</td>
</tr>
</tbody>
</table>
<p>可以使用基本选择器完成大部分工作</p>
<h2 id="层次选择器"><a href="#层次选择器" class="headerlink" title="层次选择器"></a>层次选择器</h2><table>
<thead>
<tr>
<th>示例</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(“div span”)</td>
<td>选取div里面所有span子元素</td>
</tr>
<tr>
<td>$(“div &gt; span”)</td>
<td>选组div里面span子元素</td>
</tr>
<tr>
<td>$(“.one + div”)</td>
<td>class为one的下一个兄弟元素</td>
</tr>
<tr>
<td>$(“.one ~ div”)</td>
<td>class为one的后面所有兄弟元素</td>
</tr>
</tbody>
</table>
<p>第一个和第二个比较常用，后面两种方法可以用更加简单的代替<br>使用<code>next()</code>方法代替<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;.one&quot;).next(&quot;div&quot;);</div></pre></td></tr></table></figure></p>
<p>使用<code>nextAll()</code>方法代替<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;.one&quot;).nextAll(&quot;div&quot;)</div></pre></td></tr></table></figure></p>
<p><code>siblings()</code>与前后位置无关，只要是同辈节点都能匹配<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;.one&quot;).sibling(&quot;div&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="过滤选择器"><a href="#过滤选择器" class="headerlink" title="过滤选择器"></a>过滤选择器</h2><h3 id="基本过滤选择器"><a href="#基本过滤选择器" class="headerlink" title="基本过滤选择器"></a>基本过滤选择器</h3><table>
<thead>
<tr>
<th>示例</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(“div:first”)</td>
<td>div元素中的第一个div元素</td>
</tr>
<tr>
<td>$(“div:last”)</td>
<td>div元素的最后一个div元素</td>
</tr>
<tr>
<td>$(“div:not(.myClass)”)</td>
<td>选取class不是myclass的div元素</td>
</tr>
<tr>
<td>$(“div:even”)</td>
<td>选取索引是偶数的div元素(0开始)</td>
</tr>
<tr>
<td>$(“div:odd”)</td>
<td>奇数</td>
</tr>
<tr>
<td>$(“div:eq(index)”)</td>
<td>选取索引等于index的div元素</td>
</tr>
<tr>
<td>$(“div:gt(index)”)</td>
<td>大于</td>
</tr>
<tr>
<td>$(“div:lt(index)”)</td>
<td>小于</td>
</tr>
<tr>
<td>$(“div:header”)</td>
<td>选取所有h1,h2,h3…</td>
</tr>
<tr>
<td>$(“div:animated”)</td>
<td>选取当前正在执行动画的所有元素</td>
</tr>
</tbody>
</table>
<h3 id="内容过滤选择器"><a href="#内容过滤选择器" class="headerlink" title="内容过滤选择器"></a>内容过滤选择器</h3><p>内容过滤选择器主要体现在它所包含的子元素或文本内容上</p>
<table>
<thead>
<tr>
<th>示例</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(“div:contains(‘你’)”)</td>
<td>选取内容含有‘你’的元素</td>
</tr>
<tr>
<td>$(“div:empty”)</td>
<td>选取不包含子元素的div空元素</td>
</tr>
<tr>
<td>$(“div:has(p)”)</td>
<td>选取含有p元素的div元素</td>
</tr>
<tr>
<td>$(“div:parent”)</td>
<td>选取拥有子元素(包括文本元素)的div元素</td>
</tr>
</tbody>
</table>
<h3 id="可见性过滤选择器"><a href="#可见性过滤选择器" class="headerlink" title="可见性过滤选择器"></a>可见性过滤选择器</h3><p>可见性过滤器是根据元素的可见和不可见状态来选择相应的元素</p>
<table>
<thead>
<tr>
<th>示例</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(“:hidden”)</td>
<td>选取所有不可见元素</td>
</tr>
<tr>
<td>$(“div:visible”)</td>
<td>选取所有可见div元素</td>
</tr>
</tbody>
</table>
<p>显示所有隐藏的元素，show()和hide()可以有两个参数，分别是速度(ms)和结束后执行的函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    $v = $(&quot;:hidden&quot;);</div><div class="line">    $v.show();</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="属性过滤选择器"><a href="#属性过滤选择器" class="headerlink" title="属性过滤选择器"></a>属性过滤选择器</h3><p>属性过滤器的过滤规则是通过元素的属性来获取相应的元素</p>
<table>
<thead>
<tr>
<th>示例</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(“div[id]”)</td>
<td>选取具有属性id的div元素</td>
</tr>
<tr>
<td>$(“div[title=test]”)</td>
<td>选取title为”test”的div元素</td>
</tr>
<tr>
<td>$(“div[title!=test]”)</td>
<td>不为</td>
</tr>
<tr>
<td>$(“div[title^=t]”)</td>
<td>以”t”开始</td>
</tr>
<tr>
<td>$(“div[title$=t]”)</td>
<td>以”t”结束</td>
</tr>
<tr>
<td>$(“div[title*=e]”)</td>
<td>含有”t”</td>
</tr>
<tr>
<td>$(“div[…][…]”)</td>
<td>允许多个过滤器复合</td>
</tr>
</tbody>
</table>
<h3 id="子元素过滤选择器"><a href="#子元素过滤选择器" class="headerlink" title="子元素过滤选择器"></a>子元素过滤选择器</h3><table>
<thead>
<tr>
<th>选择器</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:nth-child(index/even/…)</td>
<td>每个父元素下第index个子元素(1开始)</td>
</tr>
<tr>
<td>:first-child</td>
<td>每个父目录下第一个子元素</td>
</tr>
<tr>
<td>:last-child</td>
<td>最后一个</td>
</tr>
<tr>
<td>:only-child</td>
<td>是唯一子元素的子元素</td>
</tr>
</tbody>
</table>
<p>使用css()方法改变class为’haschildren’的第一个子元素的字体大小<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $v = $(&quot;.has_children:first-child&quot;);</div><div class="line">    $v.css(&quot;font-size&quot;,&quot;30px&quot;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="表单对象属性过滤选择器"><a href="#表单对象属性过滤选择器" class="headerlink" title="表单对象属性过滤选择器"></a>表单对象属性过滤选择器</h3><p>此选择器主要对所选择的表单元素进行过滤</p>
<table>
<thead>
<tr>
<th>选择器</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:enabled</td>
<td>选取所有可用元素</td>
</tr>
<tr>
<td>:disabled</td>
<td>选取所有不可用元素</td>
</tr>
<tr>
<td>:checked</td>
<td>选取所有被选中元素(单选框，复选框)</td>
</tr>
<tr>
<td>:selected</td>
<td>选取所有被选中元素(下拉表)</td>
</tr>
</tbody>
</table>
<h2 id="表单选择器"><a href="#表单选择器" class="headerlink" title="表单选择器"></a>表单选择器</h2><p>jQuery加入了表单选择器，能方便地获得表单的某个或某类型元素</p>
<table>
<thead>
<tr>
<th>选择器</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>:input</td>
<td>选取所有input、textarea、select和button元素</td>
</tr>
<tr>
<td>:text</td>
<td>选取所有单行文本框</td>
</tr>
<tr>
<td>:password</td>
<td>密码框</td>
</tr>
<tr>
<td>:radio</td>
<td>单选框</td>
</tr>
<tr>
<td>:checkbox</td>
<td>多选框</td>
</tr>
<tr>
<td>:submit</td>
<td>提交按钮</td>
</tr>
<tr>
<td>:image</td>
<td>图像按钮</td>
</tr>
<tr>
<td>:reset</td>
<td>重置按钮</td>
</tr>
<tr>
<td>:button</td>
<td>所有按钮</td>
</tr>
<tr>
<td>:file</td>
<td>上传域</td>
</tr>
<tr>
<td>:hidden</td>
<td>不可见元素</td>
</tr>
</tbody>
</table>
<h1 id="选择器中的注意事项"><a href="#选择器中的注意事项" class="headerlink" title="选择器中的注意事项"></a>选择器中的注意事项</h1><h2 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h2><p>选择器中如果含有’.’、’#’、’(‘或者’]’等，需要使用转义字符转义</p>
<p>找到href为‘#’的元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $v = $(&quot;[href=\\#]&quot;); //转义字符&apos;#&apos;</div><div class="line">    alert($v.length)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="选择器中含有空格"><a href="#选择器中含有空格" class="headerlink" title="选择器中含有空格"></a>选择器中含有空格</h2><p>缺少或者添加空格，含义可能因此而变得不一样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$(&quot;.links:hidden&quot;) //隐藏的并且class为‘links’的元素</div><div class="line">$(&quot;.links :hidden&quot;) //class为‘links’的元素里面的隐藏元素(子元素)</div></pre></td></tr></table></figure></p>
<h1 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h1><p>建立一个显示动漫排行的文档<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;dongmanRange&quot;&gt;</div><div class="line">    &lt;h2&gt;动漫排行&lt;/h2&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">        &lt;li&gt;1 &lt;a href=&quot;#&quot;&gt;海贼王&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;2 &lt;a href=&quot;#&quot;&gt;七龙珠&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;3 &lt;a href=&quot;#&quot;&gt;火影忍者&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;4 &lt;a href=&quot;#&quot;&gt;死神&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;5 &lt;a href=&quot;#&quot;&gt;名侦探柯南&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;6 &lt;a href=&quot;#&quot;&gt;妖精的尾巴&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;7 &lt;a href=&quot;#&quot;&gt;东京食尸鬼&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;8 &lt;a href=&quot;#&quot;&gt;银魂&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;9 &lt;a href=&quot;#&quot;&gt;刀剑神域&lt;/a&gt;&lt;/li&gt;</div><div class="line">        &lt;li&gt;10 &lt;a href=&quot;#&quot;&gt;约会大作战&lt;/a&gt;&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">    &lt;div class=&quot;showmore&quot;&gt;</div><div class="line">        &lt;a href=&quot;#&quot;&gt;显示全部&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>实现以下效果</p>
<ul>
<li>一开始只显示前五个，后面的全部隐藏</li>
<li>当用户点击显示全部按钮之后，显示全部列表，高亮显示推荐，并把按钮内容改为“收回”</li>
<li>当用户点击“收回时”，隐藏6个以外的所有列表，并把按钮内容改为“显示全部”</li>
</ul>
<p>JavaScript代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完成</div><div class="line">&#123;</div><div class="line">    var $overtop5 = $(&quot;ul li:gt(4)&quot;); //选取ul下所有li元素，筛选出li元素index大于4的</div><div class="line">    $overtop5.hide(); //隐藏</div><div class="line"></div><div class="line">    var $button = $(&quot;.showmore &gt; a&quot;); //选取class为showmore的子元素a</div><div class="line">    $button.click(function() //添加onclick事件</div><div class="line">    &#123;</div><div class="line">        if ($overtop5.is(&quot;:hidden&quot;)) //如果属性是隐藏</div><div class="line">        &#123;</div><div class="line">            $overtop5.show(); //显示</div><div class="line">            $button.text(&quot;收回&quot;); //按钮内容改为&quot;收回&quot;</div><div class="line">            $(&quot;ul li&quot;).filter(&quot;:contains(&apos;火影&apos;),:contains(&apos;刀剑&apos;),:contains(&apos;银魂&apos;)&quot;) //filter参数可以是多个选择器的集合</div><div class="line">                .addClass(&quot;promoted&quot;); //高亮</div><div class="line">            return false; //阻止链接跳转</div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            $overtop5.hide(); //隐藏</div><div class="line">            $button.text(&quot;全部显示&quot;); //按钮内容改为&quot;全部显示&quot;</div><div class="line">            $(&quot;ul li&quot;).filter(&quot;:contains(&apos;火影&apos;),:contains(&apos;刀剑&apos;),:contains(&apos;银魂&apos;)&quot;) //filter参数可以是多个选择器的集合</div><div class="line">                .removeClass(&quot;promoted&quot;); //去除高亮</div><div class="line">            return false; //阻止链接跳转</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/01/jQuery-02/" data-id="cj5c7k38m000ym0u4g3dxhrp1" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-jQuery-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/01/jQuery-01/" class="article-date">
  <time datetime="2016-05-01T02:48:01.000Z" itemprop="datePublished">2016-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/01/jQuery-01/">jQuery-01 简述</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>JavaScript是网景公司开发的脚本语言，jQuery是JavaScript开发的一个轻量级库<br>现在正在阅读《锋利的jQuery》,此书一共八章，这篇博客是阅读过程中的笔记</p>
<p><a href="https://github.com/HarryHEi/Guidence.git" target="_blank" rel="external">代码</a></p>
<h1 id="中文文档"><a href="#中文文档" class="headerlink" title="中文文档"></a>中文文档</h1><p><a href="http://jquery.cuishifeng.cn/" target="_blank" rel="external">http://jquery.cuishifeng.cn/</a></p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>在head标签引入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;./static/js/jquery-1.12.3.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<h1 id="编写简单的jQuery代码"><a href="#编写简单的jQuery代码" class="headerlink" title="编写简单的jQuery代码"></a>编写简单的jQuery代码</h1><p>在jQuery中<code>$</code>就是jQuery的简写形式，例如<code>$(&quot;#foo&quot;)</code>和<code>jQuery(&quot;#foo&quot;)</code>是等价的，下面编写第一个jQuery程序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(document).ready</div><div class="line">(</div><div class="line">    function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;hello world&quot;);</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>可以简写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(</div><div class="line">    function()</div><div class="line">    &#123;</div><div class="line">        alert(&quot;hello world&quot;);</div><div class="line">    &#125;  </div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>这段代码类似于JavaScript中的window.onload方法，不过相比<code>window.onload</code>还是有些区别</p>
<table>
<thead>
<tr>
<th>对比</th>
<th>window.onload</th>
<th>$(document).ready()</th>
</tr>
</thead>
<tbody>
<tr>
<td>执行时机</td>
<td>必须等待网页加载完毕之后(包括图片)才能执行</td>
<td>网页中所有DOM结构绘制完毕后就执行</td>
</tr>
<tr>
<td>编写个数</td>
<td>不能同时编写多个</td>
<td>能够同时编写多个</td>
</tr>
<tr>
<td>简化写法</td>
<td>无</td>
<td>$(function(){…})</td>
</tr>
</tbody>
</table>
<h1 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h1><h2 id="链式操作风格"><a href="#链式操作风格" class="headerlink" title="链式操作风格"></a>链式操作风格</h2><p>创建一个导航栏文档<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;menu&quot;&gt;</div><div class="line">    &lt;div class=&quot;has_children&quot;&gt;</div><div class="line">        &lt;span &gt;看图&lt;/span&gt;</div><div class="line">        &lt;a &gt;二次元&lt;/a&gt;</div><div class="line">        &lt;a &gt;三次元&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class=&quot;has_children&quot;&gt;</div><div class="line">        &lt;span &gt;听歌&lt;/span&gt;</div><div class="line">        &lt;a &gt;二次元&lt;/a&gt;</div><div class="line">        &lt;a &gt;三次元&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class=&quot;has_children&quot;&gt;</div><div class="line">        &lt;span &gt;看片&lt;/span&gt;</div><div class="line">        &lt;a &gt;二次元&lt;/a&gt;</div><div class="line">        &lt;a &gt;三次元&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>CSS内容如下，如要是添加了高亮类和隐藏标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">#menu</div><div class="line">&#123;</div><div class="line">	width: 300px;</div><div class="line">	padding: 50px;</div><div class="line">&#125;</div><div class="line">.has_children</div><div class="line">&#123;</div><div class="line">	color: black;</div><div class="line">	cursor: pointer;</div><div class="line">	font-size: 20px;</div><div class="line">&#125;</div><div class="line">.highlight</div><div class="line">&#123;</div><div class="line">	color: #3299cc;</div><div class="line">&#125;</div><div class="line">.has_children &gt; a</div><div class="line">&#123;</div><div class="line">	display: none;</div><div class="line">	float: left;</div><div class="line">	width: 300px;</div><div class="line">	height: 20px;</div><div class="line">	font-size: 16px;</div><div class="line">	padding-left: 20px;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="项目举例"><a href="#项目举例" class="headerlink" title="项目举例"></a>项目举例</h2><p>例如，项目需求是制作导航栏，单机不同名称链接，显示相应内容<br>代码内容是当点击到class中含有has_children的元素时，给其添加一个highlight类属性，然后显示出它的所有a元素子类<br>而同辈元素都移除highlight属性并隐藏a子类，这就是链式操作，理论上就是一行代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function() //等待DOM加载完毕</div><div class="line">&#123; </div><div class="line">    $(&quot;.has_children&quot;).click(function()</div><div class="line">    &#123;</div><div class="line">        $(this).addClass(&quot;highlight&quot;) //添加highlight类</div><div class="line">            .children(&quot;a&quot;).show().end() //显示a子类</div><div class="line">            .siblings().removeClass(&quot;highlight&quot;) //删除同辈highlight类</div><div class="line">            .children(&quot;a&quot;).hide(); //隐藏同辈a子类</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h1 id="jQuery对象和DOM对象"><a href="#jQuery对象和DOM对象" class="headerlink" title="jQuery对象和DOM对象"></a>jQuery对象和DOM对象</h1><h2 id="DOM对象"><a href="#DOM对象" class="headerlink" title="DOM对象"></a>DOM对象</h2><p>DOM是文档对象模型的缩写，每一分DOM对象都可以表示成一棵树</p>
<h2 id="jQuery对象"><a href="#jQuery对象" class="headerlink" title="jQuery对象"></a>jQuery对象</h2><p>jQuery对象就是通过jQuery包装DOM对象后产生的对象<br>如果一个对象是jQuery对象，那么就可以使用jQuery里的方法 </p>
<p>例如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    alert($(&quot;#main&quot;).html());</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>这段代码等同于<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    alert(document.getElementById(&quot;main&quot;).innerHTML)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>jQuery对象无法使用DOM对象的方法，例如$(‘#main’).innerHTML是不合法的</p>
<h2 id="相互转换"><a href="#相互转换" class="headerlink" title="相互转换"></a>相互转换</h2><h3 id="jQuery对象转化成DOM对象"><a href="#jQuery对象转化成DOM对象" class="headerlink" title="jQuery对象转化成DOM对象"></a>jQuery对象转化成DOM对象</h3><p>jQuery不能使用DOM方法，如果不得不使用DOM对象时，有以下两种处理方法</p>
<p><code>[index]</code><br>jQuery对象是一个数组对象，可以通过[index]的方法得到响应的DOM对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $menu = $(&quot;#menu&quot;);</div><div class="line">    var menu = $menu[0];</div><div class="line">    alert(menu.innerHTML);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><code>get(index)</code><br>这个方法是jQuery本身提供的，通过<code>get(index)</code>方法得到相应的DOM对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $menu = $(&quot;#menu&quot;);</div><div class="line">    var menu = $menu.get(0);</div><div class="line">    alert(menu.innerHTML);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="DOM对象转化成jQuery对象"><a href="#DOM对象转化成jQuery对象" class="headerlink" title="DOM对象转化成jQuery对象"></a>DOM对象转化成jQuery对象</h3><p>对于DOM对象，只需要用<code>$()</code>把DOM对象包起来，就获得了一个jQuery对象，即<code>$(DOM对象)</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var memu = document.getElementById(&quot;memu&quot;);</div><div class="line">    var $menu = $(menu);</div><div class="line">    alert($menu.html());</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="实例研究"><a href="#实例研究" class="headerlink" title="实例研究"></a>实例研究</h2><p>实现一个“同意并接受条款”复选框，只有选中才能提交</p>
<p>文档中添加一个复选框，然后使用DOM方法判断是否选中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">&#123;</div><div class="line">    var $box = $(&quot;#box&quot;);</div><div class="line">    var box = $box[0];</div><div class="line">    $box.click(function()</div><div class="line">    &#123;</div><div class="line">        if (box.checked) //使用DOM方法判断是否选中</div><div class="line">        &#123;</div><div class="line">            alert(&quot;感谢支持!&quot;)</div><div class="line">        &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>也可以使用jQuery方法判断是否选中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if ($box.is(&quot;:checked&quot;)) #...</div></pre></td></tr></table></figure></p>
<h1 id="jQuery和其他库的冲突"><a href="#jQuery和其他库的冲突" class="headerlink" title="jQuery和其他库的冲突"></a>jQuery和其他库的冲突</h1><p>在jQuery库中，几乎所有的插件都被限制在它的命名空间，通常，全局对象都被很好地储藏在jQuery命名空间，因此和其他库不会引起冲突</p>
<h2 id="在其他库之后导入"><a href="#在其他库之后导入" class="headerlink" title="在其他库之后导入"></a>在其他库之后导入</h2><p>在其他库加载完毕后，使用jQuery.noConflick函数来将变量<code>$</code>的控制权交给其他库<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jQuery.noConflict(); //将变量$控制权交给其他库</div></pre></td></tr></table></figure></p>
<p>如果确保jQuery不会与其他库冲突，并自定义快捷方式，可以像这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var $j = jQuery.noConflict(); //自定义一个快捷方式</div><div class="line"></div><div class="line">$j(document).ready(function()</div><div class="line">&#123;</div><div class="line">    #...</div><div class="line">&#125;)</div><div class="line"></div><div class="line">$(&quot;pp&quot;).style.display = &quot;none&quot;; //使用其他库</div></pre></td></tr></table></figure></p>
<p>如果不想自定义备用名称，而继续使用$，不管其他库的$()方法，可以使用下面两种方法</p>
<p>方法1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">jQuery.noConflict(); //将变量$控制权交给其他库</div><div class="line"></div><div class="line">jQuery(function($) //设定页面加载时函数</div><div class="line">&#123;</div><div class="line">    $(&quot;.has_children&quot;).click(function() //在函数内部继续调用$()方法</div><div class="line">    &#123;</div><div class="line">        $(this).addClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).show().end()</div><div class="line">            .siblings().removeClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).hide();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">$(&quot;pp&quot;).style.display = &quot;none&quot;; //使用其他库</div></pre></td></tr></table></figure></p>
<p>方法2<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">jQuery.noConflict(); //将变量$控制权交给其他库</div><div class="line"></div><div class="line">(function($) //定义匿名函数并设置形参为$</div><div class="line">&#123;</div><div class="line">    $(document).ready(function() //等待DOM加载完毕</div><div class="line">    &#123; </div><div class="line">        $(&quot;.has_children&quot;).click(function()</div><div class="line">        &#123;</div><div class="line">            $(this).addClass(&quot;highlight&quot;) //添加highlight类</div><div class="line">                .children(&quot;a&quot;).show().end() //显示a子类</div><div class="line">                .siblings().removeClass(&quot;highlight&quot;) //删除同辈highlight类</div><div class="line">                .children(&quot;a&quot;).hide(); //隐藏同辈a子类</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">&#125;)(jQuery); //执行匿名函数并传递实参jQuery</div><div class="line"></div><div class="line">$(&quot;pp&quot;).style.display = &quot;none&quot;; //使用其他库</div></pre></td></tr></table></figure></p>
<h2 id="在其他库之前导入"><a href="#在其他库之前导入" class="headerlink" title="在其他库之前导入"></a>在其他库之前导入</h2><p>如果jQuery库在其他库之前就导入了，那么可以直接使用jQuery来做一些jQuery的工作<br>同时，可以使用$()方法作为其他库的快捷方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">jQuery(function() //直接使用jQuery</div><div class="line">&#123;</div><div class="line">    $(&quot;.has_children&quot;).click(function() //在函数内部继续调用$()方法</div><div class="line">    &#123;</div><div class="line">        $(this).addClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).show().end()</div><div class="line">            .siblings().removeClass(&quot;highlight&quot;)</div><div class="line">            .children(&quot;a&quot;).hide();</div><div class="line">    &#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">$(&quot;pp&quot;).style.display = &quot;none&quot;; //使用其他库</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/01/jQuery-01/" data-id="cj5c7k38j000vm0u4tvt7nqww" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jquery/">jquery</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-09" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/30/javascript-09/" class="article-date">
  <time datetime="2016-04-30T08:14:36.000Z" itemprop="datePublished">2016-04-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/30/javascript-09/">javascript-09 动画</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JavaScript实现动画效果"><a href="#JavaScript实现动画效果" class="headerlink" title="JavaScript实现动画效果"></a>JavaScript实现动画效果</h1><p>动画就是让元素的位置随着时间不断发生变化</p>
<h2 id="位置"><a href="#位置" class="headerlink" title="位置"></a>位置</h2><p>网页元素在浏览器窗口里的位置是一种表示性的信息，通常由CSS负责设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">example</div><div class="line">&#123;</div><div class="line">    position: absolute;</div><div class="line">    top: 50px;</div><div class="line">    left: 100px;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>DOM代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">example.style.position = &quot;absolute&quot;;</div><div class="line">example.style.left = &quot;100px&quot;;</div><div class="line">example.style.top = &quot;50px&quot;;</div></pre></td></tr></table></figure></p>
<p>posion合法值有static、fixed、relative、和absolute四种</p>
<p>static是默认值，有关元素会按照在标记的先后顺序出现在窗口</p>
<p>relative与static相似，区别是还可以通过float属性从文档的正常显示脱离开</p>
<p>如果某个元素position属性设置为absolute，就可以放到容器的任何位置，容器要么是文档本身，要么是有一个fixed或者absolute属性的父元素，显示位置由top、left、right、bottom等元素决定，可以用百分比或者像素设置这些元素属性值</p>
<p>创建一个标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;cartoon&quot;&gt;</div><div class="line">    &lt;p&gt;hello harryx&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>使用JavaScript指定位置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function positionCartoon()</div><div class="line">    &#123;</div><div class="line">        var cartoon = document.getElementById(&quot;cartoon&quot;);</div><div class="line">        cartoon.style.position = &quot;absolute&quot;;</div><div class="line">        cartoon.style.left = &quot;50px&quot;;</div><div class="line">        cartoon.style.top = &quot;100px&quot;;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>改变元素的位置就是执行函数去改变这个元素的style.top或者style.left等属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function moveCartoon()</div><div class="line">&#123;</div><div class="line">    var cartoon = document.getElementById(&quot;cartoon&quot;);</div><div class="line">    cartoon.style.left = &quot;200px&quot;;</div><div class="line">    cartoon.style.top = &quot;50px&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><p>JavaScript函数setTimeout能够让某个函数经过一段预定时间后才开始执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">setTimeout(&quot;function&quot;, interval)</div></pre></td></tr></table></figure></p>
<p>第一个参数是一个字符串，是将要执行的函数的名字<br>第二个参数是一个数值，以毫秒为单位设定了需要多长时间后才开始执行第一个参数给出的函数</p>
<p>把函数的调用赋值给一个变量，之后可以使用clearTimeout函数取消等待执行的某个函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">variable = setTimeout(&quot;function&quot;, interval)</div><div class="line">clearTimeout(variable)</div></pre></td></tr></table></figure></p>
<p>修改一下positionCartoon函数，让它隔一段时间后执行moveCartoon函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function positionCartoon()</div><div class="line">    &#123;</div><div class="line">        var cartoon = document.getElementById(&quot;cartoon&quot;);</div><div class="line">        cartoon.style.position = &quot;absolute&quot;;</div><div class="line">        cartoon.style.left = &quot;50px&quot;;</div><div class="line">        cartoon.style.top = &quot;100px&quot;;</div><div class="line">        movement = setTimeout(&quot;moveCartoon()&quot;, 1000);</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>让元素渐变移动，主要逻辑如下</p>
<ol>
<li>获得元素的当前位置</li>
<li>如果元素已经到达目的地，退出这个函数</li>
<li>如果尚未到达目的地，则把它向目的地移近一点</li>
<li>经过一段时间后重复步骤1</li>
</ol>
<p>注意，在获得当前位置时是以字符串形式返回，要使用parseInt()函数提取数值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function moveCartoon()</div><div class="line">&#123;</div><div class="line">    var cartoon = document.getElementById(&quot;cartoon&quot;);</div><div class="line">    var xpos = parseInt(cartoon.style.left);</div><div class="line">    var ypos = parseInt(cartoon.style.top);</div><div class="line">    if (xpos == 200 &amp;&amp; ypos == 100) return true;</div><div class="line">    if (xpos &lt; 200) xpos++;</div><div class="line">    if (xpos &gt; 200) xpos--;</div><div class="line">    if (ypos &lt; 100) ypos++;</div><div class="line">    if (ypos &gt; 100) ypos--;</div><div class="line">    cartoon.style.left = xpos + &quot;px&quot;;</div><div class="line">    cartoon.style.top = ypos + &quot;px&quot;;</div><div class="line">    movement = setTimeout(&quot;moveCartoon()&quot;, 50);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="抽象"><a href="#抽象" class="headerlink" title="抽象"></a>抽象</h2><h3 id="创建moveElement函数"><a href="#创建moveElement函数" class="headerlink" title="创建moveElement函数"></a>创建moveElement函数</h3><p>与之前的函数不同的是，moveElement函数可以输入参数</p>
<ul>
<li>打算移动的元素id</li>
<li>该元素的目的地</li>
<li>两次移动的间隔时间</li>
</ul>
<p>定义一个moveElement函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">function moveElemeng(elementID, finalX, finalY, interval)</div><div class="line">&#123;</div><div class="line">    var elem = document.getElementById(elementID);</div><div class="line">    var xpos = parseInt(elem.style.left);</div><div class="line">    var ypos = parseInt(elem.style.top);</div><div class="line">    if (xpos == finalX &amp;&amp; ypos == finalY) return true;</div><div class="line">    if (xpos &lt; finalX) xpos++;</div><div class="line">    if (xpos &gt; finalX) xpos--;</div><div class="line">    if (ypos &lt; finalY) ypos++;</div><div class="line">    if (ypos &gt; finalY) ypos--;</div><div class="line">    elem.style.left = xpos + &quot;px&quot;;</div><div class="line">    elem.style.top = ypos + &quot;px&quot;;</div><div class="line">    repeat = &quot;moveElemeng(&quot;+&quot;&apos;&quot;+elementID+&quot;&apos;&quot;+&quot;,&quot;+finalX+&quot;,&quot;+finalY+&quot;,&quot;+interval+&quot;)&quot;;</div><div class="line">    moment = setTimeout(repeat, interval)    </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function positionCartoon()</div><div class="line">    &#123;</div><div class="line">        var cartoon = document.getElementById(&quot;cartoon&quot;);</div><div class="line">        cartoon.style.position = &quot;absolute&quot;;</div><div class="line">        cartoon.style.left = &quot;50px&quot;;</div><div class="line">        cartoon.style.top = &quot;100px&quot;;</div><div class="line">        moveElemeng(&quot;cartoon&quot;,200,100,10)</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">$(document).ready(function()</div><div class="line">    &#123;</div><div class="line">        var logop = document.getElementById(&quot;logop&quot;);</div><div class="line">        logop.style.left = &quot;200px&quot;;</div><div class="line">        logop.style.top = &quot;0px&quot;;</div><div class="line">        moveElemeng(&quot;logop&quot;,200,30,5);</div><div class="line">    &#125;</div><div class="line">)</div><div class="line"></div><div class="line">function moveElemeng(elementID, finalX, finalY, interval)</div><div class="line">&#123;</div><div class="line">    var elem = document.getElementById(elementID);</div><div class="line">    var xpos = parseInt(elem.style.left);</div><div class="line">    var ypos = parseInt(elem.style.top);</div><div class="line">    if (xpos == finalX &amp;&amp; ypos == finalY) return true;</div><div class="line">    if (xpos &lt; finalX) xpos++;</div><div class="line">    if (xpos &gt; finalX) xpos--;</div><div class="line">    if (ypos &lt; finalY) ypos++;</div><div class="line">    if (ypos &gt; finalY) ypos--;</div><div class="line">    elem.style.left = xpos + &quot;px&quot;;</div><div class="line">    elem.style.top = ypos + &quot;px&quot;;</div><div class="line">    repeat = &quot;moveElemeng(&quot;+&quot;&apos;&quot;+elementID+&quot;&apos;&quot;+&quot;,&quot;+finalX+&quot;,&quot;+finalY+&quot;,&quot;+interval+&quot;)&quot;;</div><div class="line">    moment = setTimeout(repeat, interval)    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h1><p>HTML5添加了新的标记元素</p>
<h2 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h2><p>通过canvas元素标签可以实现与静态图片的交互，创建一个画布<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;canvas id=&quot;draw-in-me&quot; width=&quot;120&quot; height=&quot;40&quot;&gt;</div><div class="line">&lt;/canvas&gt;</div></pre></td></tr></table></figure></p>
<p>然后使用JavaScript作画<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">addLoadEvent( </div><div class="line">    function draw()</div><div class="line">    &#123;</div><div class="line">        var canvas = document.getElementById(&quot;draw-in-me&quot;);</div><div class="line">        if (canvas.getContext)</div><div class="line">        &#123;</div><div class="line">            var cxt=canvas.getContext(&quot;2d&quot;);</div><div class="line">            cxt.moveTo(10,10);</div><div class="line">            cxt.lineTo(150,50);</div><div class="line">            cxt.lineTo(10,50);</div><div class="line">            cxt.stroke();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<h2 id="音频和视频"><a href="#音频和视频" class="headerlink" title="音频和视频"></a>音频和视频</h2><p>HTML5的video元素为在文档中嵌入影片以及与影片的交互提供了一种标准方式，同时也把操作简化成一个标签</p>
<p>video 元素为在文档中嵌入影片以及与影片交互定义了一种标准方式，同时也简化成一个标签<br>这里嵌入了一个mp4视频，同时给出了浏览器不支持video时的下载链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;video src=&quot;./static/mv/badapple.mp4&quot;&gt;</div><div class="line">    &lt;!-- 不支持时替换内容 --&gt;</div><div class="line">    &lt;a href=&quot;./static/mv/badapple.mp4&quot;&gt;Download movie.mp4&lt;/a&gt;</div><div class="line">&lt;/video&gt;</div></pre></td></tr></table></figure></p>
<p>audio元素用法也差不多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;audio src=&quot;./static/mv/badapple.mp3&quot;&gt;</div><div class="line">    &lt;!-- 不支持时替换内容 --&gt;</div><div class="line">    &lt;a href=&quot;./static/mv/badapple.mp3&quot;&gt;&lt;/a&gt;</div><div class="line">&lt;/audio&gt;</div></pre></td></tr></table></figure></p>
<p>为保证每个人都能看到视频，必须作多种格式的视频并在video元素中包含多个来源</p>
<p>为了确保HTML5的兼容性，至少包含下列三个版本</p>
<ul>
<li>基于H.264和ACC的MP4</li>
<li>WebM (VP8 + Vorbis)</li>
<li>基于Theora视频和Vorbis音频的Ogg文件</li>
</ul>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这本书就读到这边了，总的来说是本通俗易懂的书，对js的DOM编程有了一定的概念，也稍微了解了下HTML5，那么，继续学习吧！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/30/javascript-09/" data-id="cj5c7k39r001om0u4mre0dm2g" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-08" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/30/javascript-08/" class="article-date">
  <time datetime="2016-04-30T07:14:39.000Z" itemprop="datePublished">2016-04-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/30/javascript-08/">javascript-08 style属性</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="CSS-DOM"><a href="#CSS-DOM" class="headerlink" title="CSS-DOM"></a>CSS-DOM</h1><h2 id="三位一体的网页"><a href="#三位一体的网页" class="headerlink" title="三位一体的网页"></a>三位一体的网页</h2><p>网页由三层信息构成</p>
<ul>
<li>结构成</li>
<li>表示层</li>
<li>行为层</li>
</ul>
<h3 id="结构层"><a href="#结构层" class="headerlink" title="结构层"></a>结构层</h3><p>网页的结构层由HTML或者XHTML之类的标记语言创建，标签对网页内容的含义作出了描述<br>但是这些标签不包含任何关于内容如何显示的信息</p>
<h3 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h3><p>表示层由CSS负责完成，CSS描述网页内容如何呈现</p>
<h3 id="行为层"><a href="#行为层" class="headerlink" title="行为层"></a>行为层</h3><p>行为层负责内容应该如何响应事件这一问题</p>
<h2 id="style-属性"><a href="#style-属性" class="headerlink" title="style 属性"></a>style 属性</h2><p>每个元素都有意个style属性，包含着元素的样式，查询这个属性将返回一个对象，样式都放在这个style对象的属性里</p>
<h3 id="获取样式"><a href="#获取样式" class="headerlink" title="获取样式"></a>获取样式</h3><p>例如获取color属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function()</div><div class="line">    &#123;</div><div class="line">        var example = document.getElementById(&quot;message&quot;);</div><div class="line">        alert(example.style.color);</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>当属性有“-“号时，要使用驼峰命名法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">example.style.fontFamily</div></pre></td></tr></table></figure></p>
<p>DOM style属性不能用来检索外部CSS文件里声明的样式</p>
<h3 id="设置样式"><a href="#设置样式" class="headerlink" title="设置样式"></a>设置样式</h3><p>style对象的各个属性都是可读可写的，可以使用赋值操作来更新样式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function()</div><div class="line">    &#123;</div><div class="line">        var example = document.getElementById(&quot;message&quot;);</div><div class="line">        example.style.color=&quot;blue&quot;;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<h2 id="如何应用DOM脚本设置样式"><a href="#如何应用DOM脚本设置样式" class="headerlink" title="如何应用DOM脚本设置样式"></a>如何应用DOM脚本设置样式</h2><h3 id="根据元素在节点树的位置设置样式"><a href="#根据元素在节点树的位置设置样式" class="headerlink" title="根据元素在节点树的位置设置样式"></a>根据元素在节点树的位置设置样式</h3><p>CSS无法根据元素之间的相对位置找出特定元素，但是对DOM来说并不难<br>可以根据元素的位置声明样式</p>
<h3 id="更具某种条件反复设置样式"><a href="#更具某种条件反复设置样式" class="headerlink" title="更具某种条件反复设置样式"></a>更具某种条件反复设置样式</h3><p>JavaScript擅长处理重复性任务，比如给一个表格添加样式</p>
<h3 id="响应事件"><a href="#响应事件" class="headerlink" title="响应事件"></a>响应事件</h3><p>比如设置当鼠标悬停时，文本改变颜色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(</div><div class="line">    function highLight()</div><div class="line">    &#123;</div><div class="line">        var message = document.getElementById(&quot;message&quot;);</div><div class="line">        message.onmouseover = function()</div><div class="line">        &#123;</div><div class="line">            this.style.color=&quot;red&quot;;</div><div class="line">        &#125;</div><div class="line">        message.onmouseout = function()</div><div class="line">        &#123;</div><div class="line">            this.style.color=&quot;#70DDdd&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure></p>
<h2 id="className-属性"><a href="#className-属性" class="headerlink" title="className 属性"></a>className 属性</h2><p>如果直接使用脚本更改style属性，后期的修改会比较麻烦，更好的方法是修改className属性<br>可以使用setAttribute做到这件事<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">example.setAttribute(&quot;class&quot;, &quot;examp&quot;)</div></pre></td></tr></table></figure></p>
<p>更简单的方式是修改className属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">example.className = &quot;examp&quot;</div></pre></td></tr></table></figure></p>
<p>修改完className后，只需要在CSS文件中添加样式就行了，如果给一个元素追加新样式，步骤如下</p>
<ul>
<li>检查className属性是否为空</li>
<li>如果是，把class设置值直接赋值给className属性</li>
<li>如果不是，把一个空格和新的class设置值追加到className属性上(example.className += “ examp”)</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/30/javascript-08/" data-id="cj5c7k39o001mm0u4v6arm9uv" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-07" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/29/javascript-07/" class="article-date">
  <time datetime="2016-04-29T07:59:26.000Z" itemprop="datePublished">2016-04-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/29/javascript-07/">javascript-07</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="显示缩略语列表"><a href="#显示缩略语列表" class="headerlink" title="显示缩略语列表"></a>显示缩略语列表</h1><p>使用JavaScript把abbr标签的title属性集中在一起显示，创建的显示列表如下图的格式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;dl&gt;</div><div class="line">    &lt;dt&gt;A&lt;/dt&gt;</div><div class="line">    &lt;dd&gt;AAAAA&lt;/dd&gt;</div><div class="line">    &lt;dt&gt;B&lt;/dt&gt;</div><div class="line">    &lt;dd&gt;BBBBB&lt;/dd&gt;</div><div class="line">    ...</div><div class="line">&lt;/dl&gt;</div></pre></td></tr></table></figure></p>
<p>具体步骤如下</p>
<ul>
<li>遍历这份文档中的所有abbr元素</li>
<li>保存每个abbr元素的title属性</li>
<li>保存每个abbr元素包含的文本</li>
<li>创建一个列表元素(dl)</li>
<li>遍历刚才保存的title属性和abbr元素的文本</li>
<li>创建一个标题元素(dt)</li>
<li>创建一个描述元素(dd)</li>
<li>把abbr文本属性插入到标题元素(dt)</li>
<li>把title属性插入到描述元素(dd)</li>
<li>把dt和dd追加到dl上</li>
<li>把dl追加到body上</li>
</ul>
<h1 id="编写displayAbbr函数"><a href="#编写displayAbbr函数" class="headerlink" title="编写displayAbbr函数"></a>编写displayAbbr函数</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">function displayAbbr()</div><div class="line">&#123;</div><div class="line">    //取得所有abbr标签</div><div class="line">    var abbrs = document.getElementsByTagName(&quot;abbr&quot;);</div><div class="line">    //检测有没有abbr标签</div><div class="line">    if (abbrs.length &lt; 1) return false;</div><div class="line">    var defs = new Array();</div><div class="line">    //遍历读取title属性和标签内容，标签内容也可以使用lastChile.nodeValue</div><div class="line">    for (var i=0; i&lt;abbrs.length; i++)</div><div class="line">    &#123;</div><div class="line">        var defi = abbrs[i].getAttribute(&quot;title&quot;);</div><div class="line">        var key = abbrs[i].innerHTML;</div><div class="line">        defs[key] = defi;</div><div class="line">    &#125;</div><div class="line">    //父标签</div><div class="line">    var artic = document.getElementById(&quot;articals&quot;)</div><div class="line">    var dl = document.createElement(&quot;dl&quot;);</div><div class="line">    artic.appendChild(dl);</div><div class="line">    //循环插入子标签</div><div class="line">    for (key in defs)</div><div class="line">    &#123;</div><div class="line">        var dt = document.createElement(&quot;dt&quot;);</div><div class="line">        var dd = document.createElement(&quot;dd&quot;);</div><div class="line">        dl.appendChild(dt);</div><div class="line">        dl.appendChild(dd);</div><div class="line">        dt.innerHTML = key;</div><div class="line">        dd.innerHTML = defs[key];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>由于IE浏览器不支持abbr标签，拒绝承认abbr为元素标签，所以必须考虑到兼容问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">function displayAbbr()</div><div class="line">&#123;</div><div class="line">    var abbrs = document.getElementsByTagName(&quot;abbr&quot;);</div><div class="line">    if (abbrs.length &lt; 1) return false;</div><div class="line">    var defs = new Array();</div><div class="line">    for (var i=0; i&lt;abbrs.length; i++)</div><div class="line">    &#123;</div><div class="line">        //如果检测不到子元素，进入下一次循环</div><div class="line">        if (abbrs[i].childNodes.length&lt;1) continue;</div><div class="line">        var defi = abbrs[i].getAttribute(&quot;title&quot;);</div><div class="line">        var key = abbrs[i].innerHTML;</div><div class="line">        defs[key] = defi;</div><div class="line">    &#125;</div><div class="line">    var artic = document.getElementById(&quot;articals&quot;)</div><div class="line">    var dl = document.createElement(&quot;dl&quot;);</div><div class="line">    for (key in defs)</div><div class="line">    &#123;</div><div class="line">        var dt = document.createElement(&quot;dt&quot;);</div><div class="line">        var dd = document.createElement(&quot;dd&quot;);</div><div class="line">        dl.appendChild(dt);</div><div class="line">        dl.appendChild(dd);</div><div class="line">        dt.innerHTML = key;</div><div class="line">        dd.innerHTML = defs[key];</div><div class="line">    &#125;</div><div class="line">    //如果内容数为0，返回flase</div><div class="line">    if (dl.childNodes.length&lt;1) return false;</div><div class="line">    artic.appendChild(dl);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="操作cookie"><a href="#操作cookie" class="headerlink" title="操作cookie"></a>操作cookie</h1><p>使用DOM可以获得或者更改cookie<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">alert(document.cookie)</div><div class="line">document.cookie=&quot;uuid=12345&quot;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/29/javascript-07/" data-id="cj5c7k39m001jm0u47lu986co" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-06" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/28/javascript-06/" class="article-date">
  <time datetime="2016-04-28T11:57:24.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/javascript-06/">javascript-06 动态创建标记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="动态创建标记"><a href="#动态创建标记" class="headerlink" title="动态创建标记"></a>动态创建标记</h1><h2 id="传统方法"><a href="#传统方法" class="headerlink" title="传统方法"></a>传统方法</h2><h3 id="document-write"><a href="#document-write" class="headerlink" title="document.write"></a>document.write</h3><p>document对象的write()方法可以方便便捷地把字符串插入到文档里<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.write(&quot;&lt;p&gt;hello harryx&lt;/p&gt;&quot;)</div></pre></td></tr></table></figure></p>
<p>但是这种方法不够优雅，很难将脚本与文档分离，应该避免使用</p>
<h3 id="innerHTML属性"><a href="#innerHTML属性" class="headerlink" title="innerHTML属性"></a>innerHTML属性</h3><p>innerHTML可以用来读写某个标签元素里面的内容，下例可以读出id为description标签的内容为picture-0<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">testdiv = document.getElementById(&quot;description&quot;)</div><div class="line">alert(testdiv.innerHTML)</div></pre></td></tr></table></figure></p>
<p>innerHTML属性不能处理细节，适用于把大段的文本插入HTML<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">testdiv = document.getElementById(&quot;description&quot;)</div><div class="line">testdiv.innerHTML = &quot;&lt;p&gt;&lt;em&gt;picture-&lt;/em&gt; 1&lt;/p&gt;&quot;</div></pre></td></tr></table></figure></p>
<p>一旦使用了innerHTML，元素内容会被全部替换，相比较write()方法，这个属性更方便实用</p>
<h2 id="DOM方法"><a href="#DOM方法" class="headerlink" title="DOM方法"></a>DOM方法</h2><p>DOM所包含的信息与文档里面的信息一一对应，通过DOM可完成读取和更新文档内容</p>
<h3 id="createElement方法"><a href="#createElement方法" class="headerlink" title="createElement方法"></a>createElement方法</h3><p>在文档里面放一个空白的标签，设置id为testdiv<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;testdiv&quot;&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>下面要在这个空白标签插入一个p元素节点，需要两步来完成</p>
<ol>
<li>创建一个新的元素</li>
<li>把这个新元素插入节点树</li>
</ol>
<p>第一个步骤需要使用createElement来完成，创建一个新元素标签然后赋值给变量para<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var para = document.createElement(&quot;p&quot;)</div></pre></td></tr></table></figure></p>
<h3 id="appendChild方法"><a href="#appendChild方法" class="headerlink" title="appendChild方法"></a>appendChild方法</h3><p>现在已经创建了一个新标签元素，然后需要把这个元素插入到文档的节点，使用appendChild方法<br>先找出要插入这个新元素的节点位置，就是之前id为testdiv的空标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var testdiv = document.getElementById(&quot;testdiv&quot;);</div></pre></td></tr></table></figure></p>
<p>然后插入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">testdiv.appendChild(para);</div></pre></td></tr></table></figure></p>
<h3 id="createTextNode方法"><a href="#createTextNode方法" class="headerlink" title="createTextNode方法"></a>createTextNode方法</h3><p>现在已经创建了一个新元素并插入到文档的节点中，但是p是个空白元素，下面是在p元素中放入文本<br>使用createTextNode创建文本节点，如果查看txt的nodeType，返回值是3(文本节点)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var txt = document.createTextNode(&quot;hello harryx&quot;)</div></pre></td></tr></table></figure></p>
<p>然后把这个文本节点插入到p元素(标签元素)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">para.appendChild(txt)</div></pre></td></tr></table></figure></p>
<p>然后就实现了使用DOM插入一段文本，所有代码如下，相比较使用innerHTML属性而言，更细节化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var para = document.createElement(&quot;p&quot;);</div><div class="line">var testdiv = document.getElementById(&quot;testdiv&quot;);</div><div class="line">testdiv.appendChild(para);</div><div class="line">var txt = document.createTextNode(&quot;hello harryx&quot;)</div><div class="line">para.appendChild(txt)</div></pre></td></tr></table></figure></p>
<p>类似的DOM方法还有<br>在已有的元素之前插入一个新元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">insertBefore(新元素, 目标元素)</div></pre></td></tr></table></figure></p>
<p>自定义一个insertAfter函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">function insertAfter(newElement, targetElement)</div><div class="line">&#123;</div><div class="line">    var parent = targetElement.parentNode; //父元素</div><div class="line">    if (parent.lastChild == targetElement) //如果目标元素是最后一个元素</div><div class="line">    &#123;</div><div class="line">        parent.appendChild(newElement); //插入到父元素最后面</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        parent.insertBefore(newElement, targetElement.nextSibling); //否则插入到目标元素后面一个兄弟元素后面</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>其中使用了一个新属性：nextSibling属性，某个元素的下一个兄弟元素</p>
<h2 id="完全分离"><a href="#完全分离" class="headerlink" title="完全分离"></a>完全分离</h2><p>通过使用JavaScript可以创建标签，而不需要在文档中编写，下面将结构、样式和行为完全分离</p>
<p>在HTML文档中的标签内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;preview&quot;&gt;</div><div class="line">    &lt;table &gt;</div><div class="line">        &lt;tr&gt;</div><div class="line">            &lt;td class=&quot;change&quot;&gt;&lt;a href=&quot;#&quot; id=&quot;pre&quot; &gt;上一个&lt;/a&gt;</div><div class="line">            &lt;td class=&quot;change&quot;&gt;&lt;a href=&quot;#&quot; id=&quot;next&quot;&gt;下一个&lt;/a&gt;</div><div class="line">        &lt;/tr&gt;</div><div class="line">    &lt;/table&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div class=&quot;message&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;popup&quot;&gt;查看原图&lt;/a&gt;&lt;/div&gt;</div><div class="line">&lt;p id=&quot;description&quot; class=&quot;message&quot;&gt;&lt;em&gt;picture-&lt;/em&gt; 0&lt;/p&gt;</div><div class="line">&lt;img id=&quot;picture&quot; src=&quot;./static/pic2/pic0.jpg&quot; width=&quot;600px&quot; alt=&quot;到头了&quot;&gt;</div></pre></td></tr></table></figure></p>
<p>在插入之前，文档是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;content&quot;&gt;</div><div class="line">    //.....</div><div class="line">    &lt;div id=&quot;buding&quot;&gt;</div><div class="line">        &lt;a href=&quot;https://www.bilibili.com/&quot;&gt;&lt;img src=&quot;./static/image/buding.gif&quot; width=&quot;120px&quot; alt=&quot;buding&quot; /&gt;&lt;/a&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<p>先找到id为content的div元素，然后在id为buding的子元素之前插入一个id为main的div元素，然后依次在id为main的元素内插入其他元素<br>代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">function addPreview ()</div><div class="line">&#123;</div><div class="line">    var allContent = document.getElementById(&quot;allcontent&quot;);</div><div class="line">    var buDing = document.getElementById(&quot;buding&quot;);</div><div class="line">    var parent = document.createElement(&quot;div&quot;);</div><div class="line">    parent.setAttribute(&quot;id&quot;, &quot;main&quot;);</div><div class="line">    allContent.insertBefore(parent, buDing);</div><div class="line"></div><div class="line">    var previewDiv = document.createElement(&quot;div&quot;);</div><div class="line">    previewDiv.setAttribute(&quot;id&quot;, &quot;preview&quot;);</div><div class="line">    parent.appendChild(previewDiv);</div><div class="line">    var table = document.createElement(&quot;table&quot;);</div><div class="line">    previewDiv.appendChild(table);</div><div class="line">    var tr = document.createElement(&quot;tr&quot;);</div><div class="line">    table.appendChild(tr);</div><div class="line">    td1 = document.createElement(&quot;td&quot;);</div><div class="line">    td1.setAttribute(&quot;class&quot;, &quot;change&quot;);</div><div class="line">    td2 = document.createElement(&quot;td&quot;);</div><div class="line">    td2.setAttribute(&quot;class&quot;, &quot;change&quot;);</div><div class="line">    tr.appendChild(td1);</div><div class="line">    tr.appendChild(td2);</div><div class="line">    preA = document.createElement(&quot;a&quot;);</div><div class="line">    preA.innerHTML = &quot;上一个&quot;;</div><div class="line">    preA.setAttribute(&quot;href&quot;, &quot;#&quot;);</div><div class="line">    preA.setAttribute(&quot;id&quot;, &quot;pre&quot;);</div><div class="line">    td1.appendChild(preA);</div><div class="line">    nextA = document.createElement(&quot;a&quot;);</div><div class="line">    nextA.innerHTML = &quot;下一个&quot;;</div><div class="line">    nextA.setAttribute(&quot;href&quot;, &quot;#&quot;);</div><div class="line">    nextA.setAttribute(&quot;id&quot;, &quot;next&quot;);</div><div class="line">    td2.appendChild(nextA);</div><div class="line"></div><div class="line">    var popDiv = document.createElement(&quot;div&quot;);</div><div class="line">    popDiv.setAttribute(&quot;class&quot;, &quot;message&quot;);</div><div class="line">    parent.appendChild(popDiv);</div><div class="line">    var popA = document.createElement(&quot;a&quot;);</div><div class="line">    popA.setAttribute(&quot;href&quot;, &quot;#&quot;);</div><div class="line">    popA.setAttribute(&quot;class&quot;, &quot;popup&quot;);</div><div class="line">    popA.innerHTML = &quot;查看原图&quot;;</div><div class="line">    popDiv.appendChild(popA);</div><div class="line"></div><div class="line">    desP = document.createElement(&quot;p&quot;);</div><div class="line">    desP.setAttribute(&quot;id&quot;, &quot;description&quot;);</div><div class="line">    desP.setAttribute(&quot;class&quot;, &quot;message&quot;)</div><div class="line">    desP.innerHTML = &quot;&lt;em&gt;picture-&lt;/em&gt; 0&quot;;</div><div class="line">    parent.appendChild(desP);</div><div class="line"></div><div class="line">    imgPre = document.createElement(&quot;img&quot;);</div><div class="line">    imgPre.setAttribute(&quot;id&quot;, &quot;picture&quot;);</div><div class="line">    imgPre.setAttribute(&quot;src&quot;, &quot;./static/pic2/pic0.jpg&quot;);</div><div class="line">    imgPre.setAttribute(&quot;alt&quot;, &quot;到头了&quot;);</div><div class="line">    parent.appendChild(imgPre);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>最后使用addLoadEvent导入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(addPreview);</div></pre></td></tr></table></figure></p>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>Ajax用于概括异步加载页面内容的技术，依赖于JavaScript</p>
<h3 id="XMLHttpRequest-对象"><a href="#XMLHttpRequest-对象" class="headerlink" title="XMLHttpRequest 对象"></a>XMLHttpRequest 对象</h3><p>Ajax技术的核心是XMLHttpRequest对象，这个对象充当浏览器中脚本(客户端)与服务器之间的中间人的角色<br>JavaScript通过这个对象可以发送请求，也能处理请求</p>
<p>不同的浏览器XMLHTTP对象不尽相同，不同版本的IE浏览器XMLHTTP对象也不完全相同</p>
<p>查看XMLHttpRequest对象有没有定义，如果定义了返回defined<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">if (typeof XMLHttpRequest == &quot;undefined&quot;)</div><div class="line">&#123;</div><div class="line">    alert(&quot;undefined&quot;)</div><div class="line">&#125;</div><div class="line">else</div><div class="line">&#123;</div><div class="line">    alert(&quot;defined&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>或者一个个尝试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">function getHTTPObject()</div><div class="line">&#123;</div><div class="line">    if (typeof XMLHttpRequest == &quot;undefined&quot;)</div><div class="line">    &#123;</div><div class="line">        XMLHttpRequest = function()</div><div class="line">        &#123;</div><div class="line">            try</div><div class="line">            &#123;</div><div class="line">                return new ActiveXObject(&quot;Msxml2.XMLHTTP.6.0&quot;);</div><div class="line">            &#125;</div><div class="line">            catch (e) &#123;&#125;</div><div class="line">            try</div><div class="line">            &#123;</div><div class="line">                return new ActiveXObject(&quot;Msxml2.XMLHTTP.3.0&quot;);</div><div class="line">            &#125;</div><div class="line">            catch (e) &#123;&#125;</div><div class="line">            try</div><div class="line">            &#123;</div><div class="line">                return new ActiveXObject(&quot;Msxml2.XMLHTTP&quot;);</div><div class="line">            &#125;</div><div class="line">            catch (e) &#123;&#125;</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return new XMLHttpRequest();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var request = getHTTPObject();</div></pre></td></tr></table></figure></p>
<p>XMLHttpRequest对象有许多方法，其中最有用的是open方法，用来指定服务器上将要访问的文件，指定请求类型：GET、POST、SEND，这个方法的第三个参数用于指定请求是否以异步方式发送和处理</p>
<p>readyState属性有五种可能值</p>
<ul>
<li>0 表示没有初始化</li>
<li>1 表示正在加载</li>
<li>2 表示加载完毕</li>
<li>3 表示正在交互</li>
<li>4 表示完成</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">function getNewContent() </div><div class="line">&#123;</div><div class="line">    var request = getHTTPObject(); //创建XMLHTTP对象</div><div class="line">    if (request) //如果成功创建对象</div><div class="line">    &#123;</div><div class="line">        request.open(&quot;GET&quot;, &quot;example.txt&quot;, true); //发送一个“GET”请求，要求服务器异步发送一个名为example.txt的文件</div><div class="line">        request.onreadystatechange = function () //onreadystatechange是一个事件处理函数，服务器回送响应时执行</div><div class="line">        &#123;</div><div class="line">            if (request.readyState == 4) //服务器会在不同阶段更新readyState的值</div><div class="line">            &#123;</div><div class="line">                //在id为“new“的div元素创建一个子元素p显示文档</div><div class="line">                var para = document.createElement(&quot;p&quot;);</div><div class="line">                var txt = document.createTextNode(request.responseText); //从responseText属性理获得文本数据</div><div class="line">                para.appendChild(txt);</div><div class="line">                document.getElementById(&quot;new&quot;).appendChild(para);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        request.send(null); //发送一个请求</div><div class="line">    &#125;</div><div class="line">    else //浏览器不支持Ajax</div><div class="line">    &#123;</div><div class="line">        alert(&quot;不支持&quot;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">addLoadEvent(getNewContent);</div></pre></td></tr></table></figure>
<p>如果在事件处理函数内加一个输出0，在整个函数最后加一个输出1，执行后会发现，先输出1，然后再输出0<br>说明函数不会等待服务器的请求，而是会继续执行，这就是异步加载<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">function getNewContent() </div><div class="line">&#123;</div><div class="line">    var request = getHTTPObject();</div><div class="line">    if (request)</div><div class="line">    &#123;</div><div class="line">        request.open(&quot;GET&quot;, &quot;./static/example.txt&quot;, true);</div><div class="line">        request.onreadystatechange = function ()</div><div class="line">        &#123;</div><div class="line">            if (request.readyState == 4)</div><div class="line">            &#123;</div><div class="line">                alert(&quot;0&quot;);</div><div class="line">                var para = document.createElement(&quot;p&quot;);</div><div class="line">                var txt = document.createTextNode(request.responseText);</div><div class="line">                para.appendChild(txt);</div><div class="line">                document.getElementById(&quot;new&quot;).appendChild(para);</div><div class="line">            &#125;</div><div class="line">        &#125;;</div><div class="line">        request.send(null);</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        alert(&quot;不支持&quot;)</div><div class="line">    &#125;</div><div class="line">    alert(&quot;1&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/28/javascript-06/" data-id="cj5c7k39g001hm0u4ygcnsny5" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-05" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/28/javascript-05/" class="article-date">
  <time datetime="2016-04-28T08:31:35.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/javascript-05/">javascript-05</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="分离HTML和JavaScript"><a href="#分离HTML和JavaScript" class="headerlink" title="分离HTML和JavaScript"></a>分离HTML和JavaScript</h1><p>将之前的图片预览脚本的HTML和JavaScript代码分离，不在HTML写JavaScript脚本，而是像CSS一样，在外部脚本文件给HTML文档添加脚本功能</p>
<p>首先在上下链接的标签添加class属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;</div><div class="line">    &lt;a href=&quot;pre&quot; class=&quot;preview&quot; &gt;上一个&lt;/a&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;li&gt;</div><div class="line">    &lt;a href=&quot;next&quot; class=&quot;preview&quot; &gt;下一个&lt;/a&gt;</div><div class="line">&lt;/li&gt;</div></pre></td></tr></table></figure></p>
<p>然后在JavaScript脚本添加功能，原本JavaScript的脚本函数不需要更改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">function preparePreview ()</div><div class="line">&#123;</div><div class="line">    if (!document.getElementsByTagName) return false;</div><div class="line">    var links = document.getElementsByTagName(&quot;a&quot;);</div><div class="line">    for (var i=0; i&lt;links.length; i++)</div><div class="line">    &#123;</div><div class="line">        if (links[i].getAttribute(&quot;class&quot;) == &quot;preview&quot;)</div><div class="line">        &#123;</div><div class="line">            links[i].onclick = function()</div><div class="line">            &#123;</div><div class="line">                changePic(this);</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">window.onload = preparePreview;</div></pre></td></tr></table></figure></p>
<h1 id="添加事件处理函数"><a href="#添加事件处理函数" class="headerlink" title="添加事件处理函数"></a>添加事件处理函数</h1><p>现在只有两个链接标签，如果有多个标签元素需要添加功能，逐个添加class会比较麻烦<br>可以改进一下，可以在父标签添加一个独一无二的id，然后再遍历父标签的子标签添加功能</p>
<p>重写preparePreview函数，能够遍历id为preview标签元素所有链接标签，并且添加功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">function preparePreview ()</div><div class="line">&#123;</div><div class="line">    //对象测试</div><div class="line">    if (!document.getElementsByTagName || !document.getElementById) return false;</div><div class="line">    //测试id是否存在</div><div class="line">    if (!document.getElementById(&quot;preview&quot;)) return false;</div><div class="line"></div><div class="line">    var previews = document.getElementById(&quot;preview&quot;);</div><div class="line">    var links = previews.getElementsByTagName(&quot;a&quot;);</div><div class="line">    for (var i=0; i&lt;links.length; i++)</div><div class="line">    &#123;</div><div class="line">        links[i].onclick = function()</div><div class="line">        &#123;</div><div class="line">            changePic(this);</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>HTML文档作如下更改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;ul id=&quot;preview&quot;&gt;</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;a href=&quot;pre&quot; class=&quot;preview&quot; &gt;上一个&lt;/a&gt;</div><div class="line">    &lt;/li&gt;</div><div class="line">    &lt;li&gt;</div><div class="line">        &lt;a href=&quot;next&quot; class=&quot;preview&quot; &gt;下一个&lt;/a&gt;</div><div class="line">    &lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div></pre></td></tr></table></figure></p>
<p>在原来基础的popup函数添加一个原图查看功能，能够读出当前图片的URL并在新窗口打开<br>HTML文档不需要修改，修改一下prepareLinks函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">function popUp (winURL)</div><div class="line">&#123;</div><div class="line">    if (!document.getElementsByTagName || !document.getElementById) return false;</div><div class="line">    if (!document.getElementById(&quot;picture&quot;)) return false;    </div><div class="line">    var previewpic = document.getElementById(&quot;picture&quot;);</div><div class="line">    var picURL = previewpic.getAttribute(&quot;src&quot;)</div><div class="line">    window.open(picURL, &quot;popup&quot;, &quot;width=320,height=480&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="共享onload事件"><a href="#共享onload事件" class="headerlink" title="共享onload事件"></a>共享onload事件</h1><p>上面两个脚本都使用了window.onload事件，但是后面的赋值会把之前的覆盖掉，像下面这样会出问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">window.onload = prepareLinks;</div><div class="line">window.onload = preparePreview;</div></pre></td></tr></table></figure></p>
<p>有一种方法可以避过这个难题，同时容纳两个函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">window.onload = function()</div><div class="line">&#123;</div><div class="line">    prepareLinks();</div><div class="line">    preparePreview();</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当需要绑定的函数不太多的时候，这个方法是可行简单的<br>还有一个比较有弹性的解决方案，编写一个addLoadEvent函数，实现功能如下</p>
<ul>
<li>把现有的window.onload事件处理函数的值存入变量oldonload</li>
<li>如果没有绑定任何函数，只需要把新函数添加给它</li>
<li>如果在这个处理函数上已经绑定了一些函数，就把新函数追加到现有指令的末尾</li>
</ul>
<p>实现的函数如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function addLoadEvent (func)</div><div class="line">&#123;</div><div class="line">    var oldonload = window.onload;</div><div class="line">    if (typeof window.onload != &apos;function&apos;)</div><div class="line">    &#123;</div><div class="line">        window.onload = func;</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        window.onload = function()</div><div class="line">        &#123;</div><div class="line">            oldonload();</div><div class="line">            func();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>唯一参数是函数名称，使用时直接调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">addLoadEvent(prepareLinks);</div><div class="line">addLoadEvent(preparePreview);</div></pre></td></tr></table></figure></p>
<p>使用三元运算符替代之前的return false，当成功执行时返回false，否则返回true<br>如果返回true，点击链接之后的动作正常进行，不会被JavaScript打断<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">return popUp(this.href) ? false : true;</div><div class="line">return changePic(this) ? false : true;</div></pre></td></tr></table></figure></p>
<h1 id="键盘访问"><a href="#键盘访问" class="headerlink" title="键盘访问"></a>键盘访问</h1><p>当用户使用回车键而不是鼠标点击时，应该执行相同的效果，所以把onclick的值直接赋值给onkeypress<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">links[i].onkeypress = links[i].onclick</div></pre></td></tr></table></figure></p>
<p>但这样处理并不友好，当用户按下任意按键，包括tab键都会触发这个事件函数，所以还是暂时不要使用这种处理方式<br>其实，使用tab键移动到链接的地方，按下enter仍然能触发onclick事件函数</p>
<p>下面使用CSS美化一下界面，给需要美化的标签元素添加class属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;preview&quot;&gt;</div><div class="line">    &lt;table &gt;</div><div class="line">        &lt;tr&gt;</div><div class="line">            &lt;td class=&quot;change&quot;&gt;&lt;a href=&quot;pre&quot; &gt;上一个&lt;/a&gt;</div><div class="line">            &lt;td class=&quot;change&quot;&gt;&lt;a href=&quot;next&quot; &gt;下一个&lt;/a&gt;</div><div class="line">        &lt;/tr&gt;</div><div class="line">    &lt;/table&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div class=&quot;message&quot;&gt;&lt;a href=&quot;http://www.baidu.com&quot; class=&quot;popup&quot;&gt;查看原图&lt;/a&gt;&lt;/div&gt;</div><div class="line">&lt;p id=&quot;description&quot; class=&quot;message&quot;&gt;picture-0&lt;/p&gt;</div></pre></td></tr></table></figure></p>
<p>然后编写简单的CSS<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.change</div><div class="line">&#123;</div><div class="line">    width: 400px;</div><div class="line">&#125;</div><div class="line">.message</div><div class="line">&#123;</div><div class="line">    TEXT-ALIGN: center;</div><div class="line">    color: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="DOM-Core和HTML-DOM"><a href="#DOM-Core和HTML-DOM" class="headerlink" title="DOM Core和HTML-DOM"></a>DOM Core和HTML-DOM</h1><p>已经使用过的DOM方法如下</p>
<ul>
<li>getElementById</li>
<li>getElementsByTagName</li>
<li>getElementsByClassName</li>
<li>getAttribute</li>
<li>setAttribute</li>
</ul>
<p>这些方法都是DOM Core的组成部分，他们并不专属JavaScript，支持DOM的任何程序设计语言都可以使用他们，可以用来处理任何一种标记语言编写出来的文档</p>
<p>在使用JavaScript语言和DOM为HTML文件编写脚本时，还有许多属性可供选用<br>例如onclick，用于事件管理，这些属于HTML-DOM，在DOM Core出现之前就已经为人所知</p>
<p>比如说，HTML-DOM提供一个forms对象，这个对象可以把下面的语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.getElementsByTagName(&quot;form&quot;)</div></pre></td></tr></table></figure></p>
<p>简化成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.forms</div></pre></td></tr></table></figure></p>
<p>类似的，HTML-DOM还提供了许多描述各种HTML元素的属性，比如<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">element.src</div></pre></td></tr></table></figure></p>
<p>可以看到HTML-DOM通常会更短，但是他只能处理Web文档</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/28/javascript-05/" data-id="cj5c7k39f001fm0u4awg9alll" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-04" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/28/javascript-04/" class="article-date">
  <time datetime="2016-04-28T05:27:55.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/javascript-04/">javascript-04</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="打开一个新窗口"><a href="#打开一个新窗口" class="headerlink" title="打开一个新窗口"></a>打开一个新窗口</h1><p>JavaScript使用window对象的open()方法创建新的浏览器窗口<br>window.open(url, name, features)<br>这三个参数都是可选的</p>
<ul>
<li>第一个参数是想要在新窗口打开的网页的URL地址，如果省略这个参数将打开一个空白的窗口</li>
<li>第二个参数是新窗口的名字，在代码里可以通过这个名字与新窗口通信</li>
<li>最后一个参数是以逗号分隔的字符串，内容是新窗口的各种属性，包括尺寸以及各种功能</li>
</ul>
<p>open()方法是使用BOM(窗口对象模型)的一个很好的案例，它对文档的内容无任何影响(DOM的地盘)，只与浏览环境有关<br>下面是window.open()的典型应用，这个函数将打开一个320像素宽，480像素高的新窗口”popup”<br>所以当再次调用函数推送一个新URL时，不会再创建一个新窗口，而是直接在这个名为popup的窗口替换文档<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function popUp (winURL)</div><div class="line">&#123;</div><div class="line">    window.open(winURL, &quot;popup&quot;, &quot;width=320,height=480&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>调用popUp函数的一个办法是使用伪协议(pseudo-protocol)</p>
<h1 id="“javascript-”-伪协议"><a href="#“javascript-”-伪协议" class="headerlink" title="“javascript:” 伪协议"></a>“javascript:” 伪协议</h1><p>真协议用来在因特网上的计算机之间传输数据包，如HTTP、FTP协议等，伪协议是一种非标准化协议<br>伪协议让我们通过一个链接来调用JavaScript函数</p>
<p>下面是通过”javascript:”伪协议调用popUp()函数的具体做法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;javascript:popUp(&apos;http://www.baidu.com&apos;);&quot;&gt;baidu&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>但是，如果浏览器不支持这种伪协议或者禁用了JavaScript功能，什么也不会做</p>
<h1 id="内嵌的事件处理函数"><a href="#内嵌的事件处理函数" class="headerlink" title="内嵌的事件处理函数"></a>内嵌的事件处理函数</h1><p>之前在图片预览脚本中使用的onclick事件处理函数就是嵌入到标签<br>同样，可以使用这个技巧调用popUp函数，href实际上已经没有作用，所以直接这样写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;#&quot; onclick=&quot;popUp(&apos;http://www.baidu.com&apos;); return false;&quot;&gt;baidu&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>嵌入事件函数和之前的伪协议相同，如果浏览器禁用了JavaScript功能，这个链接不起作用</p>
<p>如果希望能够兼容那些没有JavaScript功能的用户比如搜索机器人，可以把href改为真正的链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;http://www.baidu.com&quot; onclick=&quot;popUp(this.getAttribute(&apos;href&apos;)); return false;&quot;&gt;baidu&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>其中this.getAttribute(‘href’)可以简写成this.href<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;http://www.baidu.com&quot; onclick=&quot;popUp(this.href); return false;&quot;&gt;baidu&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<h1 id="分离-JavaScript"><a href="#分离-JavaScript" class="headerlink" title="分离 JavaScript"></a>分离 JavaScript</h1><p>之前的代码已经和html文档分的很开了，但是问题出在内嵌的事件处理函数<br>可以把一个事件添加到某个带有特定id属性的元素上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getElementById(id).event = action</div></pre></td></tr></table></figure></p>
<p>如果涉及多个元素可以使用getElementsByTagName、getElementsByClassName和getAttribute把事件添加到有特定属性的元素<br>具体步骤如下：</p>
<ol>
<li>把文档里的所有链接放入一个数组</li>
<li>遍历数组</li>
<li>如果某个链接的class属性为popup，就表示这个链接在被点击时应该调用popUp函数</li>
</ol>
<p>在html文档里把元素的class属性设为popup<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;http://www.baidu.com&quot; class=&quot;popup&quot;&gt;baidu&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>在js脚本里给class属性为popup的元素添加功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var links = document.getElementsByTagName(&quot;a&quot;);</div><div class="line">for (var i=0; i&lt;links.length; i++)</div><div class="line">&#123;</div><div class="line">    if (links[i].getAttribute(&quot;class&quot;) == &quot;popup&quot;)</div><div class="line">    &#123;</div><div class="line">        links[i].onclick = function()</div><div class="line">        &#123;</div><div class="line">            popUp(this.href);</div><div class="line">            return false;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>有一点要注意，这个js脚本代码如果是在html开头部分导入的，那么一开始将无法执行这条语句，因为文档还没有被加载<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var links = document.getElementsByTagName(&quot;a&quot;);</div></pre></td></tr></table></figure></p>
<p>所以必须要在文档加载完毕之后再加载这个脚本，使用window.onload时间函数可以做到这点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function prepareLinks ()</div><div class="line">&#123;</div><div class="line">    var links = document.getElementsByTagName(&quot;a&quot;);</div><div class="line">    for (var i=0; i&lt;links.length; i++)</div><div class="line">    &#123;</div><div class="line">        if (links[i].getAttribute(&quot;class&quot;) == &quot;popup&quot;)</div><div class="line">        &#123;</div><div class="line">            links[i].onclick = function()</div><div class="line">            &#123;</div><div class="line">                popUp(this.href);</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">window.onload = prepareLinks;</div></pre></td></tr></table></figure></p>
<h1 id="对象检测"><a href="#对象检测" class="headerlink" title="对象检测"></a>对象检测</h1><p>如果用户浏览器版本比较老，可能无法支持一部分JavaScript语句，所以需要在脚本里添加一个检测语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if (!document.getElementsByTagName || !document.getElementById) return false;</div></pre></td></tr></table></figure></p>
<p>添加到之前写的脚本函数当中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">function prepareLinks ()</div><div class="line">&#123;</div><div class="line">    if (!document.getElementsByTagName) return false;</div><div class="line">    var links = document.getElementsByTagName(&quot;a&quot;);</div><div class="line">    for (var i=0; i&lt;links.length; i++)</div><div class="line">    &#123;</div><div class="line">        if (links[i].getAttribute(&quot;class&quot;) == &quot;popup&quot;)</div><div class="line">        &#123;</div><div class="line">            links[i].onclick = function()</div><div class="line">            &#123;</div><div class="line">                popUp(this.href);</div><div class="line">                return false;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">window.onload = prepareLinks;</div></pre></td></tr></table></figure></p>
<h1 id="性能考虑"><a href="#性能考虑" class="headerlink" title="性能考虑"></a>性能考虑</h1><h2 id="尽量少访问DOM和尽量减少标记"><a href="#尽量少访问DOM和尽量减少标记" class="headerlink" title="尽量少访问DOM和尽量减少标记"></a>尽量少访问DOM和尽量减少标记</h2><p>访问DOM的方式会对脚本性能产生非常大的影响，灵活使用变量</p>
<p>尽量减少文档中标记的数量，过多不必要的元素会增加DOM树的规模，增加遍历DOM树的时间</p>
<h2 id="合并和放置脚本"><a href="#合并和放置脚本" class="headerlink" title="合并和放置脚本"></a>合并和放置脚本</h2><p>推荐做法是把所有js脚本合并到一个文件当中，减少页面加载时发送请求的数量</p>
<p>一般来说，更具HTTP规范，浏览器每次从同一个域名中最多同时下载两个文件，在下载期间，浏览器不会下载其他任何文件<br>把所有的scrip标签都放到文档末尾，/body标签之前，就能让页面加载更快</p>
<h2 id="压缩脚本"><a href="#压缩脚本" class="headerlink" title="压缩脚本"></a>压缩脚本</h2><p>所谓压缩脚本，就是把脚本文件中的不必要的字节，比如空格和注释，全部删除，从而达到压缩文件的目的<br>好在，很多工具都可以做这件事，有的工具甚至会重写你的代码，使用更短的变量名</p>
<p>精简后的代码虽然不容易看懂，但是能大幅减少文件的大小，多数情况下应该有两个版本，一个是工作副本，另一个是精简副本</p>
<p>通常，为了区分，最好在精简副本的文件名加上min字样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;./static/js/test.min.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/28/javascript-04/" data-id="cj5c7k39b001dm0u4msfibm0n" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pixiv-spider" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/28/pixiv-spider/" class="article-date">
  <time datetime="2016-04-28T04:48:53.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/pixiv-spider/">pixiv抓图</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>因为在学JavaScript，所以准备随便抓些图片放在网页上，然后锁定了pixiv，用urllib2抓链接发现不能下载，一直403<br>然后查了下，发现wget的神奇功能，直接用os.system调用</p>
<h1 id="抓图代码"><a href="#抓图代码" class="headerlink" title="抓图代码"></a>抓图代码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding: utf-8 -*-  </div><div class="line"></div><div class="line">import threading,urllib2,urllib</div><div class="line">import os,re,string,sys,time</div><div class="line">from bs4 import BeautifulSoup</div><div class="line">import cookielib</div><div class="line"></div><div class="line">&quot;使用wget抓取pixiv的图片&quot;</div><div class="line"></div><div class="line">url = &quot;http://spotlight.pics/en/a/1196&quot;</div><div class="line"></div><div class="line">header = &#123;    </div><div class="line">    &quot;User-Agent&quot;:&quot;Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0&quot;,</div><div class="line">    &quot;Accept&quot;:&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</div><div class="line"> &#125;</div><div class="line"></div><div class="line">#获得页面所有图片的链接</div><div class="line">def get_pic_links(url):</div><div class="line">    cookie = cookielib.CookieJar()</div><div class="line">    cookie_handler = urllib2.HTTPCookieProcessor(cookie)</div><div class="line">    opener = urllib2.build_opener(cookie_handler)</div><div class="line">    req = urllib2.Request(url, headers=header)</div><div class="line">    try:</div><div class="line">        html = opener.open(req)</div><div class="line">    except urllib2.URLError, e:</div><div class="line">        if hasattr(e, &quot;code&quot;):</div><div class="line">            print &quot;HTTP error: &quot; + str(e.code)</div><div class="line">        elif hasattr(e, &quot;reason&quot;):</div><div class="line">            print e.reason</div><div class="line">        else:</div><div class="line">            print &quot;unknow err&quot;</div><div class="line">    soup = BeautifulSoup(html, &apos;lxml&apos;)</div><div class="line">    links = soup.find_all(src = re.compile(&quot;.jpg&quot;))</div><div class="line">    pic_url = []</div><div class="line">    for link in links:</div><div class="line">        pic_url.append(re.findall(&quot;http:.*?.jpg&quot;,str(link)))</div><div class="line">    return pic_url</div><div class="line"></div><div class="line">def get_pic(u):</div><div class="line">    command = &quot;wget --referer=&quot; + &quot;\&quot;&quot; + str(u[0]) + &quot;\&quot;&quot;  + &quot; -p &quot; + &quot;\&quot;&quot; + str(u[0]) + &quot;\&quot;&quot;</div><div class="line">    os.system(command)</div><div class="line"></div><div class="line">if __name__ == &quot;__main__&quot;:</div><div class="line">    urls = get_pic_links(url)</div><div class="line">    for u in urls:</div><div class="line">        get_pic(u)</div></pre></td></tr></table></figure>
<h1 id="抓下来的图片统一改名"><a href="#抓下来的图片统一改名" class="headerlink" title="抓下来的图片统一改名"></a>抓下来的图片统一改名</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#-*-coding:utf-8-*-</div><div class="line"></div><div class="line">&quot;批量修改文件名&quot;</div><div class="line"></div><div class="line">import os</div><div class="line">import sys</div><div class="line"></div><div class="line">url = &quot;/home/herui/Python_Spider/&quot;</div><div class="line"></div><div class="line">i=0</div><div class="line"></div><div class="line">for root,dirs,files in os.walk(url):</div><div class="line">    for f in files:</div><div class="line">        if f.split(&quot;.&quot;)[-1] == &quot;jpg&quot;:</div><div class="line">            filename = os.path.join(root,f)</div><div class="line">            newname = os.path.join(&quot;/home/herui/Python_Spider/pic&quot;,&quot;pic&quot;+str(i)+&quot;.jpg&quot;)</div><div class="line">            i=i+1</div><div class="line">            os.rename(filename, newname)</div><div class="line"></div><div class="line">print &quot;ok&quot;</div></pre></td></tr></table></figure>
<h1 id="如果只要大图"><a href="#如果只要大图" class="headerlink" title="如果只要大图"></a>如果只要大图</h1><p>点开爬到的内容可以发现，大图都在 480x960 文件夹里面，再添加一句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#-*-coding:utf-8-*-</div><div class="line"></div><div class="line">&quot;批量修改文件名&quot;</div><div class="line"></div><div class="line">import os</div><div class="line">import sys</div><div class="line"></div><div class="line">url = &quot;/home/herui/Python_Spider/&quot;</div><div class="line"></div><div class="line">i=0</div><div class="line"></div><div class="line">for root,dirs,files in os.walk(url):</div><div class="line">    for f in files:</div><div class="line">        if f.split(&quot;.&quot;)[-1] == &quot;jpg&quot; and (&quot;480x960&quot; in root):</div><div class="line">            filename = os.path.join(root,f)</div><div class="line">            newname = os.path.join(&quot;/home/herui/Python_Spider/pic2&quot;,&quot;pic&quot;+str(i)+&quot;.jpg&quot;)</div><div class="line">            i=i+1</div><div class="line">            os.rename(filename, newname)</div><div class="line"></div><div class="line">print &quot;ok&quot;</div></pre></td></tr></table></figure></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://prinzeugen.net/use-multiple-threads-to-download-pixiv-anime/" target="_blank" rel="external">https://prinzeugen.net/use-multiple-threads-to-download-pixiv-anime/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/28/pixiv-spider/" data-id="cj5c7k430004am0u4vujicqig" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spider/">spider</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/27/javascript-03/" class="article-date">
  <time datetime="2016-04-27T02:11:01.000Z" itemprop="datePublished">2016-04-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/27/javascript-03/">javascript-03 图片库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JavaScript图片库"><a href="#JavaScript图片库" class="headerlink" title="JavaScript图片库"></a>JavaScript图片库</h1><h2 id="标记"><a href="#标记" class="headerlink" title="标记"></a>标记</h2><p>添加一个img标记，显示一个图片，添加一个独有的id，然后通过id查找到这个元素之后可以通过更改src参数更改显示的图片<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img id=&quot;picture&quot; src=&quot;./static/picture/pic1.jpg&quot; width=&quot;600px&quot;&gt;</div></pre></td></tr></table></figure></p>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2><p>展示一个图片的函数可以这样写，通过id：picture寻找到元素标签，然后使用setAttribute()函数更改src属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function showPic (whichpic) </div><div class="line">&#123;</div><div class="line">    var pic = document.getElementById(&quot;picture&quot;);</div><div class="line">    pic.setAttribute(&quot;src&quot;,whichpic);</div><div class="line">&#125;</div><div class="line"></div><div class="line">show_pic(&quot;./static/picture/pic32.jpg&quot;)</div></pre></td></tr></table></figure></p>
<p>也可以不使用DOM来解决，可以直接修改大部分元素的属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function showPic (whichpic) </div><div class="line">&#123;</div><div class="line">    var pic = document.getElementById(&quot;picture&quot;);</div><div class="line">    pic.src=whichpic; //直接修改元素的src属性</div><div class="line">&#125;</div><div class="line">showPic(&quot;./static/picture/pic33.jpg&quot;)</div></pre></td></tr></table></figure></p>
<h2 id="应用JavaScript"><a href="#应用JavaScript" class="headerlink" title="应用JavaScript"></a>应用JavaScript</h2><h3 id="事件处理函数"><a href="#事件处理函数" class="headerlink" title="事件处理函数"></a>事件处理函数</h3><p>事件处理函数的作用是在特定事件发生时调用JavaScript代码。<br>例如，鼠标悬停某个元素上方时出发动作使用onmouseover事件处理函数；<br>鼠标指针离开某个元素时触发动作使用onmouseout事件处理函数；<br>用户点击某个链接时触发一个动作使用onclick事件处理函数。</p>
<p>当用户点击某个链接时，读取这个读片链接并预览出来，把函数改为这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">function showPic (whichpic) </div><div class="line">&#123;</div><div class="line">    var source = whichpic.getAttribute(&quot;href&quot;)</div><div class="line">    var pic = document.getElementById(&quot;picture&quot;);</div><div class="line">    pic.setAttribute(&quot;src&quot;,source);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>把oneclick事件处理函数嵌入到一个链接时，如果要把某个链接本身作为参数传递，使用this关键字传递对象</p>
<p>添加事件处理函数的语法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">event = &quot;JavaScript&quot;</div></pre></td></tr></table></figure></p>
<p>在一对引号之间可以放入任意数量的JavaScript语句，只要用分号隔开<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">onclick = &quot;showPic(this)&quot;</div></pre></td></tr></table></figure></p>
<p>不过当用户点击链接时还会调用本来的行为，页面会跳到点开的页面中，因此要阻止这个默认行为</p>
<p>测试一下事件处理函数的工作机制<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;./static/picture/pic5.jpg&quot; onclick=&quot;return false;&quot;&gt;test&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>当点击这个链接时，onclick返回值是false，事件处理函数就认为这个链接没有被点击，所以链接不会被触发<br>所以在后面加上一句return false，就不会触发链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=&quot;./static/picture/pic1.jpg&quot; onclick=&quot;showPic(this);return false;&quot;&gt;test&lt;/a&gt;</div></pre></td></tr></table></figure></p>
<p>如果static里面的图片是按照一定顺序命名，利用一个判断语句，可以添加上一页和下一页的按钮索引图片<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">var num=0</div><div class="line"></div><div class="line">function showPic (whichpic) </div><div class="line">&#123;</div><div class="line">    var source = whichpic.getAttribute(&quot;href&quot;);</div><div class="line">    if (source == &quot;pre&quot;)</div><div class="line">    &#123;</div><div class="line">        if (num != 0)</div><div class="line">        &#123;</div><div class="line">            num --;</div><div class="line">            source = &quot;./static/picture/pic&quot; + num + &quot;.jpg&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    if (source == &quot;next&quot;)</div><div class="line">    &#123;</div><div class="line">        num ++;</div><div class="line">        source = &quot;./static/picture/pic&quot; + num + &quot;.jpg&quot;;</div><div class="line">    &#125;</div><div class="line">    var pic = document.getElementById(&quot;picture&quot;);</div><div class="line">    pic.setAttribute(&quot;src&quot;,source);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在html文件中调用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;li&gt;</div><div class="line">    &lt;a href=&quot;pre&quot; onclick=&quot;showPic(this);return false;&quot;&gt;上一个&lt;/a&gt;</div><div class="line">&lt;/li&gt;</div><div class="line">&lt;li&gt;</div><div class="line">    &lt;a href=&quot;next&quot; onclick=&quot;showPic(this);return false;&quot;&gt;下一个&lt;/a&gt;</div><div class="line">&lt;/li&gt;</div></pre></td></tr></table></figure></p>
<h3 id="childNodes属性"><a href="#childNodes属性" class="headerlink" title="childNodes属性"></a>childNodes属性</h3><p>childNodes用于获得一个元素的所有子元素的集合，下面是一个获得body所有子元素个数的函数<br>window.onload事件处理函数代表在页面加载时执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function countBodychildren ()</div><div class="line">&#123;</div><div class="line">    var body_element = document.getElementsByTagName(&quot;body&quot;)[0];</div><div class="line">    alert(body_element.childNodes.length);</div><div class="line">&#125;</div><div class="line"></div><div class="line">window.onload = countBodychildren;</div></pre></td></tr></table></figure></p>
<p>返回的结果会比想象中多，因为childNodes不仅返回元素节点，文档的每样东西都是一个节点</p>
<h3 id="nodeType属性"><a href="#nodeType属性" class="headerlink" title="nodeType属性"></a>nodeType属性</h3><p>每个节点都有一个nodeType属性.nodeType的值是一个数字</p>
<ul>
<li>元素节点的nodeType属性值为1</li>
<li>属性节点的nodeType属性值为2</li>
<li>文本节点的nodeType属性值为3</li>
</ul>
<p>如果把上个函数的语句改成输出nodeType，可以发现输出是1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(body_element.nodeType);</div></pre></td></tr></table></figure></p>
<h3 id="在标记里添加表述"><a href="#在标记里添加表述" class="headerlink" title="在标记里添加表述"></a>在标记里添加表述</h3><p>当点击一个图片链接时，不仅更换成目标链接的图片预览，还要更换文本描述，文本表述来自链接元素的title属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var text = whichpic.getAttribute(&quot;title&quot;)</div></pre></td></tr></table></figure></p>
<p>在html文档中添加一个文本表述，id为description<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p id=&quot;description&quot;&gt;choose a picture&lt;/p&gt;</div></pre></td></tr></table></figure></p>
<p>通过id找到这个元素节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var des = document.getElementById(&quot;description&quot;)</div></pre></td></tr></table></figure></p>
<p>下面是切换文本</p>
<h3 id="nodeValue属性"><a href="#nodeValue属性" class="headerlink" title="nodeValue属性"></a>nodeValue属性</h3><p>nodeValue属性可以得到或者设置一个节点的值，但是这个值并不知元素节点的文本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(des.nodeValue) //返回null</div></pre></td></tr></table></figure></p>
<p>真正的文本在p元素的第一个子节点的nodeValue里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(des.childNodes[0].nodeValue) //返回choose a picture</div></pre></td></tr></table></figure></p>
<p>也可以修改文本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">des.childNodes[0].nodeValue = text</div></pre></td></tr></table></figure></p>
<h3 id="firstChild和lastChild属性"><a href="#firstChild和lastChild属性" class="headerlink" title="firstChild和lastChild属性"></a>firstChild和lastChild属性</h3><p>数组元素childNodes[0]有个更直观的同义词，即firstChild，node.firstChild和node.childNodes[0]是等价的</p>
<p>与此相对的，lastChild代表数组的最后一个元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function showPic (whichpic)</div><div class="line">&#123;</div><div class="line">    var source = whichpic.getAttribute(&quot;href&quot;);</div><div class="line">    var text = whichpic.getAttribute(&quot;title&quot;);</div><div class="line">    var pic = document.getElementById(&quot;picture&quot;);</div><div class="line">    var des = document.getElementById(&quot;description&quot;);</div><div class="line">    des.firstChild.nodeValue = text;</div><div class="line">    pic.setAttribute(&quot;src&quot;, source);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/27/javascript-03/" data-id="cj5c7k39a001bm0u47gt9nxuu" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript-02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/26/javascript-02/" class="article-date">
  <time datetime="2016-04-26T02:58:40.000Z" itemprop="datePublished">2016-04-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/26/javascript-02/">javascript-02 DOM</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h1><h2 id="文档：D-Document"><a href="#文档：D-Document" class="headerlink" title="文档：D(Document)"></a>文档：D(Document)</h2><p>当创建一个网页并加载到Web浏览器中时，DOM就在幕后悄然而生，把网页文档转化为一个文档对象。</p>
<h2 id="对象：O-Object"><a href="#对象：O-Object" class="headerlink" title="对象：O(Object)"></a>对象：O(Object)</h2><p>JavaScript对象分为三种类型</p>
<ul>
<li>用户自定义对象：由程序员自行创建的对象</li>
<li>内建对象：内建在JavaScript的对象，如Array，Math等</li>
<li>宿主对象：由浏览器提供的对象</li>
</ul>
<p>对编写脚本来说非常重要的宿主对象中最基础的对象是window对象</p>
<p>window对象对应着浏览器窗口本身，这个对象的属性和方法统称为BOM(浏览器对象模型)，或者称为窗口对象模型</p>
<p>BOM提供window.open和window.blur等方法，这些方法负责窗口的弹出和下拉等操作</p>
<p>document对象的主要功能是处理网页内容</p>
<h2 id="模型：M-Model"><a href="#模型：M-Model" class="headerlink" title="模型：M(Model)"></a>模型：M(Model)</h2><p>DOM代表模型(Model)，或者也可以说代表地图(Map)，含义是某种事物的表现形式</p>
<p>DOM把一份文档表示为一棵树，一棵家谱树(节点树)，可以把各元素的关系简明表示出来</p>
<h2 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h2><p>节点(node)这个词是个网络术语，它表示网络中的一个连接点，一个网络就是节点构成的集合</p>
<p>DOM也是由节点构成的集合，只不过节点是文档树上的树枝、树叶而已</p>
<h3 id="元素节点"><a href="#元素节点" class="headerlink" title="元素节点"></a>元素节点</h3><p>DOM的原子是<strong>元素节点</strong>(element node)</p>
<p>标签的名字就是元素的名字：例如文本段落元素”P”，无序清单元素”ul”，列表项元素”li”</p>
<p>其中没有被其他元素包含的元素”html”被称为根元素</p>
<h3 id="文本节点"><a href="#文本节点" class="headerlink" title="文本节点"></a>文本节点</h3><p>元素节点内部包含的节点为文本节点，不过并不是每个元素节点都包含文本节点</p>
<h3 id="属性节点"><a href="#属性节点" class="headerlink" title="属性节点"></a>属性节点</h3><p>属性节点用来对元素做出更具体的描述，例如几乎所有元素都有一个title属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;p title=&quot;message&quot;&gt;welcome!&lt;/p&gt;</div></pre></td></tr></table></figure></p>
<p>并非所有的元素都包含某个属性，但是所有属性都被元素包含</p>
<h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><p>CSS(层叠样式表)告诉浏览器应该如何显示一份文档的内容</p>
<h3 id="获取元素"><a href="#获取元素" class="headerlink" title="获取元素"></a>获取元素</h3><p>有三种DOM方法可以获得元素节点，分别是通过元素ID、通过标签名字和通过类名字</p>
<h4 id="getElementById"><a href="#getElementById" class="headerlink" title="getElementById"></a>getElementById</h4><p>顾名思义就是通过元素ID获取元素节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">document.getElementById(&quot;myname&quot;);</div></pre></td></tr></table></figure></p>
<p>对应着id为“myname”的标签div<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#...</div><div class="line">    &lt;div id=&quot;myname&quot;&gt;</div><div class="line">        Javascript</div><div class="line">    &lt;/div&gt;</div><div class="line">#...</div></pre></td></tr></table></figure></p>
<p>如果使用typeof观察返回值类型，可以直到类型为对象(Object)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(typeof document.getElementById(&quot;myname&quot;));</div></pre></td></tr></table></figure></p>
<h4 id="getElementsByTagName"><a href="#getElementsByTagName" class="headerlink" title="getElementsByTagName"></a>getElementsByTagName</h4><p>更具标签的名字获取元素节点和getElementById()类似，不过返回的是一个数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">getElementsByTagName(&quot;li&quot;);</div></pre></td></tr></table></figure></p>
<p>可以通过length属性查看元素个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert(document.getElementsByTagName(&quot;p&quot;).length);</div></pre></td></tr></table></figure></p>
<p>可以把读取的元素节点赋值给一个变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps = document.getElementsByTagName(&quot;p&quot;);</div></pre></td></tr></table></figure></p>
<p>可以把通配符作为参数，匹配所有元素节点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps = document.getElementsByTagName(&quot;*&quot;);</div></pre></td></tr></table></figure></p>
<p>可以把getElementById()和getElementsByTagName结合起来用<br>先找出id属性为allcontent的元素节点，然后找出该节点内的所有元素并统计个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var cont = document.getElementById(&quot;allcontent&quot;);</div><div class="line">var items = cont.getElementsByTagName(&quot;*&quot;);</div><div class="line">alert(items.length);</div></pre></td></tr></table></figure></p>
<h4 id="getElementsByClassName"><a href="#getElementsByClassName" class="headerlink" title="getElementsByClassName"></a>getElementsByClassName</h4><p>HTML5 DOM新增的方法，通过class属性访问元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var res = document.getElementsByClassName(&quot;linkp&quot;);</div><div class="line">alert(res.length);</div></pre></td></tr></table></figure></p>
<p>同样的，也可以结合使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var cont = document.getElementById(&quot;allcontent&quot;);</div><div class="line">var res = cont.getElementsByClassName(&quot;linkp&quot;);</div><div class="line">alert(res.length);</div></pre></td></tr></table></figure></p>
<p>如果浏览器不支持这个方法，可以自己实现一个类似功能的函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">function getElementsByClassName (node, classname) </div><div class="line">&#123;</div><div class="line">    if (node.getElementsByClassName)</div><div class="line">    &#123;</div><div class="line">        return node.getElementsByClassName(classname);</div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        var results = new Array();</div><div class="line">        var elems = node.getElementsByTagName(&quot;*&quot;)</div><div class="line">        for (var i=0; i&lt;items.length; i++)</div><div class="line">        &#123;</div><div class="line">            if (items.className.indexof(classname) != -1)</div><div class="line">            &#123;</div><div class="line">                results[results.length] = elems[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return results;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>第一个参数node表示开始节点，第二个参数是类名，如果节点已经存在了getElementsByClassName函数，直接返回列表值，如果不存在，新函数会循环遍历所有标签，查找带有相应类名的元素<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var cont = document.getElementById(&quot;allcontent&quot;)</div><div class="line">var res = getElementsByClassName(cont, &quot;linkp&quot;)</div><div class="line">alert(res.length)</div></pre></td></tr></table></figure></p>
<h2 id="获取和设置属性"><a href="#获取和设置属性" class="headerlink" title="获取和设置属性"></a>获取和设置属性</h2><p>得到元素之后，就是获取属性节点的值</p>
<h3 id="getAttribute"><a href="#getAttribute" class="headerlink" title="getAttribute"></a>getAttribute</h3><p>getAttribute是一个函数，只有一个参数，查询的属性的名字</p>
<p>getAttribute不属于document对象，只能通过元素节点对象调用</p>
<p>“class”属性的值，如果没有这个属性，会返回null<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var ps = document.getElementsByTagName(&quot;p&quot;)</div><div class="line">for (var i=0; i&lt;ps.length; i++)</div><div class="line">&#123;</div><div class="line">    alert(ps[i].getAttribute(&quot;class&quot;))</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="setAttribute"><a href="#setAttribute" class="headerlink" title="setAttribute"></a>setAttribute</h3><p>setAttribute允许对属性节点的值做出修改，和getAttribute相同，也只能用于元素节点</p>
<p>改变一个img元素的寬和高<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var bud = document.getElementById(&quot;buding&quot;)</div><div class="line">var gif = bud.getElementsByTagName(&quot;img&quot;)</div><div class="line">gif[0].setAttribute(&quot;width&quot;,&quot;300px&quot;)</div><div class="line">gif[0].setAttribute(&quot;height&quot;,&quot;300px&quot;)</div></pre></td></tr></table></figure></p>
<p>如果设置的属性之前存在，会直接覆盖掉，虽然属性已经改变了，但是如果查看网页源码，属性并没有改变，所以DOM实现的是先静态显示再动态刷新，动态刷新不会影响静态的内容</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/26/javascript-02/" data-id="cj5c7k3980019m0u4gv10kik0" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/acg/">acg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bb/">bb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/haskell/">haskell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sicp/">sicp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/socket/">socket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soket/">soket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spider/">spider</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/acg/" style="font-size: 10px;">acg</a> <a href="/tags/basic/" style="font-size: 10px;">basic</a> <a href="/tags/bb/" style="font-size: 10px;">bb</a> <a href="/tags/c/" style="font-size: 12.86px;">c++</a> <a href="/tags/django/" style="font-size: 12.86px;">django</a> <a href="/tags/flask/" style="font-size: 20px;">flask</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/haskell/" style="font-size: 10px;">haskell</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/javascript/" style="font-size: 17.14px;">javascript</a> <a href="/tags/jquery/" style="font-size: 15.71px;">jquery</a> <a href="/tags/linux/" style="font-size: 11.43px;">linux</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mysql/" style="font-size: 12.86px;">mysql</a> <a href="/tags/python/" style="font-size: 18.57px;">python</a> <a href="/tags/sicp/" style="font-size: 10px;">sicp</a> <a href="/tags/socket/" style="font-size: 11.43px;">socket</a> <a href="/tags/soket/" style="font-size: 10px;">soket</a> <a href="/tags/spider/" style="font-size: 14.29px;">spider</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/03/effective-C/">effective_C++</a>
          </li>
        
          <li>
            <a href="/2017/04/01/traceback/">异常处理</a>
          </li>
        
          <li>
            <a href="/2017/04/01/logging/">打印日志</a>
          </li>
        
          <li>
            <a href="/2017/04/01/construct/">二进制数据处理</a>
          </li>
        
          <li>
            <a href="/2017/03/29/Csharp/">C#面向对象</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 HeRui<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>